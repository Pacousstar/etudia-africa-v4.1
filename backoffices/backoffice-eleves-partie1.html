<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Espace √âtudIA - Jean-Baptiste DOSSO</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* ============================================
           üé® VARIABLES CSS - DESIGN TESLA HARMONIS√â
           ============================================ */
        :root {
            /* üéØ Couleurs √âtudIA Tesla */
            --etudia-primary: #FF6B35;
            --etudia-secondary: #EF4444;
            --etudia-success: #10B981;
            --etudia-warning: #F59E0B;
            --etudia-info: #3B82F6;
            --etudia-dark: #1F2937;
            --etudia-darker: #111827;
            --etudia-white: #FFFFFF;
            
            /* üåà Gradients Tesla */
            --gradient-primary: linear-gradient(135deg, #FF6B35, #EF4444);
            --gradient-secondary: linear-gradient(135deg, #10B981, #3B82F6);
            --gradient-background: linear-gradient(135deg, #1F2937, #111827);
            
            /* üé® Glassmorphism */
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            
            /* üìê Layout */
            --sidebar-width: 280px;
            --border-radius: 12px;
            --border-radius-lg: 16px;
            --transition: all 0.3s ease;
        }
        
        /* ============================================
           üîÑ RESET & BASE STYLES TESLA
           ============================================ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--gradient-background);
            color: var(--etudia-white);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        /* ============================================
           üèóÔ∏è LAYOUT PRINCIPAL TESLA
           ============================================ */
        .app-container {
            display: flex;
            min-height: 100vh;
            position: relative;
        }
        
        /* ============================================
           üì± SIDEBAR TESLA
           ============================================ */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
            transition: var(--transition);
        }
        
        .sidebar-header {
            padding: 2rem 1.5rem;
            border-bottom: 1px solid var(--glass-border);
            text-align: center;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: 800;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }
        
        .user-info {
            margin-top: 1rem;
        }
        
        .user-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 0.5rem;
            font-size: 1.5rem;
            color: white;
        }
        
        .user-name {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .user-plan {
            color: var(--etudia-success);
            font-size: 0.9rem;
        }
        
        /* ============================================
           üìã NAVIGATION SIDEBAR COMPACTE
           ============================================ */
        .nav-menu {
            padding: 1rem 0;
        }
        
        .nav-item {
            margin: 0.2rem 1rem;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            padding: 0.6rem 1rem;
            color: var(--etudia-white);
            text-decoration: none;
            border-radius: var(--border-radius);
            transition: var(--transition);
            position: relative;
            font-size: 0.9rem;
        }
        
        .nav-link:hover {
            background: var(--glass-bg);
            transform: translateX(5px);
        }
        
        .nav-link.active {
            background: var(--gradient-primary);
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }
        
        .nav-link i {
            width: 18px;
            margin-right: 0.75rem;
            text-align: center;
            font-size: 0.9rem;
        }
        
        /* ============================================
           üñ•Ô∏è MAIN CONTENT TESLA
           ============================================ */
        .main-content {
            margin-left: var(--sidebar-width);
            flex: 1;
            padding: 1.5rem;
            background: transparent;
        }
        
        .main-header {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            padding: 1.2rem 1.8rem;
            border-radius: var(--border-radius-lg);
            border: 1px solid var(--glass-border);
            margin-bottom: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .page-title {
            font-size: 1.8rem;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        
        .notification-btn, .chat-toggle {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            padding: 0.7rem;
            border-radius: 50%;
            color: var(--etudia-white);
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            font-size: 0.9rem;
        }
        
        .notification-btn:hover, .chat-toggle:hover {
            background: var(--etudia-primary);
            transform: scale(1.1);
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--etudia-secondary);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* ============================================
           üìä DASHBOARD CARDS COMPACTES
           ============================================ */
        .dashboard-section {
            margin-bottom: 1.5rem;
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--etudia-white);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .stat-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1.2rem;
            text-align: center;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            max-width: 250px;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--glass-shadow);
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-primary);
        }
        
        .stat-icon {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 0.8rem;
            font-size: 1.2rem;
            color: white;
        }
        
        .stat-value {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--etudia-white);
            margin-bottom: 0.3rem;
        }
        
        .stat-label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.85rem;
        }
        
        /* ============================================
           üìà ACTIVIT√â R√âCENTE - NOUVELLE SECTION
           ============================================ */
        .activity-section {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            
        }
        
        .activity-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.2rem;
        }
        
        .activity-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--etudia-white);
        }
        
        .view-all-btn {
            background: var(--etudia-primary);
            color: white;
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: var(--border-radius);
            font-size: 0.8rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .view-all-btn:hover {
            background: var(--etudia-secondary);
            transform: translateY(-1px);
        }
        
        .activity-list {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }
        
        .activity-item {
            display: flex;
            align-items: center;
            padding: 0.8rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: var(--border-radius);
            border: 1px solid var(--glass-border);
            transition: var(--transition);
        }
        
        .activity-item:hover {
            background: rgba(0, 0, 0, 0.3);
            transform: translateX(3px);
        }
        
        .activity-icon {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 0.8rem;
            font-size: 0.9rem;
            color: white;
        }
        
        .activity-icon.ia { background: var(--gradient-primary); }
        .activity-icon.document { background: var(--gradient-secondary); }
        .activity-icon.gain { background: linear-gradient(135deg, #F59E0B, #EF4444); }
        
        .activity-content {
            flex: 1;
        }
        
        .activity-text {
            font-weight: 500;
            margin-bottom: 0.2rem;
            font-size: 0.9rem;
        }
        
        .activity-details {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.8rem;
        }
        
        .activity-meta {
            text-align: right;
            font-size: 0.8rem;
        }
        
        .activity-time {
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 0.2rem;
        }
        
        .activity-value {
            color: var(--etudia-success);
            font-weight: 600;
        }
        
        .activity-value.negative {
            color: var(--etudia-warning);
        }
        
        /* ============================================
           üéØ QUICK ACTIONS COMPACTES
           ============================================ */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 0.8rem;
            margin-bottom: 1.5rem;
        }
        
        .action-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1rem;
            text-align: center;
            text-decoration: none;
            color: var(--etudia-white);
            transition: var(--transition);
            cursor: pointer;
            max-width: 200px;
        }
        
        .action-card:hover {
            transform: translateY(-2px);
            background: var(--etudia-primary);
            color: white;
        }
        
        .action-icon {
            font-size: 1.5rem;
            margin-bottom: 0.4rem;
            display: block;
        }
        
        .action-title {
            font-weight: 600;
            margin-bottom: 0.2rem;
            font-size: 0.9rem;
        }
        
        .action-desc {
            font-size: 0.75rem;
            opacity: 0.8;
        }
        
        /* ============================================
           üìÑ DOCUMENTS SECTION COMPACTE
           ============================================ */
        .documents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
        }
        
        .document-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1rem;
            transition: var(--transition);
            max-width: 350px;
        }
        
        .document-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--glass-shadow);
        }
        
        .document-item {
            display: flex;
            align-items: center;
            padding: 0.8rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: var(--border-radius);
            margin-bottom: 0.8rem;
        }
        
        .document-icon {
            margin-right: 0.8rem;
            font-size: 1.2rem;
        }
        
        .document-info {
            flex: 1;
        }
        
        .document-name {
            font-weight: 600;
            margin-bottom: 0.2rem;
            font-size: 0.9rem;
        }
        
        .document-meta {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.8rem;
        }
        
        .document-action {
            background: var(--etudia-primary);
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: var(--border-radius);
            color: white;
            cursor: pointer;
            font-size: 0.8rem;
            transition: var(--transition);
        }
        
        .document-action:hover {
            background: var(--etudia-secondary);
        }
        
        /* ============================================
           üí∞ PARRAINAGE SECTION V4.1 COMPACTE
           ============================================ */
        .parrainage-section {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .parrainage-header {
            text-align: center;
            margin-bottom: 1.2rem;
        }
        
        .parrainage-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--etudia-white);
            margin-bottom: 0.4rem;
        }
        
        .parrainage-subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }
        
        .parrainage-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.8rem;
            margin-bottom: 1.2rem;
        }
        
        .parrainage-stat {
            text-align: center;
            padding: 0.8rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: var(--border-radius);
            border: 1px solid var(--glass-border);
        }
        
        .parrainage-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--etudia-success);
            margin-bottom: 0.2rem;
        }
        
        .parrainage-label {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .referral-link-container {
            background: rgba(0, 0, 0, 0.2);
            padding: 0.8rem;
            border-radius: var(--border-radius);
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .referral-link {
            color: var(--etudia-success);
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            word-break: break-all;
        }
        
        .copy-btn {
            background: var(--etudia-info);
            border: none;
            padding: 0.3rem 0.6rem;
            margin-left: 0.5rem;
            border-radius: var(--border-radius);
            color: white;
            cursor: pointer;
            font-size: 0.7rem;
        }
        
        .share-buttons {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }
        
        .share-btn {
            padding: 0.6rem 1rem;
            border: none;
            border-radius: var(--border-radius);
            color: white;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            text-decoration: none;
            display: inline-block;
            font-size: 0.8rem;
        }
        
        .share-btn.whatsapp { background: #25D366; }
        .share-btn.facebook { background: #1877F2; }
        .share-btn.copy { background: var(--etudia-info); }
        
        .share-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        }
        
        .withdrawal-section {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(59, 130, 246, 0.1));
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: var(--border-radius);
            padding: 1rem;
            text-align: center;
        }
        
        .withdrawal-available {
            font-size: 1.1rem;
            color: var(--etudia-success);
            margin-bottom: 0.5rem;
        }
        
        .withdrawal-note {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 0.8rem;
        }
        
        .withdrawal-btn {
            background: var(--gradient-secondary);
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: var(--border-radius);
            color: white;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: var(--transition);
        }
        
        .withdrawal-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }
        
        /* ============================================
           üí≥ ABONNEMENTS SECTION BAS√âE SUR PLANS.HTML
           ============================================ */
        .subscription-section {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .current-plan {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(239, 68, 68, 0.1));
            border: 1px solid rgba(255, 107, 53, 0.3);
            border-radius: var(--border-radius);
            padding: 1.2rem;
            margin-bottom: 1.5rem;
        }
        
        .plan-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .plan-info h3 {
            color: var(--etudia-white);
            margin-bottom: 0.3rem;
            font-size: 1.1rem;
        }
        
        .plan-info p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.8rem;
        }
        
        .plan-price {
            text-align: right;
        }
        
        .price {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--etudia-success);
        }
        
        .currency {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .plan-usage {
            margin-bottom: 1rem;
        }
        
        .usage-stat {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        
        .usage-label {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .usage-value {
            color: var(--etudia-white);
            font-weight: 600;
        }
        
        .progress-bar {
            background: rgba(0, 0, 0, 0.3);
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: var(--gradient-primary);
            height: 100%;
            transition: width 0.3s ease;
        }
        
        .upgrade-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        
        .upgrade-card {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1rem;
            text-align: center;
            transition: var(--transition);
        }
        
        .upgrade-card:hover {
            border-color: var(--etudia-primary);
            background: rgba(255, 107, 53, 0.1);
        }
        
        .upgrade-card.popular {
            border-color: var(--etudia-success);
            background: rgba(16, 185, 129, 0.1);
        }
        
        .upgrade-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--etudia-white);
        }
        
        .upgrade-price {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--etudia-success);
            margin-bottom: 0.5rem;
        }
        
        .upgrade-features {
            list-style: none;
            margin-bottom: 1rem;
        }
        
        .upgrade-features li {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 0.3rem;
            padding-left: 1rem;
            position: relative;
        }
        
        .upgrade-features li::before {
            content: '‚úÖ';
            position: absolute;
            left: 0;
        }
        
        .upgrade-btn {
            background: var(--gradient-primary);
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: var(--border-radius);
            color: white;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.8rem;
            width: 100%;
            transition: var(--transition);
        }
        
        .upgrade-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.4);
        }
        
        /* ============================================
           ü§ñ BOUTON FLOTTANT INTERFACE IA
           ============================================ */
        .floating-ia-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: var(--gradient-primary);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
            z-index: 999;
            transition: var(--transition);
            animation: pulse 2s infinite;
        }
        
        .floating-ia-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 35px rgba(255, 107, 53, 0.6);
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        /* ============================================
           üì± RESPONSIVE TESLA
           ============================================ */
        .mobile-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            @media (max-width: 1200px) {
    .stats-grid {
        grid-template-columns: repeat(3, 1fr) !important;
        display: grid !important;
        overflow-x: visible !important;
    }
}

@media (max-width: 768px) {
    .stats-grid {
        grid-template-columns: repeat(2, 1fr) !important;
    }
}
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .mobile-overlay.active {
                display: block;
            }
            
            .main-content {
                margin-left: 0;
                padding: 1rem;
            }
            
            .main-header {
                padding: 1rem;
            }
            
            .page-title {
                font-size: 1.4rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .documents-grid {
                grid-template-columns: 1fr;
            }
            
            .parrainage-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .upgrade-options {
                grid-template-columns: 1fr;
            }
            
            .share-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .floating-ia-btn {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
        }
        
        /* ============================================
           üîî NOTIFICATIONS TOAST
           ============================================ */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
        }
        
        .toast {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 0.8rem 1.2rem;
            margin-bottom: 0.5rem;
            color: var(--etudia-white);
            box-shadow: var(--glass-shadow);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            max-width: 300px;
            font-size: 0.9rem;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.success { border-left: 4px solid var(--etudia-success); }
        .toast.error { border-left: 4px solid var(--etudia-secondary); }
        .toast.warning { border-left: 4px solid var(--etudia-warning); }
        .toast.info { border-left: 4px solid var(--etudia-info); }
        
        /* ============================================
           üéÆ MOBILE MENU
           ============================================ */
        .mobile-menu-btn {
            display: none;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            padding: 0.6rem;
            border-radius: var(--border-radius);
            color: var(--etudia-white);
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }
        }
        
        /* ============================================
           üéØ SECTIONS CONTENT
           ============================================ */
        .content-section {
            display: none;
        }
        
        .content-section.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .content-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .coming-soon {
            text-align: center;
            padding: 2rem 1rem;
        }
        
        .coming-soon-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .coming-soon h3 {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            color: var(--etudia-white);
        }
        
        .coming-soon p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }
        
        /* ============================================
           üìä INTERFACE IA CHAT COMPL√àTE
           ============================================ */
        .ia-chat-interface {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            height: 600px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .ia-header {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.2), rgba(239, 68, 68, 0.2));
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .ia-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--etudia-white);
        }
        
        .ia-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
        }
        
        .status-indicator {
            width: 8px;
            height: 8px;
            background: var(--etudia-success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .learning-modes {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .mode-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 0.4rem 0.8rem;
            color: white;
            font-size: 0.75rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .mode-btn:hover, .mode-btn.active {
            background: var(--etudia-primary);
            border-color: var(--etudia-primary);
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.8), rgba(30, 41, 59, 0.8));
        }
        
        .message {
            display: flex;
            margin-bottom: 1rem;
            align-items: flex-start;
            gap: 0.8rem;
        }
        
        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            flex-shrink: 0;
        }
        
        .ai-message .message-avatar {
            background: var(--gradient-primary);
        }
        
        .user-message .message-avatar {
            background: var(--gradient-secondary);
        }
        
        .message-content {
            flex: 1;
            background: rgba(30, 41, 59, 0.7);
            border-radius: 12px;
            padding: 0.8rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .message-text {
            color: var(--etudia-white);
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .message-time {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.5);
            margin-top: 0.3rem;
        }
        
        .chat-input-zone {
            padding: 1rem;
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(51, 65, 85, 0.8));
            border-top: 1px solid var(--glass-border);
        }
        
        .input-container {
            display: flex;
            align-items: flex-end;
            gap: 0.8rem;
        }
        
        .chat-input {
            flex: 1;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 0.8rem;
            color: var(--etudia-white);
            resize: none;
            min-height: 40px;
            max-height: 120px;
            font-size: 0.9rem;
        }
        
        .chat-input:focus {
            outline: none;
            border-color: var(--etudia-primary);
            box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.2);
        }
        
        .chat-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .send-btn {
            background: var(--gradient-primary);
            border: none;
            border-radius: var(--border-radius);
            padding: 0.8rem;
            color: white;
            cursor: pointer;
            transition: var(--transition);
            min-width: 45px;
        }
        
        .send-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.4);
        }
        
        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .upload-zone {
            background: rgba(0, 0, 0, 0.3);
            border: 2px dashed var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            text-align: center;
            margin-bottom: 1rem;
            transition: var(--transition);
            cursor: pointer;
        }
        
        .upload-zone:hover {
            border-color: var(--etudia-primary);
            background: rgba(255, 107, 53, 0.1);
        }
        
        .upload-icon {
            font-size: 2rem;
            color: var(--etudia-primary);
            margin-bottom: 0.5rem;
        }
        
        .upload-text {
            color: var(--etudia-white);
            font-size: 0.9rem;
            margin-bottom: 0.3rem;
        }
        
        .upload-formats {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
        }

<!-- ========================================== -->
<!-- ü§ñ D√âBUT PARTIE 1/3 - SECTION INTERFACE IA -->
<!-- CSS + CONFIGURATION COMPL√àTE -->
<!-- ========================================== -->

<style>
/* ===== CSS SP√âCIFIQUE INTERFACE IA ===== */

/* Container principal interface IA */
.ai-interface-container {
    background: var(--glass-bg);
    backdrop-filter: blur(20px);
    border: 1px solid var(--glass-border);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    height: calc(100vh - 200px);
    display: flex;
    flex-direction: column;
    position: relative;
    overflow: hidden;
}

/* Header interface IA */
.ia-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--glass-border);
}

.ia-title {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--etudia-white);
}

.ia-status {
    display: flex;
    align-items: center;
    gap: 1rem;
    font-size: 0.85rem;
    color: rgba(255, 255, 255, 0.7);
}

.status-indicator {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--etudia-success);
    animation: pulse 2s infinite;
}

/* Sessions management */
.sessions-container {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
    overflow-x: auto;
    padding-bottom: 0.5rem;
}

.session-tab {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 0.5rem 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    transition: all 0.3s ease;
    white-space: nowrap;
    min-width: fit-content;
}

.session-tab.active {
    background: var(--gradient-primary);
    border-color: var(--etudia-primary);
    color: white;
}

.session-tab:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateY(-2px);
}

.session-close {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    border-radius: 50%;
    width: 18px;
    height: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 10px;
    color: white;
}

.new-session-btn {
    background: var(--gradient-secondary);
    border: none;
    border-radius: 8px;
    padding: 0.5rem 1rem;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.85rem;
    transition: all 0.3s ease;
    min-width: fit-content;
}

.new-session-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
}

/* Modes d'apprentissage */
.modes-container {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
}

.mode-btn {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 0.5rem 1rem;
    color: rgba(255, 255, 255, 0.8);
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.85rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.mode-btn.active {
    background: var(--gradient-primary);
    border-color: var(--etudia-primary);
    color: white;
    transform: translateY(-2px);
}

.mode-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateY(-2px);
}

/* Zone principale avec panneau documents */
.main-container {
    display: flex;
    flex: 1;
    gap: 1rem;
    overflow: hidden;
}

/* Zone de messages */
.chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.02);
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.05);
    scroll-behavior: smooth;
}

/* Messages */
.message {
    display: flex;
    gap: 1rem;
    margin-bottom: 1.5rem;
    animation: slideInUp 0.3s ease;
}

.message-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    flex-shrink: 0;
}

.user-message .message-avatar {
    background: var(--gradient-primary);
    color: white;
}

.ai-message .message-avatar {
    background: var(--gradient-secondary);
    color: white;
}

.message-content {
    flex: 1;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 1rem;
    position: relative;
}

.message-text {
    color: var(--etudia-white);
    line-height: 1.6;
    margin-bottom: 0.5rem;
}

.message-metadata {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.5);
    margin-top: 0.5rem;
    display: flex;
    gap: 1rem;
    align-items: center;
}

.message-time {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.5);
    margin-top: 0.5rem;
}

/* Message de bienvenue sp√©cial */
.welcome .message-content {
    background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(16, 185, 129, 0.1));
    border: 1px solid rgba(255, 107, 53, 0.3);
}

/* Indicateur de frappe */
.typing-indicator {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: rgba(255, 255, 255, 0.7);
}

.typing-dots {
    display: flex;
    gap: 4px;
}

.typing-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--etudia-primary);
    animation: typingDots 1.4s ease-in-out infinite both;
}

.typing-dot:nth-child(1) { animation-delay: -0.32s; }
.typing-dot:nth-child(2) { animation-delay: -0.16s; }

@keyframes typingDots {
    0%, 80%, 100% { 
        transform: scale(0);
        opacity: 0.5;
    }
    40% { 
        transform: scale(1);
        opacity: 1;
    }
}

/* Panneau documents */
.documents-panel {
    width: 300px;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    padding: 1rem;
    display: none;
    flex-direction: column;
    overflow: hidden;
}

.documents-panel.active {
    display: flex;
}

.documents-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.documents-header h4 {
    color: var(--etudia-white);
    margin: 0;
    font-size: 1rem;
}

.close-panel {
    background: none;
    border: none;
    color: rgba(255, 255, 255, 0.6);
    cursor: pointer;
    font-size: 1rem;
    padding: 0.25rem;
    border-radius: 4px;
    transition: all 0.3s ease;
}

.close-panel:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
}

/* Zone upload dans le panneau */
.upload-zone-panel {
    border: 2px dashed rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    padding: 2rem 1rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: 1rem;
}

.upload-zone-panel:hover {
    border-color: var(--etudia-primary);
    background: rgba(255, 107, 53, 0.05);
}

.upload-zone-panel.dragover {
    border-color: var(--etudia-success);
    background: rgba(16, 185, 129, 0.1);
}

/* Liste des documents */
.documents-list {
    flex: 1;
    overflow-y: auto;
}

.document-item {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    padding: 0.75rem;
    margin-bottom: 0.5rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    transition: all 0.3s ease;
}

.document-item:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateX(5px);
}

.document-item.selected {
    background: rgba(255, 107, 53, 0.2);
    border: 1px solid var(--etudia-primary);
}

.document-info {
    flex: 1;
}

.document-name {
    color: var(--etudia-white);
    font-weight: 500;
    margin-bottom: 0.25rem;
}

.document-meta {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.6);
}

.document-actions {
    display: flex;
    gap: 0.5rem;
}

.doc-action-btn {
    background: none;
    border: none;
    color: rgba(255, 255, 255, 0.6);
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 4px;
    transition: all 0.3s ease;
}

.doc-action-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
}

/* Zone d'input */
.input-section {
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    padding: 1rem;
    margin-top: 1rem;
}

.input-controls {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.control-btn {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 0.5rem;
    color: rgba(255, 255, 255, 0.8);
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.85rem;
}

.control-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateY(-2px);
}

.control-btn.active {
    background: var(--gradient-primary);
    color: white;
}

.input-container {
    display: flex;
    gap: 0.5rem;
    align-items: flex-end;
}

.message-input {
    flex: 1;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    padding: 0.75rem 1rem;
    color: var(--etudia-white);
    font-family: inherit;
    font-size: 0.95rem;
    resize: none;
    min-height: 45px;
    max-height: 120px;
    overflow-y: auto;
    transition: all 0.3s ease;
}

.message-input:focus {
    outline: none;
    border-color: var(--etudia-primary);
    background: rgba(255, 255, 255, 0.08);
}

.message-input::placeholder {
    color: rgba(255, 255, 255, 0.4);
}

.send-btn {
    background: var(--gradient-primary);
    border: none;
    border-radius: 50%;
    width: 45px;
    height: 45px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 1.1rem;
    flex-shrink: 0;
}

.send-btn:hover:not(:disabled) {
    transform: scale(1.05);
    box-shadow: 0 4px 12px rgba(255, 107, 53, 0.3);
}

.send-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.input-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 0.5rem;
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.5);
}

.char-count {
    color: rgba(255, 255, 255, 0.4);
}

.shortcuts-hint {
    color: rgba(255, 255, 255, 0.4);
}

/* Animations */
@keyframes slideInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

/* Responsive */
@media (max-width: 768px) {
    .main-container {
        flex-direction: column;
    }
    
    .documents-panel {
        width: 100%;
        max-height: 300px;
    }
    
    .modes-container {
        overflow-x: auto;
        flex-wrap: nowrap;
    }
    
    .sessions-container {
        overflow-x: auto;
    }
    
    .input-container {
        flex-direction: column;
        gap: 0.75rem;
    }
    
    .send-btn {
        align-self: flex-end;
    }
}

/* Upload progress */
.upload-progress {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.progress-bar {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    height: 6px;
    overflow: hidden;
    margin-top: 0.5rem;
}

.progress-fill {
    background: var(--gradient-primary);
    height: 100%;
    transition: width 0.3s ease;
    border-radius: 4px;
}

/* Notifications */
.notification {
    position: fixed;
    top: 20px;
    right: 20px;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 8px;
    padding: 1rem;
    color: white;
    z-index: 1000;
    animation: slideInRight 0.3s ease;
    min-width: 300px;
}

.notification.success {
    border-color: var(--etudia-success);
    background: rgba(16, 185, 129, 0.1);
}

.notification.error {
    border-color: var(--etudia-danger);
    background: rgba(239, 68, 68, 0.1);
}

.notification.info {
    border-color: var(--etudia-accent);
    background: rgba(59, 130, 246, 0.1);
}

@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(100%);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}
</style>

<script>
// ===== CONFIGURATION ETUDIA IA =====
const ETUDIA_CONFIG = {
    // Configuration OpenRouter
    api: {
        baseUrl: 'https://openrouter.ai/api/v1/chat/completions',
        model: 'deepseek/deepseek-r1-distill-llama-70b',
        fallbackModel: 'meta-llama/llama-3.1-8b-instruct:free'
    },
    
    // Configuration Supabase 
    supabase: {
        url: 'https://eolmishmjgrnagceuiit.supabase.co',
        key: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVvbG1pc2htamdybmFnY2V1aWl0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQ5NDA3MDMsImV4cCI6MjA1MDUxNjcwM30.uRoJDfYW-C7u52ZP6AXGR7_5_xF9yFp6YBVR_-W_4SE'
    },
    
    // Modes d'apprentissage
    modes: {
        conversation: {
            name: 'Conversation',
            icon: 'üí¨',
            tokens: 250,
            prompt: `Tu es √âtudIA, assistant IA √©ducatif r√©volutionnaire pour l'Afrique. 

üéØ MISSION: Aider les √©tudiants africains √† r√©ussir avec excellence acad√©mique.

üåç CONTEXTE AFRICAIN: 
- Programmes √©ducatifs CI/Afrique de l'Ouest
- R√©alit√©s socio-√©conomiques locales  
- D√©fis infrastructurels (connexion limit√©e)
- Langues: Fran√ßais + expressions locales appropri√©es

üéì M√âTHODE P√âDAGOGIQUE:
- Explications progressives adapt√©es au niveau
- Exemples concrets du quotidien africain
- Encouragement et motivation constante
- Guidance sans donner directement les r√©ponses
- D√©veloppement de l'autonomie intellectuelle

üí¨ STYLE: Bienveillant, patient, inspirant comme un grand fr√®re/s≈ìur acad√©mique.`
        },
        step_by_step: {
            name: '√âtape par √âtape',
            icon: 'üìä',
            tokens: 180,
            prompt: `Tu es √âtudIA en mode "√âtape par √âtape" - sp√©cialis√© dans la d√©composition m√©thodique.

üéØ MISSION: D√©composer chaque probl√®me en √©tapes claires et progressives.

üìä M√âTHODE STRUCTUR√âE:
1. Identifier le type de probl√®me
2. Lister les √©tapes n√©cessaires  
3. Expliquer chaque √©tape s√©par√©ment
4. V√©rifier la compr√©hension avant de continuer
5. Synth√®se finale

‚úÖ R√àGLES STRICTES:
- UNE seule √©tape √† la fois
- Attendre validation avant de continuer  
- Sch√©mas et diagrammes quand possible
- Vocabulaire adapt√© au niveau de l'√©l√®ve
- Exemples concrets √† chaque √©tape

üåç CONTEXTE: Programmes √©ducatifs africains, r√©alit√©s locales, encouragement constant.`
        },
        direct_solution: {
            name: 'Solution Directe',
            icon: '‚ö°',
            tokens: 400,
            prompt: `Tu es √âtudIA en mode "Solution Directe" - efficace et complet.

üéØ MISSION: Fournir des solutions compl√®tes avec explications d√©taill√©es.

‚ö° APPROCHE DIRECTE:
- Solution imm√©diate et compl√®te
- Explications d√©taill√©es de chaque partie
- M√©thodes alternatives si applicables
- Points cl√©s √† retenir
- Applications pratiques

üìö STRUCTURE R√âPONSE:
1. **Solution**: R√©ponse directe
2. **Explication**: Pourquoi cette solution
3. **M√©thode**: Comment y arriver
4. **V√©rification**: Comment s'assurer que c'est correct
5. **Extension**: Cas similaires ou variantes

üåç CONTEXTE: Programmes √©ducatifs africains, pr√©paration examens, efficacit√© acad√©mique.`
        },
        audio: {
            name: 'Mode Audio',
            icon: 'üé§',
            tokens: 200,
            prompt: `Tu es √âtudIA en mode "Audio" - optimis√© pour l'√©coute et la compr√©hension orale.

üé§ MISSION: R√©ponses adapt√©es √† l'apprentissage auditif et vocal.

üîä STYLE AUDIO:
- Langage naturel et fluide
- Phrases courtes et claires
- R√©p√©titions des points importants
- Intonations marqu√©es (!, ?, ...)
- Pauses logiques (... / ---)

üìª STRUCTURE ORALE:
1. Accueille chaleureusement
2. Reformule la question
3. Explique √©tape par √©tape √† voix haute
4. R√©sume les points cl√©s
5. Encourage et motive

üåç CONTEXTE: √âtudiants africains, apprentissage mobile, environnements bruyants, connexion limit√©e.

üí° NOTE: Tes r√©ponses seront lues √† voix haute, adapte ton style en cons√©quence.`
        }
    }
};

// Variables globales
let activeSessionId = 1;
let sessions = {
    1: {
        name: 'Session 1',
        messages: [],
        documents: [],
        createdAt: new Date()
    }
};
let currentMode = 'conversation';
let selectedDocuments = [];
let isRecording = false;
let recognition = null;

// √âl√©ments DOM (seront initialis√©s apr√®s chargement)
let chatMessages, messageInput, sendBtn;
</script>

<!-- ========================================== -->
<!-- ü§ñ FIN PARTIE 1/3 - CSS + CONFIGURATION -->
<!-- ========================================== -->
        
    </style>
</head>
<body>
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>
    
    <!-- Mobile Overlay -->
    <div class="mobile-overlay" id="mobileOverlay" onclick="closeMobileMenu()"></div>
    
    <!-- App Container -->
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">√âtudIA</div>
                <div class="user-info">
                    <div class="user-avatar">JB</div>
                    <div class="user-name">Jean-Baptiste DOSSO</div>
                    <div class="user-plan">Premium ‚Ä¢ 847 tokens</div>
                </div>
            </div>
            
            <nav class="nav-menu">
                <div class="nav-item">
                    <a href="#" class="nav-link active" onclick="showSection('dashboard')">
                        <i class="fas fa-home"></i>
                        <span>Tableau de Bord</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('ia-chat')">
                        <i class="fas fa-robot"></i>
                        <span>Interface IA</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('documents')">
                        <i class="fas fa-file-pdf"></i>
                        <span>Mes Documents</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('parrainage')">
                        <i class="fas fa-users"></i>
                        <span>Parrainage</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('abonnements')">
                        <i class="fas fa-credit-card"></i>
                        <span>Abonnements</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('progression')">
                        <i class="fas fa-chart-line"></i>
                        <span>Ma Progression</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('historique')">
                        <i class="fas fa-history"></i>
                        <span>Historique</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('gamification')">
                        <i class="fas fa-trophy"></i>
                        <span>Badges & Niveaux</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('notifications')">
                        <i class="fas fa-bell"></i>
                        <span>Notifications</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('profil')">
                        <i class="fas fa-user"></i>
                        <span>Mon Profil</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('parametres')">
                        <i class="fas fa-cog"></i>
                        <span>Param√®tres</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="showSection('support')">
                        <i class="fas fa-question-circle"></i>
                        <span>Aide & Support</span>
                    </a>
                </div>
            </nav>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="main-header">
                <div>
                    <button class="mobile-menu-btn" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="page-title">Bon apr√®s-midi Jean-Baptiste !</h1>
                </div>
                <div class="header-actions">
                    <button class="notification-btn" onclick="showNotifications()">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">5</span>
                    </button>
                    <button class="chat-toggle" onclick="toggleIA()">
                        <i class="fas fa-robot"></i>
                    </button>
                </div>
            </header>
            
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
               <div class="dashboard-section">
    <h2 class="section-title">üìä Vue d'ensemble</h2>
    <div class="stats-grid" style="display: grid; grid-template-columns: repeat(6, 1fr); gap: 1rem;">
        <!-- Carte 1 -->
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-coins"></i>
            </div>
            <div class="stat-value">847</div>
            <div class="stat-label">Tokens Restants</div>
        </div>
        
        <!-- Carte 2 -->
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-robot"></i>
            </div>
            <div class="stat-value">23</div>
            <div class="stat-label">Sessions IA Aujourd'hui</div>
        </div>
        
        <!-- Carte 3 -->
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-trophy"></i>
            </div>
            <div class="stat-value">Level 8</div>
            <div class="stat-label">2,340 XP</div>
        </div>
        
        <!-- Carte 4 -->
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-money-bill"></i>
            </div>
            <div class="stat-value">12,450 F</div>
            <div class="stat-label">Gains Parrainage</div>
        </div>
        
        <!-- Carte 5 -->
        <div class="stat-card">
            <div class="stat-icon" style="background: linear-gradient(135deg, #8B5CF6, #EC4899);">
                <i class="fas fa-star"></i>
            </div>
            <div class="stat-value">87%</div>
            <div class="stat-label">Taux de R√©ussite</div>
        </div>
        
        <!-- Carte 6 -->
        <div class="stat-card">
            <div class="stat-icon" style="background: linear-gradient(135deg, #10B981, #3B82F6);">
                <i class="fas fa-clock"></i>
            </div>
            <div class="stat-value">4.2h</div>
            <div class="stat-label">Temps d'√âtude/Jour</div>
        </div>
    </div>
</div>
                
               <!-- Activit√© R√©cente - NOUVELLE SECTION -->
<div class="dashboard-section">
    <h3 class="section-title">üìà Activit√© R√©cente</h3>
    <div class="activity-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
        <!-- √âl√©ment 1 -->
        <div class="activity-item">
            <div class="activity-icon ia">
                <i class="fas fa-robot"></i>
            </div>
            <div class="activity-content">
                <div class="activity-text">Session IA - Math√©matiques</div>
                <div class="activity-details">R√©solution d'√©quations du second degr√© avec DeepSeek R1</div>
            </div>
            <div class="activity-meta">
                <div class="activity-time">Il y a 2 heures</div>
                <div class="activity-value negative">-180 tokens</div>
            </div>
        </div>
        
        <!-- √âl√©ment 2 -->
        <div class="activity-item">
            <div class="activity-icon document">
                <i class="fas fa-file-pdf"></i>
            </div>
            <div class="activity-content">
                <div class="activity-text">Document Analys√©</div>
                <div class="activity-details">Cours_Physique_Chapitre_5.pdf trait√© avec succ√®s</div>
            </div>
            <div class="activity-meta">
                <div class="activity-time">Il y a 4 heures</div>
                <div class="activity-value negative">-120 tokens</div>
            </div>
        </div>
        
        <!-- √âl√©ment 3 -->
        <div class="activity-item">
            <div class="activity-icon gain">
                <i class="fas fa-money-bill"></i>
            </div>
            <div class="activity-content">
                <div class="activity-text">Gain Parrainage</div>
                <div class="activity-details">Commission de 1,300 FCFA re√ßue (Nouveau filleul)</div>
            </div>
            <div class="activity-meta">
                <div class="activity-time">Hier</div>
                <div class="activity-value">+1,300 FCFA</div>
            </div>
        </div>
        
        <!-- √âl√©ment 4 (Nouveau) -->
        <div class="activity-item">
            <div class="activity-icon" style="background: var(--gradient-secondary);">
                <i class="fas fa-book"></i>
            </div>
            <div class="activity-content">
                <div class="activity-text">Nouvelle Fiche</div>
                <div class="activity-details">Fiche de r√©vision cr√©√©e en Chimie Organique</div>
            </div>
            <div class="activity-meta">
                <div class="activity-time">Il y a 1 jour</div>
                <div class="activity-value negative">-75 tokens</div>
            </div>
        </div>
        
        <!-- √âl√©ment 5 (Nouveau) -->
        <div class="activity-item">
            <div class="activity-icon" style="background: linear-gradient(135deg, #8B5CF6, #EC4899);">
                <i class="fas fa-trophy"></i>
            </div>
            <div class="activity-content">
                <div class="activity-text">Badge D√©bloqu√©</div>
                <div class="activity-details">Nouveau badge: Expert en Algorithmes</div>
            </div>
            <div class="activity-meta">
                <div class="activity-time">Il y a 2 jours</div>
                <div class="activity-value" style="color: #F59E0B;">+50 XP</div>
            </div>
        </div>
        
        <!-- √âl√©ment 6 (Nouveau) -->
        <div class="activity-item">
            <div class="activity-icon" style="background: linear-gradient(135deg, #10B981, #3B82F6);">
                <i class="fas fa-chart-line"></i>
            </div>
            <div class="activity-content">
                <div class="activity-text">Progression</div>
                <div class="activity-details">Niveau 8 atteint (+5% r√©ussite)</div>
            </div>
            <div class="activity-meta">
                <div class="activity-time">Il y a 3 jours</div>
                <div class="activity-value" style="color: #10B981;">+200 XP</div>
            </div>
        </div>
    </div>
    <div style="text-align: center; margin-top: 1rem;">
        <button class="view-all-btn" onclick="showSection('historique')">Voir tout l'historique</button>
    </div>
</div>
                
                <div class="dashboard-section">
                    <h2 class="section-title">üöÄ Actions Rapides</h2>
                    <div class="quick-actions">
                        <div class="action-card" onclick="showSection('ia-chat')">
                            <i class="fas fa-robot action-icon"></i>
                            <div class="action-title">Chat avec l'IA</div>
                            <div class="action-desc">Poser une question √† DeepSeek R1</div>
                        </div>
                        <div class="action-card" onclick="showSection('documents')">
                            <i class="fas fa-upload action-icon"></i>
                            <div class="action-title">Upload Document</div>
                            <div class="action-desc">Analyser un PDF ou image</div>
                        </div>
                        <div class="action-card" onclick="showSection('parrainage')">
                            <i class="fas fa-share action-icon"></i>
                            <div class="action-title">Parrainer</div>
                            <div class="action-desc">Inviter des amis et gagner</div>
                        </div>
                        <div class="action-card" onclick="showSection('progression')">
                            <i class="fas fa-chart-line action-icon"></i>
                            <div class="action-title">Ma Progression</div>
                            <div class="action-desc">Voir mes statistiques</div>
                        </div>
                        <div class="action-card" onclick="showSection('abonnements')">
                            <i class="fas fa-credit-card action-icon"></i>
                            <div class="action-title">Acheter Tokens</div>
                            <div class="action-desc">Recharger mon compte</div>
                        </div>
                        <div class="action-card" onclick="showSection('gamification')">
                            <i class="fas fa-trophy action-icon"></i>
                            <div class="action-title">Mes Badges</div>
                            <div class="action-desc">Collection et r√©compenses</div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Interface IA Section - AM√âLIOR√âE AVEC CODE COMPLET -->
      <!-- ===== D√âBUT SECTION INTERFACE IA AUTO-CONTENUE ===== -->
<!-- ========================================== -->
<!-- ü§ñ D√âBUT PARTIE 2/3 - HTML INTERFACE IA COMPL√àTE -->
<!-- ========================================== -->

<!-- Section Interface IA -->
<section id="ia-chat" class="content-section">
    <div class="ai-interface-container">
        <!-- Header Interface IA -->
        <div class="ia-header">
            <div class="ia-title">
                <i class="fas fa-robot"></i>
                √âtudIA Chat V4.1
                <span class="ia-status">
                    <div class="status-indicator"></div>
                    <span id="currentMode">Conversation</span>
                    ‚Ä¢
                    <span>Session <span id="currentSessionNum">1</span></span>
                </span>
            </div>
            <div class="ia-controls">
                <button class="control-btn" id="documentsToggle" onclick="toggleDocumentsPanel()">
                    <i class="fas fa-folder"></i>
                    Documents
                </button>
                <button class="control-btn" onclick="clearCurrentSession()">
                    <i class="fas fa-broom"></i>
                    Effacer
                </button>
            </div>
        </div>

        <!-- Gestion des sessions -->
        <div class="sessions-container" id="sessionsContainer">
            <div class="session-tab active" data-session="1" onclick="switchToSession(1)">
                <i class="fas fa-comments"></i>
                <span>Session 1</span>
                <button class="session-close" onclick="event.stopPropagation(); closeSession(1)">√ó</button>
            </div>
            <button class="new-session-btn" onclick="createNewSession()">
                <i class="fas fa-plus"></i>
                Nouvelle Session
            </button>
        </div>

        <!-- Modes d'apprentissage -->
        <div class="modes-container">
            <button class="mode-btn active" data-mode="conversation" onclick="switchMode('conversation')">
                üí¨ Conversation
            </button>
            <button class="mode-btn" data-mode="step_by_step" onclick="switchMode('step_by_step')">
                üìä √âtape par √âtape
            </button>
            <button class="mode-btn" data-mode="direct_solution" onclick="switchMode('direct_solution')">
                ‚ö° Solution Directe
            </button>
            <button class="mode-btn" data-mode="audio" onclick="switchMode('audio')">
                üé§ Audio
            </button>
        </div>

        <!-- Container principal avec panneau documents -->
        <div class="main-container">
            <!-- Zone de messages -->
            <div class="chat-messages" id="chatMessages">
                <div class="message ai-message welcome">
                    <div class="message-avatar">ü§ñ</div>
                    <div class="message-content">
                        <div class="message-text">
                            Salut Aya ! Je suis ton assistant IA √âtudIA avec DeepSeek R1 üöÄ
                            <br><br>
                            <strong>Interface Multi-Sessions V4.1 maintenant active !</strong>
                            <br><br>
                            <strong>üÜï Nouvelles fonctionnalit√©s :</strong>
                            <ul>
                                <li>üí¨ <strong>Multi-sessions</strong> : Organise tes conversations par mati√®re</li>
                                <li>üìÅ <strong>Gestion documents</strong> : Upload et analyse tes fichiers</li>
                                <li>üîó <strong>API directe</strong> : Connexion OpenRouter ultra-rapide</li>
                                <li>üéØ <strong>4 modes adaptatifs</strong> : IA qui s'adapte √† ton apprentissage</li>
                            </ul>
                            <em>Commence par cr√©er une nouvelle session ou upload un document !</em>
                        </div>
                        <div class="message-time">Maintenant</div>
                    </div>
                </div>
            </div>

            <!-- Panneau documents (masqu√© par d√©faut) -->
            <div class="documents-panel" id="documentsPanel">
                <div class="documents-header">
                    <h4>üìÅ Mes Documents</h4>
                    <button class="close-panel" onclick="toggleDocumentsPanel()">‚úï</button>
                </div>
                
                <!-- Zone upload -->
                <div class="upload-zone-panel" id="uploadZonePanel" onclick="document.getElementById('fileInputPanel').click()">
                    <div style="display: flex; flex-direction: column; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; color: var(--etudia-primary);"></i>
                        <p style="margin: 0; color: rgba(255, 255, 255, 0.8); font-size: 0.9rem;">
                            Cliquez ou glissez vos documents ici
                        </p>
                        <p style="margin: 0; color: rgba(255, 255, 255, 0.5); font-size: 0.75rem;">
                            PDF, Images, Documents Word
                        </p>
                    </div>
                    <input type="file" id="fileInputPanel" hidden multiple accept=".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png,.gif">
                </div>

                <!-- Barre de progression upload -->
                <div id="uploadProgressPanel" style="display: none;">
                    <div class="upload-progress">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <span style="color: var(--etudia-white); font-size: 0.85rem;">Traitement OCR...</span>
                            <span id="progressPercentPanel" style="color: rgba(255, 255, 255, 0.7); font-size: 0.75rem;">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFillPanel" style="width: 0%;"></div>
                        </div>
                        <p id="progressTextPanel" style="margin: 0.5rem 0 0 0; color: rgba(255, 255, 255, 0.6); font-size: 0.75rem;">
                            Initialisation...
                        </p>
                    </div>
                </div>

                <!-- Contexte de session -->
                <div style="background: rgba(255, 255, 255, 0.05); border-radius: 8px; padding: 0.75rem; margin-bottom: 1rem;">
                    <h5 style="margin: 0 0 0.5rem 0; color: var(--etudia-white); font-size: 0.85rem;">
                        üìä Session <span id="panelSessionNum">1</span>
                    </h5>
                    <p style="margin: 0; color: rgba(255, 255, 255, 0.6); font-size: 0.75rem;">
                        Les documents upload√©s sont li√©s √† cette session
                    </p>
                </div>

                <!-- Liste des documents -->
                <div class="documents-list" id="documentsListPanel">
                    <!-- Les documents seront ajout√©s dynamiquement ici -->
                </div>

                <!-- Actions documents -->
                <div style="margin-top: auto; padding-top: 1rem; border-top: 1px solid rgba(255, 255, 255, 0.1);">
                    <button onclick="selectAllDocuments()" style="width: 100%; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 6px; padding: 0.5rem; color: rgba(255, 255, 255, 0.8); cursor: pointer; font-size: 0.85rem; margin-bottom: 0.5rem;">
                        <i class="fas fa-check-double"></i> S√©lectionner tout
                    </button>
                    <button onclick="clearSelectedDocuments()" style="width: 100%; background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 6px; padding: 0.5rem; color: var(--etudia-danger); cursor: pointer; font-size: 0.85rem;">
                        <i class="fas fa-trash"></i> Supprimer s√©lectionn√©s
                    </button>
                </div>
            </div>
        </div>

        <!-- Zone d'input -->
        <div class="input-section">
            <!-- Contr√¥les -->
            <div class="input-controls">
                <button class="control-btn" id="voiceBtn" onclick="toggleVoiceRecording()">
                    <i class="fas fa-microphone"></i>
                    <span id="voiceText">Vocal</span>
                </button>
                <button class="control-btn" onclick="insertTemplate('exercice')">
                    <i class="fas fa-calculator"></i>
                    Exercice
                </button>
                <button class="control-btn" onclick="insertTemplate('cours')">
                    <i class="fas fa-book"></i>
                    Cours
                </button>
                <button class="control-btn" onclick="insertTemplate('examen')">
                    <i class="fas fa-graduation-cap"></i>
                    Examen
                </button>
            </div>

            <!-- Input container -->
            <div class="input-container">
                <textarea 
                    id="messageInput"
                    class="message-input"
                    placeholder="Pose ta question √† √âtudIA... (Ctrl+K pour raccourcis)"
                    rows="1"
                    onkeydown="handleKeyDown(event)"
                    oninput="handleInputChange()"
                ></textarea>
                <button id="sendBtn" class="send-btn" onclick="sendMessage()" disabled>
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>

            <!-- Footer input -->
            <div class="input-footer">
                <div class="char-count">0/2000</div>
                <div class="shortcuts-hint">
                    Enter: envoyer ‚Ä¢ Shift+Enter: nouvelle ligne ‚Ä¢ Ctrl+K: raccourcis
                </div>
                <div id="selectedDocsInfo" style="color: var(--etudia-primary); font-size: 0.75rem;">
                    <!-- Info documents s√©lectionn√©s -->
                </div>
            </div>
        </div>
    </div>
</section>

<!-- ========================================== -->
<!-- ü§ñ FIN PARTIE 2/3 - HTML INTERFACE IA COMPL√àTE -->
<!-- ========================================== -->

            
            <!-- Documents Section - TAILLE R√âDUITE -->
            <section id="documents" class="content-section">
                <h2 class="section-title">üìÑ Gestion des Documents</h2>
                <div class="documents-grid">
                    <div class="document-card">
                        <h3 style="margin-bottom: 1rem; color: var(--etudia-white);">üìö Mes Documents R√©cents</h3>
                        <div class="document-item">
                            <i class="fas fa-file-pdf document-icon" style="color: var(--etudia-secondary);"></i>
                            <div class="document-info">
                                <div class="document-name">Cours_Mathematiques_Derivees.pdf</div>
                                <div class="document-meta">Analys√© il y a 2 heures ‚Ä¢ 15 questions r√©solues</div>
                            </div>
                            <button class="document-action" onclick="relaunchIA('derivees')">
                                Relancer IA
                            </button>
                        </div>
                        
                        <div class="document-item">
                            <i class="fas fa-image document-icon" style="color: var(--etudia-success);"></i>
                            <div class="document-info">
                                <div class="document-name">Exercice_Physique_Optique.jpg</div>
                                <div class="document-meta">Analys√© hier ‚Ä¢ 8 explications donn√©es</div>
                            </div>
                            <button class="document-action" onclick="relaunchIA('optique')">
                                Relancer IA
                            </button>
                        </div>
                        
                        <div class="document-item">
                            <i class="fas fa-file-word document-icon" style="color: var(--etudia-info);"></i>
                            <div class="document-info">
                                <div class="document-name">Redaction_Francais_Sujet.docx</div>
                                <div class="document-meta">Analys√© il y a 3 jours ‚Ä¢ Corrections effectu√©es</div>
                            </div>
                            <button class="document-action" onclick="relaunchIA('redaction')">
                                Relancer IA
                            </button>
                        </div>
                    </div>
                    
                    <div class="document-card">
                        <h3 style="margin-bottom: 1rem; color: var(--etudia-white);">üì§ Zone d'Upload</h3>
                        <div class="upload-zone" onclick="document.getElementById('documentsFileInput').click()">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">Glissez vos documents ici</div>
                            <div class="upload-formats">PDF, DOC, JPG, PNG (Max 10MB)</div>
                            <input type="file" id="documentsFileInput" style="display: none;" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" onchange="handleDocumentsUpload(this)">
                        </div>
                        
                        <div style="text-align: center; margin-top: 1rem;">
                            <button style="background: var(--gradient-primary); border: none; padding: 0.8rem 1.5rem; border-radius: var(--border-radius); color: white; cursor: pointer; font-weight: 600;">
                                <i class="fas fa-upload"></i> Choisir des Fichiers
                            </button>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Parrainage Section - SYST√àME V4.1 COMPLET -->
            <section id="parrainage" class="content-section">
                <h2 class="section-title">üí∞ Syst√®me de Parrainage V4.1</h2>
                <div class="parrainage-section">
                    <div class="parrainage-header">
                        <h3 class="parrainage-title">üöÄ Gagne avec tes Parrainages</h3>
                        <p class="parrainage-subtitle">Syst√®me multiniveau : 5% ‚Üí 3% ‚Üí 1% + Auto-r√©abonnement intelligent</p>
                    </div>
                    
                    <div class="parrainage-stats">
                        <div class="parrainage-stat">
                            <div class="parrainage-value">23</div>
                            <div class="parrainage-label">Filleuls Actifs</div>
                        </div>
                        <div class="parrainage-stat">
                            <div class="parrainage-value">12,450 F</div>
                            <div class="parrainage-label">Gains Totaux</div>
                        </div>
                        <div class="parrainage-stat">
                            <div class="parrainage-value">15.8%</div>
                            <div class="parrainage-label">Taux Conversion</div>
                        </div>
                        <div class="parrainage-stat">
                            <div class="parrainage-value">8,750 F</div>
                            <div class="parrainage-label">Disponible Retrait</div>
                        </div>
                    </div>
                    
                    <div class="referral-link-container">
                        <div style="margin-bottom: 0.5rem; font-weight: 600;">üîó Ton Lien de Parrainage :</div>
                        <div class="referral-link">https://etudia.ci/invite/JB-DOSSO-2024</div>
                        <button class="copy-btn" onclick="copyReferralLink()">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                    
                    <div class="share-buttons">
                        <a href="#" class="share-btn whatsapp" onclick="shareWhatsApp()">
                            <i class="fab fa-whatsapp"></i> WhatsApp
                        </a>
                        <a href="#" class="share-btn facebook" onclick="shareFacebook()">
                            <i class="fab fa-facebook"></i> Facebook
                        </a>
                        <button class="share-btn copy" onclick="copyReferralLink()">
                            <i class="fas fa-copy"></i> Copier Lien
                        </button>
                    </div>
                    
                    <div class="withdrawal-section">
                        <div class="withdrawal-available">üí∞ Montant disponible au retrait : 8,750 FCFA</div>
                        <div class="withdrawal-note">
                            Frais de retrait : 10% ‚Ä¢ Minimum : 1,000F ‚Ä¢ Auto-r√©abonnement : 3 mois garantis
                        </div>
                        <button class="withdrawal-btn" onclick="requestWithdrawal()">
                            üí≥ Demander un Retrait (7,875 F net)
                        </button>
                    </div>
                </div>
            </section>
            
            <!-- Abonnements Section - BAS√âE SUR PLANS.HTML -->
            <section id="abonnements" class="content-section">
                <h2 class="section-title">üí≥ Gestion des Abonnements</h2>
                <div class="subscription-section">
                    <div class="current-plan">
                        <div class="plan-header">
                            <div class="plan-info">
                                <h3>Plan Premium Mensuel</h3>
                                <p>1,500 interactions/mois ‚Ä¢ Support prioritaire ‚Ä¢ Tous modes inclus</p>
                            </div>
                            <div class="plan-price">
                                <span class="price">6,500</span>
                                <span class="currency">FCFA/mois</span>
                            </div>
                        </div>
                        
                        <div class="plan-usage">
                            <div class="usage-stat">
                                <span class="usage-label">Interactions utilis√©es ce mois</span>
                                <span class="usage-value">847 / 1,500</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 56%"></div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 1rem;">
                            <div style="color: var(--etudia-success); font-weight: 600;">
                                ‚úÖ Renouvellement automatique le 15 septembre 2025
                            </div>
                        </div>
                    </div>
                    
                    <h3 style="margin: 1.5rem 0 1rem 0; color: var(--etudia-white);">üöÄ Options d'Upgrade</h3>
                    <div class="upgrade-options">
                        <div class="upgrade-card popular">
                            <div class="upgrade-title">üëë Excellence Mensuel</div>
                            <div class="upgrade-price">10,000 FCFA</div>
                            <ul class="upgrade-features">
                                <li>6,000 interactions/mois (200/jour)</li>
                                <li>IA prioritaire</li>
                                <li>Support premium complet</li>
                                <li>Nouvelles fonctionnalit√©s en avant-premi√®re</li>
                                <li>Mentor IA personnalis√©</li>
                            </ul>
                            <button class="upgrade-btn" onclick="upgradeToExcellence()">
                                Upgrade vers Excellence
                            </button>
                        </div>
                        
                        <div class="upgrade-card">
                            <div class="upgrade-title">üìÖ Premium Jour</div>
                            <div class="upgrade-price">500 FCFA</div>
                            <ul class="upgrade-features">
                                <li>15 interactions pour 24h</li>
                                <li>Tous les modes IA</li>
                                <li>Upload documents</li>
                                <li>Support chat</li>
                            </ul>
                            <button class="upgrade-btn" onclick="buyDailyPlan()">
                                Acheter 1 Jour
                            </button>
                        </div>
                        
                        <div class="upgrade-card">
                            <div class="upgrade-title">üì¶ Pack Tokens</div>
                            <div class="upgrade-price">2,500 FCFA</div>
                            <ul class="upgrade-features">
                                <li>+500 tokens bonus</li>
                                <li>Valable 6 mois</li>
                                <li>Cumule avec abonnement</li>
                                <li>Pas d'expiration</li>
                            </ul>
                            <button class="upgrade-btn" onclick="buyTokenPack()">
                                Acheter Tokens
                            </button>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Progression Section -->
            <section id="progression" class="content-section">
                <h2 class="section-title">üìà Ma Progression</h2>
                <div class="content-card">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;">
                        <div>
                            <h4 style="margin-bottom: 1rem; color: var(--etudia-white);">üéØ Objectifs du Mois</h4>
                            <div style="space-y: 1rem;">
                                <div style="margin-bottom: 1rem;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                        <span>Sessions IA quotidiennes</span>
                                        <span style="color: var(--etudia-success);">23/25</span>
                                    </div>
                                    <div style="background: rgba(0,0,0,0.2); height: 8px; border-radius: 4px;">
                                        <div style="background: var(--etudia-success); height: 100%; width: 92%; border-radius: 4px;"></div>
                                    </div>
                                </div>
                                <div style="margin-bottom: 1rem;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                        <span>Documents analys√©s</span>
                                        <span style="color: var(--etudia-primary);">28/30</span>
                                    </div>
                                    <div style="background: rgba(0,0,0,0.2); height: 8px; border-radius: 4px;">
                                        <div style="background: var(--etudia-primary); height: 100%; width: 93%; border-radius: 4px;"></div>
                                    </div>
                                </div>
                                <div style="margin-bottom: 1rem;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                        <span>Parrainages r√©ussis</span>
                                        <span style="color: var(--etudia-warning);">3/5</span>
                                    </div>
                                    <div style="background: rgba(0,0,0,0.2); height: 8px; border-radius: 4px;">
                                        <div style="background: var(--etudia-warning); height: 100%; width: 60%; border-radius: 4px;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 style="margin-bottom: 1rem; color: var(--etudia-white);">üìä Statistiques Performance</h4>
                            <div style="display: grid; gap: 0.8rem;">
                                <div style="background: rgba(0,0,0,0.2); padding: 1rem; border-radius: var(--border-radius);">
                                    <div style="font-size: 1.4rem; color: var(--etudia-success); font-weight: 700;">87%</div>
                                    <div style="font-size: 0.9rem;">Taux de r√©ussite exercices</div>
                                </div>
                                <div style="background: rgba(0,0,0,0.2); padding: 1rem; border-radius: var(--border-radius);">
                                    <div style="font-size: 1.4rem; color: var(--etudia-info); font-weight: 700;">4.2h</div>
                                    <div style="font-size: 0.9rem;">Temps d'√©tude moyen/jour</div>
                                </div>
                                <div style="background: rgba(0,0,0,0.2); padding: 1rem; border-radius: var(--border-radius);">
                                    <div style="font-size: 1.4rem; color: var(--etudia-primary); font-weight: 700;">342</div>
                                    <div style="font-size: 0.9rem;">Questions r√©solues ce mois</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Autres sections avec coming soon -->
            <section id="historique" class="content-section">
                <h2 class="section-title">üìú Historique des Sessions</h2>
                <div class="content-card">
                    <div class="coming-soon">
                        <div class="coming-soon-icon">üìú</div>
                        <h3>Historique Complet</h3>
                        <p>Retrouve toutes tes conversations et documents trait√©s ici bient√¥t !</p>
                    </div>
                </div>
            </section>
            
            <section id="gamification" class="content-section">
                <h2 class="section-title">üèÜ Badges & Niveaux</h2>
                <div class="content-card">
                    <div class="coming-soon">
                        <div class="coming-soon-icon">üèÜ</div>
                        <h3>Syst√®me de Gamification</h3>
                        <p>Collectionne des badges et monte de niveau en utilisant √âtudIA !</p>
                    </div>
                </div>
            </section>
            
            <section id="notifications" class="content-section">
                <h2 class="section-title">üîî Centre de Notifications</h2>
                <div class="content-card">
                    <div class="coming-soon">
                        <div class="coming-soon-icon">üîî</div>
                        <h3>Notifications Intelligentes</h3>
                        <p>Re√ßois des alertes personnalis√©es pour optimiser ton apprentissage !</p>
                    </div>
                </div>
            </section>
            
            <section id="profil" class="content-section">
                <h2 class="section-title">üë§ Mon Profil</h2>
                <div class="content-card">
                    <div class="coming-soon">
                        <div class="coming-soon-icon">üë§</div>
                        <h3>Gestion du Profil</h3>
                        <p>Personnalise ton exp√©rience √âtudIA ici !</p>
                    </div>
                </div>
            </section>
            
            <section id="parametres" class="content-section">
                <h2 class="section-title">‚öôÔ∏è Param√®tres</h2>
                <div class="content-card">
                    <div class="coming-soon">
                        <div class="coming-soon-icon">‚öôÔ∏è</div>
                        <h3>Param√®tres Avanc√©s</h3>
                        <p>Configure √âtudIA selon tes pr√©f√©rences !</p>
                    </div>
                </div>
            </section>
            
            <section id="support" class="content-section">
                <h2 class="section-title">‚ùì Aide & Support</h2>
                <div class="content-card">
                    <div class="coming-soon">
                        <div class="coming-soon-icon">‚ùì</div>
                        <h3>Centre d'Aide</h3>
                        <p>Support 24/7 pour t'accompagner dans tes √©tudes !</p>
                    </div>
                </div>
            </section>
        </main>
    </div>
    
    <!-- Bouton Flottant Interface IA -->
    <button class="floating-ia-btn" onclick="toggleIA()" title="Interface IA">
        <i class="fas fa-robot"></i>
    </button>

 <script>   
<!-- ========================================== -->
<!-- ü§ñ D√âBUT PARTIE 3/3 - JAVASCRIPT INTERFACE IA COMPLET -->
<!-- ========================================== -->


// ===== INITIALISATION INTERFACE IA =====
document.addEventListener('DOMContentLoaded', function() {
    // Initialiser les √©l√©ments DOM
    chatMessages = document.getElementById('chatMessages');
    messageInput = document.getElementById('messageInput');
    sendBtn = document.getElementById('sendBtn');
    
    // Initialiser la reconnaissance vocale
    initVoiceRecognition();
    
    // Configurer drag & drop
    setupDragAndDrop();
    
    // Charger les donn√©es sauvegard√©es
    loadSavedData();
    
    // D√©marrer les sauvegardes automatiques
    startAutoSave();
    
    // Mettre √† jour les stats Supabase
    updateSupabaseStats();
    setInterval(updateSupabaseStats, 120000); // Toutes les 2 minutes
    
    console.log('ü§ñ Interface IA √âtudIA V4.1 initialis√©e');
});

// ===== GESTION DES SESSIONS =====
function createNewSession() {
    const newId = Math.max(...Object.keys(sessions).map(Number)) + 1;
    
    sessions[newId] = {
        name: `Session ${newId}`,
        messages: [],
        documents: [],
        createdAt: new Date()
    };
    
    // Cr√©er l'onglet
    const sessionsContainer = document.getElementById('sessionsContainer');
    const newSessionBtn = sessionsContainer.querySelector('.new-session-btn');
    
    const tabHtml = `
        <div class="session-tab" data-session="${newId}" onclick="switchToSession(${newId})">
            <i class="fas fa-comments"></i>
            <span>Session ${newId}</span>
            <button class="session-close" onclick="event.stopPropagation(); closeSession(${newId})">√ó</button>
        </div>
    `;
    
    newSessionBtn.insertAdjacentHTML('beforebegin', tabHtml);
    
    // Basculer vers la nouvelle session
    switchToSession(newId);
    
    showNotification(`‚úÖ Session ${newId} cr√©√©e`, 'success');
}

function switchToSession(sessionId) {
    // Sauvegarder les messages de la session actuelle
    if (sessions[activeSessionId]) {
        sessions[activeSessionId].messages = getCurrentMessages();
    }
    
    // Changer de session active
    activeSessionId = sessionId;
    
    // Mettre √† jour l'UI
    document.querySelectorAll('.session-tab').forEach(tab => {
        tab.classList.remove('active');
    });
    document.querySelector(`[data-session="${sessionId}"]`).classList.add('active');
    
    // Charger les messages de la session
    loadSessionMessages(sessionId);
    updateSessionDisplay();
    updateDocumentsPanel();
    
    console.log(`üìÑ Bascul√© vers session ${sessionId}`);
}

function closeSession(sessionId) {
    if (Object.keys(sessions).length <= 1) {
        showNotification('‚ùå Impossible de fermer la derni√®re session', 'error');
        return;
    }
    
    // Supprimer la session
    delete sessions[sessionId];
    
    // Supprimer l'onglet
    document.querySelector(`[data-session="${sessionId}"]`).remove();
    
    // Si c'√©tait la session active, basculer vers la premi√®re disponible
    if (activeSessionId === sessionId) {
        const firstSessionId = parseInt(Object.keys(sessions)[0]);
        switchToSession(firstSessionId);
    }
    
    showNotification(`‚úÖ Session ${sessionId} ferm√©e`, 'info');
}

function clearCurrentSession() {
    if (confirm('√ätes-vous s√ªr de vouloir effacer tous les messages de cette session ?')) {
        sessions[activeSessionId].messages = [];
        
        // Effacer l'affichage (garder le message de bienvenue)
        const welcomeMessage = chatMessages.querySelector('.welcome');
        chatMessages.innerHTML = '';
        if (welcomeMessage) {
            chatMessages.appendChild(welcomeMessage);
        }
        
        showNotification('üßπ Session effac√©e', 'info');
    }
}

function getCurrentMessages() {
    const messages = [];
    chatMessages.querySelectorAll('.message:not(.welcome)').forEach(msg => {
        const isAI = msg.classList.contains('ai-message');
        const content = msg.querySelector('.message-text').innerHTML;
        messages.push({
            type: isAI ? 'ai' : 'user',
            content: content,
            timestamp: new Date()
        });
    });
    return messages;
}

function loadSessionMessages(sessionId) {
    const session = sessions[sessionId];
    if (!session) return;
    
    // Vider les messages actuels (sauf le message de bienvenue)
    const welcomeMessage = chatMessages.querySelector('.welcome');
    chatMessages.innerHTML = '';
    if (welcomeMessage) {
        chatMessages.appendChild(welcomeMessage);
    }
    
    // Charger les messages de la session
    session.messages.forEach(msg => {
        addMessageToDOM(msg.type, msg.content);
    });
}

// ===== GESTION DES MODES D'APPRENTISSAGE =====
function switchMode(newMode) {
    currentMode = newMode;
    
    // Mise √† jour UI
    document.querySelectorAll('.mode-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    document.querySelector(`[data-mode="${newMode}"]`).classList.add('active');
    
    updateModeDisplay();
    showNotification(`üéØ Mode chang√©: ${ETUDIA_CONFIG.modes[newMode].name} ${ETUDIA_CONFIG.modes[newMode].icon}`, 'info');
}

function updateModeDisplay() {
    document.getElementById('currentMode').textContent = ETUDIA_CONFIG.modes[currentMode].name;
}

function updateSessionDisplay() {
    document.getElementById('currentSessionNum').textContent = activeSessionId;
    const panelElement = document.getElementById('panelSessionNum');
    if (panelElement) {
        panelElement.textContent = activeSessionId;
    }
}

// ===== GESTION DES ENTR√âES =====
function handleKeyDown(event) {
    if (event.key === 'Enter' && !event.shiftKey) {
        event.preventDefault();
        sendMessage();
    }
    
    // Raccourcis clavier
    if (event.ctrlKey) {
        switch(event.key) {
            case 'k':
                event.preventDefault();
                showShortcuts();
                break;
            case 'u':
                event.preventDefault();
                document.getElementById('fileInputPanel').click();
                break;
            case 'd':
                event.preventDefault();
                toggleDocumentsPanel();
                break;
            case 'n':
                event.preventDefault();
                createNewSession();
                break;
            case '1':
            case '2':
            case '3':
            case '4':
                event.preventDefault();
                const modes = ['conversation', 'step_by_step', 'direct_solution', 'audio'];
                switchMode(modes[parseInt(event.key) - 1]);
                break;
        }
    }
}

function handleInputChange() {
    updateCharCount();
    enableSendButton();
    autoResize(messageInput);
}

function updateCharCount() {
    const count = messageInput.value.length;
    document.querySelector('.char-count').textContent = `${count}/2000`;
}

function enableSendButton() {
    const hasText = messageInput.value.trim().length > 0;
    sendBtn.disabled = !hasText;
}

function autoResize(textarea) {
    textarea.style.height = 'auto';
    textarea.style.height = textarea.scrollHeight + 'px';
}

// ===== ENVOI DE MESSAGE AVEC API DIRECTE =====
async function sendMessage() {
    const message = messageInput.value.trim();
    if (!message) return;

    // Ajouter message utilisateur
    addMessageToDOM('user', message);
    
    // Nettoyer l'input
    messageInput.value = '';
    sendBtn.disabled = true;
    updateCharCount();
    messageInput.style.height = 'auto';

    // Afficher indicateur de frappe
    showTypingIndicator();

    try {
        // Pr√©parer le contexte
        const context = prepareContext();
        const systemPrompt = ETUDIA_CONFIG.modes[currentMode].prompt;
        
        // Construire les messages pour l'API
        const apiMessages = [
            { role: 'system', content: systemPrompt },
            ...context,
            { role: 'user', content: message }
        ];

        // Appel API OpenRouter
        const response = await fetch(ETUDIA_CONFIG.api.baseUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${getApiKey()}`,
                'HTTP-Referer': window.location.origin,
                'X-Title': '√âtudIA V4.1'
            },
            body: JSON.stringify({
                model: ETUDIA_CONFIG.api.model,
                messages: apiMessages,
                max_tokens: ETUDIA_CONFIG.modes[currentMode].tokens,
                temperature: 0.7,
                stream: false
            })
        });

        hideTypingIndicator();

        if (!response.ok) {
            throw new Error(`Erreur API: ${response.status}`);
        }

        const data = await response.json();
        const aiResponse = data.choices[0].message.content;
        
        // Ajouter la r√©ponse IA avec m√©tadonn√©es
        const metadata = {
            model: ETUDIA_CONFIG.api.model,
            tokens_used: data.usage?.total_tokens || 0,
            mode: currentMode,
            session: activeSessionId,
            document_context: selectedDocuments.length > 0,
            response_time: Date.now()
        };
        
        addMessageToDOM('ai', aiResponse, metadata);
        
        // Sauvegarder
        saveToLocal();
        
    } catch (error) {
        hideTypingIndicator();
        console.error('Erreur envoi message:', error);
        
        // Fallback avec r√©ponse de d√©monstration
        const fallbackResponse = generateFallbackResponse(message);
        addMessageToDOM('ai', fallbackResponse, {
            model: 'Mode d√©mo',
            demo_mode: true,
            session: activeSessionId
        });
        
        showNotification('‚ö†Ô∏è Mode d√©mo activ√© - API indisponible', 'warning');
    }
}

function prepareContext() {
    const context = [];
    
    // Ajouter le contexte des documents s√©lectionn√©s
    if (selectedDocuments.length > 0) {
        const docsContext = selectedDocuments.map(doc => {
            return `Document "${doc.name}":\n${doc.content}`;
        }).join('\n\n');
        
        context.push({
            role: 'system',
            content: `CONTEXTE DOCUMENTS:\n${docsContext}\n\nUtilise ces documents pour r√©pondre aux questions de l'√©tudiant.`
        });
    }
    
    // Ajouter l'historique r√©cent de la conversation
    const recentMessages = sessions[activeSessionId].messages.slice(-6); // 6 derniers messages
    recentMessages.forEach(msg => {
        context.push({
            role: msg.type === 'user' ? 'user' : 'assistant',
            content: typeof msg.content === 'string' ? msg.content.replace(/<[^>]*>/g, '') : msg.content
        });
    });
    
    return context;
}

function getApiKey() {
    // Cl√© API OpenRouter pour les appels directs
    return 'sk-or-v1-1a2b3c4d5e6f7g8h9i0j1k2l3m4n5o6p7q8r9s0t1u2v3w4x5y6z7a8b9c0d1e2f3g4h5i6j7k8l9m0';
}

function generateFallbackResponse(userMessage) {
    const responses = [
        "Excellente question ! En mode d√©mo, je simule une r√©ponse intelligente. Dans la version compl√®te, j'analyserais ton message avec DeepSeek R1 pour te donner une explication d√©taill√©e et adapt√©e √† ton niveau.",
        "C'est un sujet passionnant ! En mode d√©mo, je ne peux pas acc√©der √† l'IA compl√®te, mais je peux te dire que √âtudIA est con√ßu pour t'accompagner √©tape par √©tape dans ton apprentissage.",
        "Bonne approche ! En fonctionnement normal, j'utiliserais mes capacit√©s d'IA avanc√©e pour d√©composer ce probl√®me et t'expliquer chaque √©tape clairement.",
        "Int√©ressant ! Avec l'API compl√®te, je pourrais analyser tes documents upload√©s et te donner une r√©ponse personnalis√©e bas√©e sur ton contexte d'√©tude."
    ];
    
    return responses[Math.floor(Math.random() * responses.length)];
}

// ===== GESTION DES MESSAGES =====
function addMessageToDOM(type, content, metadata = null) {
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${type}-message`;
    
    const time = new Date().toLocaleTimeString('fr-FR', {
        hour: '2-digit',
        minute: '2-digit'
    });
    
    const avatar = type === 'user' ? 'üë®‚Äçüéì' : 'ü§ñ';
    
    let metadataInfo = '';
    if (metadata && type === 'ai') {
        metadataInfo = `
            <div class="message-metadata">
                ü§ñ ${metadata.model}
                ${metadata.tokens_used ? ` ‚Ä¢ üî¢ ${metadata.tokens_used} tokens` : ''}
                ${metadata.document_context ? ' ‚Ä¢ üìÑ Avec contexte' : ''}
                ${metadata.demo_mode ? ' ‚Ä¢ üîÑ Mode d√©mo' : ''}
            </div>
        `;
    }
    
    messageDiv.innerHTML = `
        <div class="message-avatar">${avatar}</div>
        <div class="message-content">
            <div class="message-text">${formatMessageContent(content)}</div>
            ${metadataInfo}
            <div class="message-time">${time}</div>
        </div>
    `;
    
    chatMessages.appendChild(messageDiv);
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

function formatMessageContent(content) {
    return content
        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
        .replace(/\*(.*?)\*/g, '<em>$1</em>')
        .replace(/\n/g, '<br>')
        .replace(/```(.*?)```/gs, '<pre style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 5px; margin: 10px 0; overflow-x: auto;"><code>$1</code></pre>')
        .replace(/`(.*?)`/g, '<code style="background: rgba(0,0,0,0.2); padding: 2px 4px; border-radius: 3px;">$1</code>');
}

function showTypingIndicator() {
    const typingDiv = document.createElement('div');
    typingDiv.id = 'typingIndicator';
    typingDiv.className = 'message ai-message';
    typingDiv.innerHTML = `
        <div class="message-avatar">ü§ñ</div>
        <div class="message-content">
            <div class="typing-indicator">
                <span>√âtudIA √©crit (Session ${activeSessionId})</span>
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>
        </div>
    `;
    
    chatMessages.appendChild(typingDiv);
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

function hideTypingIndicator() {
    const typingIndicator = document.getElementById('typingIndicator');
    if (typingIndicator) {
        typingIndicator.remove();
    }
}

// ===== GESTION DES DOCUMENTS =====
function toggleDocumentsPanel() {
    const panel = document.getElementById('documentsPanel');
    panel.classList.toggle('active');
    
    const btn = document.getElementById('documentsToggle');
    if (panel.classList.contains('active')) {
        btn.classList.add('active');
        updateDocumentsPanel();
    } else {
        btn.classList.remove('active');
    }
}

function updateDocumentsPanel() {
    const sessionDocs = sessions[activeSessionId].documents || [];
    const listContainer = document.getElementById('documentsListPanel');
    
    if (sessionDocs.length === 0) {
        listContainer.innerHTML = `
            <div style="text-align: center; padding: 2rem; color: rgba(255, 255, 255, 0.5);">
                <i class="fas fa-folder-open" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                <p>Aucun document dans cette session</p>
                <p style="font-size: 0.8rem;">Uploadez vos premiers documents !</p>
            </div>
        `;
        return;
    }
    
    listContainer.innerHTML = sessionDocs.map(doc => `
        <div class="document-item ${selectedDocuments.includes(doc) ? 'selected' : ''}" 
             onclick="toggleDocumentSelection('${doc.id}')">
            <div class="document-info">
                <div class="document-name">${doc.name}</div>
                <div class="document-meta">${doc.type} ‚Ä¢ ${doc.size} ‚Ä¢ ${doc.uploadDate}</div>
            </div>
            <div class="document-actions">
                <button class="doc-action-btn" onclick="event.stopPropagation(); viewDocument('${doc.id}')" title="Voir">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="doc-action-btn" onclick="event.stopPropagation(); deleteDocument('${doc.id}')" title="Supprimer">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        </div>
    `).join('');
    
    updateSelectedDocsInfo();
}

function setupDragAndDrop() {
    const uploadZone = document.getElementById('uploadZonePanel');
    const fileInput = document.getElementById('fileInputPanel');
    
    // √âv√©nements drag & drop
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        uploadZone.addEventListener(eventName, preventDefaults, false);
    });
    
    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }
    
    ['dragenter', 'dragover'].forEach(eventName => {
        uploadZone.addEventListener(eventName, highlight, false);
    });
    
    ['dragleave', 'drop'].forEach(eventName => {
        uploadZone.addEventListener(eventName, unhighlight, false);
    });
    
    function highlight() {
        uploadZone.classList.add('dragover');
    }
    
    function unhighlight() {
        uploadZone.classList.remove('dragover');
    }
    
    uploadZone.addEventListener('drop', handleDrop, false);
    fileInput.addEventListener('change', handleFileSelect, false);
    
    function handleDrop(e) {
        const files = e.dataTransfer.files;
        handleFiles(files);
    }
    
    function handleFileSelect(e) {
        const files = e.target.files;
        handleFiles(files);
    }
}

function handleFiles(files) {
    Array.from(files).forEach(file => {
        if (file.size > 10 * 1024 * 1024) { // 10MB max
            showNotification('‚ùå Fichier trop volumineux (max 10MB)', 'error');
            return;
        }
        
        processFile(file);
    });
}

async function processFile(file) {
    const uploadProgress = document.getElementById('uploadProgressPanel');
    const progressFill = document.getElementById('progressFillPanel');
    const progressPercent = document.getElementById('progressPercentPanel');
    const progressText = document.getElementById('progressTextPanel');
    
    uploadProgress.style.display = 'block';
    
    // Simulation du traitement OCR
    const steps = [
        { text: 'Lecture du fichier...', progress: 20 },
        { text: 'Extraction du texte...', progress: 50 },
        { text: 'Traitement OCR...', progress: 75 },
        { text: 'Finalisation...', progress: 100 }
    ];
    
    for (const step of steps) {
        progressText.textContent = step.text;
        progressFill.style.width = step.progress + '%';
        progressPercent.textContent = step.progress + '%';
        await new Promise(resolve => setTimeout(resolve, 800));
    }
    
    // Cr√©er l'objet document
    const doc = {
        id: 'doc_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
        name: file.name,
        type: file.type || 'unknown',
        size: formatFileSize(file.size),
        uploadDate: new Date().toLocaleDateString('fr-FR'),
        content: `Contenu simul√© du document ${file.name}. En mode production, le contenu r√©el serait extrait via OCR.`,
        sessionId: activeSessionId
    };
    
    // Ajouter √† la session courante
    if (!sessions[activeSessionId].documents) {
        sessions[activeSessionId].documents = [];
    }
    sessions[activeSessionId].documents.push(doc);
    
    // Masquer la barre de progression
    uploadProgress.style.display = 'none';
    
    // Mettre √† jour l'affichage
    updateDocumentsPanel();
    saveToLocal();
    
    showNotification(`‚úÖ Document "${file.name}" upload√© avec succ√®s`, 'success');
}

function formatFileSize(bytes) {
    if (bytes === 0) return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

function toggleDocumentSelection(docId) {
    const sessionDocs = sessions[activeSessionId].documents || [];
    const doc = sessionDocs.find(d => d.id === docId);
    
    if (!doc) return;
    
    const index = selectedDocuments.findIndex(d => d.id === docId);
    if (index > -1) {
        selectedDocuments.splice(index, 1);
    } else {
        selectedDocuments.push(doc);
    }
    
    updateDocumentsPanel();
}

function selectAllDocuments() {
    const sessionDocs = sessions[activeSessionId].documents || [];
    selectedDocuments = [...sessionDocs];
    updateDocumentsPanel();
    showNotification(`‚úÖ ${selectedDocuments.length} documents s√©lectionn√©s`, 'info');
}

function clearSelectedDocuments() {
    if (selectedDocuments.length === 0) {
        showNotification('‚ùå Aucun document s√©lectionn√©', 'warning');
        return;
    }
    
    if (confirm(`√ätes-vous s√ªr de vouloir supprimer ${selectedDocuments.length} document(s) ?`)) {
        selectedDocuments.forEach(selectedDoc => {
            const sessionDocs = sessions[activeSessionId].documents || [];
            const index = sessionDocs.findIndex(d => d.id === selectedDoc.id);
            if (index > -1) {
                sessionDocs.splice(index, 1);
            }
        });
        
        selectedDocuments = [];
        updateDocumentsPanel();
        saveToLocal();
        
        showNotification('üóëÔ∏è Documents supprim√©s', 'success');
    }
}

function deleteDocument(docId) {
    if (confirm('√ätes-vous s√ªr de vouloir supprimer ce document ?')) {
        const sessionDocs = sessions[activeSessionId].documents || [];
        const index = sessionDocs.findIndex(d => d.id === docId);
        
        if (index > -1) {
            sessionDocs.splice(index, 1);
            
            // Retirer de la s√©lection si pr√©sent
            const selectedIndex = selectedDocuments.findIndex(d => d.id === docId);
            if (selectedIndex > -1) {
                selectedDocuments.splice(selectedIndex, 1);
            }
            
            updateDocumentsPanel();
            saveToLocal();
            showNotification('üóëÔ∏è Document supprim√©', 'success');
        }
    }
}

function viewDocument(docId) {
    const sessionDocs = sessions[activeSessionId].documents || [];
    const doc = sessionDocs.find(d => d.id === docId);
    
    if (doc) {
        alert(`Document: ${doc.name}\n\nContenu:\n${doc.content}`);
    }
}

function updateSelectedDocsInfo() {
    const infoElement = document.getElementById('selectedDocsInfo');
    if (selectedDocuments.length > 0) {
        infoElement.textContent = `üìé ${selectedDocuments.length} document(s) s√©lectionn√©(s)`;
    } else {
        infoElement.textContent = '';
    }
}

// ===== GESTION RECONNAISSANCE VOCALE =====
function initVoiceRecognition() {
    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SpeechRecognition();
        
        recognition.continuous = false;
        recognition.interimResults = false;
        recognition.lang = 'fr-FR';
        
        recognition.onstart = function() {
            isRecording = true;
            document.getElementById('voiceText').textContent = 'Arr√™ter';
            document.getElementById('voiceBtn').style.background = 'var(--etudia-danger)';
            showNotification('üé§ √âcoute en cours...', 'info');
        };
        
        recognition.onresult = function(event) {
            const transcript = event.results[0][0].transcript;
            messageInput.value = transcript;
            handleInputChange();
            showNotification('‚úÖ Parole reconnue', 'success');
        };
        
        recognition.onerror = function(event) {
            showNotification('‚ùå Erreur reconnaissance vocale', 'error');
            resetVoiceButton();
        };
        
        recognition.onend = function() {
            resetVoiceButton();
        };
    } else {
        // Masquer le bouton vocal si non support√©
        document.getElementById('voiceBtn').style.display = 'none';
    }
}

function toggleVoiceRecording() {
    if (!recognition) {
        showNotification('‚ùå Reconnaissance vocale non support√©e', 'error');
        return;
    }
    
    if (isRecording) {
        recognition.stop();
    } else {
        recognition.start();
    }
}

function resetVoiceButton() {
    isRecording = false;
    document.getElementById('voiceText').textContent = 'Vocal';
    document.getElementById('voiceBtn').style.background = '';
}

// ===== TEMPLATES ET RACCOURCIS =====
function insertTemplate(type) {
    const templates = {
        exercice: "J'ai un exercice de [mati√®re] sur [sujet]. Voici l'√©nonc√© :\n\n[Coller l'√©nonc√© ici]\n\nPeux-tu m'aider √©tape par √©tape ?",
        cours: "Je r√©vise le cours de [mati√®re] sur [chapitre]. J'ai des difficult√©s √† comprendre [concept sp√©cifique]. Peux-tu m'expliquer simplement ?",
        examen: "Je pr√©pare mon examen de [mati√®re] qui aura lieu [date]. Voici les points que je dois r√©viser :\n\n- [Point 1]\n- [Point 2]\n- [Point 3]\n\nPar quoi commencer ?"
    };
    
    messageInput.value = templates[type] || '';
    handleInputChange();
    messageInput.focus();
}

function showShortcuts() {
    const shortcuts = `
üéØ RACCOURCIS CLAVIER √âTUDIA :

‚å®Ô∏è NAVIGATION :
‚Ä¢ Ctrl + K : Afficher les raccourcis
‚Ä¢ Ctrl + U : Upload document
‚Ä¢ Ctrl + D : Panneau documents
‚Ä¢ Ctrl + N : Nouvelle session
‚Ä¢ Ctrl + Tab : Session suivante

ü§ñ MODES IA :
‚Ä¢ Ctrl + 1 : Mode Conversation
‚Ä¢ Ctrl + 2 : Mode √âtape par √âtape  
‚Ä¢ Ctrl + 3 : Mode Solution Directe
‚Ä¢ Ctrl + 4 : Mode Audio

üí¨ CHAT :
‚Ä¢ Enter : Envoyer message
‚Ä¢ Shift + Enter : Nouvelle ligne
‚Ä¢ Ctrl + L : Effacer session
    `;
    
    alert(shortcuts);
}

// ===== SAUVEGARDE ET CHARGEMENT =====
function saveToLocal() {
    try {
        const dataToSave = {
            sessions: sessions,
            activeSessionId: activeSessionId,
            currentMode: currentMode,
            selectedDocuments: selectedDocuments,
            lastSaved: new Date().toISOString()
        };
        
        localStorage.setItem('etudia_interface_data', JSON.stringify(dataToSave));
        console.log('üíæ Donn√©es sauvegard√©es localement');
    } catch (error) {
        console.warn('‚ö†Ô∏è Erreur sauvegarde locale:', error);
    }
}

function loadSavedData() {
    try {
        const savedData = localStorage.getItem('etudia_interface_data');
        if (!savedData) return;
        
        const data = JSON.parse(savedData);
        
        // Restaurer les sessions
        if (data.sessions && Object.keys(data.sessions).length > 0) {
            sessions = data.sessions;
            activeSessionId = data.activeSessionId || 1;
            currentMode = data.currentMode || 'conversation';
            selectedDocuments = data.selectedDocuments || [];
            
            // Reconstruire l'interface
            rebuildSessionsUI();
            switchToSession(activeSessionId);
            switchMode(currentMode);
            
            console.log('üìÇ Donn√©es charg√©es depuis le stockage local');
            showNotification('‚úÖ Session restaur√©e', 'info');
        }
    } catch (error) {
        console.warn('‚ö†Ô∏è Erreur chargement donn√©es:', error);
    }
}

function rebuildSessionsUI() {
    const container = document.getElementById('sessionsContainer');
    const newSessionBtn = container.querySelector('.new-session-btn');
    
    // Supprimer les onglets existants
    container.querySelectorAll('.session-tab').forEach(tab => tab.remove());
    
    // Recr√©er les onglets
    Object.keys(sessions).forEach(sessionId => {
        const tabHtml = `
            <div class="session-tab" data-session="${sessionId}" onclick="switchToSession(${sessionId})">
                <i class="fas fa-comments"></i>
                <span>Session ${sessionId}</span>
                <button class="session-close" onclick="event.stopPropagation(); closeSession(${sessionId})">√ó</button>
            </div>
        `;
        newSessionBtn.insertAdjacentHTML('beforebegin', tabHtml);
    });
}

function startAutoSave() {
    // Sauvegarde automatique toutes les 30 secondes
    setInterval(() => {
        saveToLocal();
    }, 30000);
}

// ===== STATS SUPABASE =====
async function updateSupabaseStats() {
    try {
        // Simulation des stats - remplacer par vrais appels Supabase
        const stats = {
            total_eleves: 289 + Math.floor(Math.random() * 10),
            total_documents: 2156 + Math.floor(Math.random() * 50),
            total_conversations: 15623 + Math.floor(Math.random() * 100),
            tokens_consommes: 847263 + Math.floor(Math.random() * 1000)
        };
        
        // Mettre √† jour l'affichage dans le dashboard si visible
        if (typeof updateDashboardStats === 'function') {
            updateDashboardStats(stats);
        }
        
        console.log('üìä Stats Supabase mises √† jour:', stats);
        
    } catch (error) {
        console.warn('‚ö†Ô∏è Erreur mise √† jour stats Supabase:', error);
    }
}

// ===== NOTIFICATIONS =====
function showNotification(message, type = 'info') {
    // Supprimer les notifications existantes
    document.querySelectorAll('.notification').forEach(notif => notif.remove());
    
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.innerHTML = `
        <div style="display: flex; align-items: center; gap: 0.5rem;">
            <i class="fas fa-${getNotificationIcon(type)}"></i>
            <span>${message}</span>
        </div>
    `;
    
    document.body.appendChild(notification);
    
    // Auto-suppression apr√®s 4 secondes
    setTimeout(() => {
        if (notification.parentNode) {
            notification.remove();
        }
    }, 4000);
}

function getNotificationIcon(type) {
    const icons = {
        success: 'check-circle',
        error: 'exclamation-triangle',
        warning: 'exclamation-circle',
        info: 'info-circle'
    };
    return icons[type] || 'info-circle';
}

// ===== UTILITAIRES =====
function formatTime(date) {
    return new Date(date).toLocaleTimeString('fr-FR', {
        hour: '2-digit',
        minute: '2-digit'
    });
}

function formatDate(date) {
    return new Date(date).toLocaleDateString('fr-FR');
}

// ===== √âV√âNEMENTS GLOBAUX =====
window.addEventListener('beforeunload', function() {
    saveToLocal();
});

// Gestion des raccourcis globaux
document.addEventListener('keydown', function(event) {
    // Ctrl+Tab pour changer de session
    if (event.ctrlKey && event.key === 'Tab') {
        event.preventDefault();
        const sessionIds = Object.keys(sessions).map(Number).sort();
        const currentIndex = sessionIds.indexOf(activeSessionId);
        const nextIndex = (currentIndex + 1) % sessionIds.length;
        switchToSession(sessionIds[nextIndex]);
    }
    
    // √âchap pour fermer le panneau documents
    if (event.key === 'Escape') {
        const panel = document.getElementById('documentsPanel');
        if (panel.classList.contains('active')) {
            toggleDocumentsPanel();
        }
    }
});

// ===== INT√âGRATION AVEC LE BACKOFFICE =====
function initializeIAInterface() {
    // Cette fonction sera appel√©e quand la section IA est affich√©e
    updateSessionDisplay();
    updateModeDisplay();
    updateDocumentsPanel();
    
    // Focus sur l'input si visible
    if (messageInput && messageInput.offsetParent !== null) {
        messageInput.focus();
    }
}

// Appeler l'initialisation quand la section IA devient active
document.addEventListener('sectionChanged', function(event) {
    if (event.detail.sectionId === 'ia-chat') {
        initializeIAInterface();
    }
});

console.log('ü§ñ Interface IA √âtudIA V4.1 - JavaScript charg√© avec succ√®s');


<!-- ========================================== -->
<!-- ü§ñ FIN PARTIE 3/3 - JAVASCRIPT INTERFACE IA COMPLET -->
<!-- ========================================== -->
    

        // Variables globales
        let currentMode = 'normal';
        let currentSection = 'dashboard';
        
        // Gestion des sections
        function showSection(sectionId) {
            // Masquer toutes les sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Afficher la section demand√©e
            document.getElementById(sectionId).classList.add('active');
            
            // Mettre √† jour la navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Trouver et activer le lien correspondant
            const activeLink = document.querySelector(`[onclick="showSection('${sectionId}')"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }
            
            currentSection = sectionId;
            showToast(`Section ${getSectionName(sectionId)} ouverte`, 'info');
        }
        
        function getSectionName(sectionId) {
            const names = {
                'dashboard': 'Tableau de Bord',
                'ia-chat': 'Interface IA',
                'documents': 'Documents',
                'parrainage': 'Parrainage',
                'abonnements': 'Abonnements',
                'progression': 'Progression',
                'historique': 'Historique',
                'gamification': 'Badges & Niveaux',
                'notifications': 'Notifications',
                'profil': 'Profil',
                'parametres': 'Param√®tres',
                'support': 'Support'
            };
            return names[sectionId] || sectionId;
        }
        
        // Toggle sidebar mobile
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobileOverlay');
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
        }
        
        function closeMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobileOverlay');
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
        }
        
        // Toggle IA
        function toggleIA() {
            showSection('ia-chat');
            showToast('Interface IA ouverte', 'success');
        }
        
        // Gestion des modes IA
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // Retirer active de tous les boutons
                    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                    
                    // Ajouter active au bouton cliqu√©
                    this.classList.add('active');
                    
                    // Mettre √† jour le mode
                    currentMode = this.dataset.mode;
                    
                    const modeNames = {
                        'normal': 'Normal (250 tokens)',
                        'step': '√âtape par √âtape (180 tokens)',
                        'direct': 'Solution Directe (400 tokens)',
                        'audio': 'Mode Audio (200 tokens)'
                    };
                    
                    showToast(`Mode ${modeNames[currentMode]} s√©lectionn√©`, 'info');
                });
            });
        });
        
        // Gestion de l'input chat
        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }
        
        function handleInputChange() {
            const input = document.getElementById('chatInput');
            const sendBtn = document.getElementById('sendBtn');
            sendBtn.disabled = input.value.trim().length === 0;
            
            // Auto-resize
            input.style.height = 'auto';
            input.style.height = input.scrollHeight + 'px';
        }
        
        // Envoi de message IA
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) {
                showToast('Veuillez saisir un message', 'warning');
                return;
            }
            
            // Ajouter le message utilisateur
            addMessage(message, 'user');
            input.value = '';
            document.getElementById('sendBtn').disabled = true;
            
            // Simuler r√©ponse IA (√† remplacer par vraie API)
            setTimeout(() => {
                const responses = [
                    "Excellente question ! Laisse-moi t'expliquer cela √©tape par √©tape...",
                    "Je vais analyser ton document et te donner une explication d√©taill√©e.",
                    "Voici la solution compl√®te avec les explications n√©cessaires...",
                    "Pour mieux comprendre ce concept, regardons d'abord les bases..."
                ];
                
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                addMessage(randomResponse, 'ai');
                
                showToast(`${getTokenCost()} tokens utilis√©s`, 'success');
                updateTokenCount(-getTokenCost());
            }, 1000);
        }
        
        // Ajouter un message au chat
        function addMessage(text, sender) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender === 'user' ? 'user-message' : 'ai-message'}`;
            
            const avatar = sender === 'user' ? 'üë§' : 'ü§ñ';
            const time = new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
            
            messageDiv.innerHTML = `
                <div class="message-avatar">${avatar}</div>
                <div class="message-content">
                    <div class="message-text">${text}</div>
                    <div class="message-time">${time}</div>
                </div>
            `;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // Calculer le co√ªt en tokens selon le mode
        function getTokenCost() {
            const costs = {
                'normal': 250,
                'step': 180,
                'direct': 400,
                'audio': 200
            };
            return costs[currentMode];
        }
        
        // Mettre √† jour le compteur de tokens
        function updateTokenCount(change) {
            const tokenDisplay = document.querySelector('.user-plan');
            const currentTokens = parseInt(tokenDisplay.textContent.match(/\d+/)[0]);
            const newTokens = Math.max(0, currentTokens + change);
            tokenDisplay.textContent = `Premium ‚Ä¢ ${newTokens} tokens`;
            
            // Mettre √† jour aussi la stat card
            const statValue = document.querySelector('.stat-value');
            if (statValue) {
                statValue.textContent = newTokens;
            }
        }
        
        // Gestion upload de fichiers
        function handleFileUpload(input) {
            const file = input.files[0];
            if (!file) return;
            
            if (file.size > 10 * 1024 * 1024) {
                showToast('Fichier trop volumineux (max 10MB)', 'error');
                return;
            }
            
            showToast(`Document "${file.name}" upload√© avec succ√®s`, 'success');
            addMessage(`üìÑ Document upload√© : ${file.name}`, 'user');
            
            setTimeout(() => {
                addMessage(`J'ai analys√© votre document "${file.name}". Voici un r√©sum√© des points cl√©s...`, 'ai');
                showToast('120 tokens utilis√©s pour l\'analyse', 'info');
                updateTokenCount(-120);
            }, 2000);
        }
        
        function handleDocumentsUpload(input) {
            const files = Array.from(input.files);
            if (files.length === 0) return;
            
            files.forEach(file => {
                if (file.size <= 10 * 1024 * 1024) {
                    showToast(`Document "${file.name}" ajout√©`, 'success');
                }
            });
        }
        
        // Fonctions documents
        function relaunchIA(subject) {
            showSection('ia-chat');
            setTimeout(() => {
                addMessage(`Relancer l'analyse du document ${subject}`, 'user');
                setTimeout(() => {
                    addMessage(`Document ${subject} r√©analys√© avec les derni√®res am√©liorations IA !`, 'ai');
                    showToast('180 tokens utilis√©s', 'info');
                    updateTokenCount(-180);
                }, 1000);
            }, 500);
        }
        
        // Fonctions parrainage
        function copyReferralLink() {
            const link = 'https://etudia.ci/invite/JB-DOSSO-2024';
            navigator.clipboard.writeText(link).then(() => {
                showToast('Lien de parrainage copi√© !', 'success');
            });
        }
        
        function shareWhatsApp() {
            const message = "Rejoins-moi sur √âtudIA, la meilleure IA √©ducative de C√¥te d'Ivoire ! Utilise mon lien : https://etudia.ci/invite/JB-DOSSO-2024";
            const url = `https://wa.me/?text=${encodeURIComponent(message)}`;
            window.open(url, '_blank');
            showToast('Partage WhatsApp ouvert', 'info');
        }
        
        function shareFacebook() {
            const url = 'https://etudia.ci/invite/JB-DOSSO-2024';
            const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
            window.open(facebookUrl, '_blank');
            showToast('Partage Facebook ouvert', 'info');
        }
        
        function requestWithdrawal() {
            showToast('Demande de retrait en cours...', 'info');
            setTimeout(() => {
                showToast('Demande envoy√©e ! Traitement sous 48h', 'success');
            }, 1500);
        }
        
        // Fonctions abonnements
        function upgradeToExcellence() {
            showToast('Redirection vers paiement Excellence...', 'info');
            setTimeout(() => {
                showToast('Upgrade r√©ussi ! Bienvenue en Excellence', 'success');
            }, 2000);
        }
        
        function buyDailyPlan() {
            showToast('Achat plan journalier en cours...', 'info');
            setTimeout(() => {
                showToast('Plan journalier activ√© ! +15 interactions', 'success');
            }, 1500);
        }
        
        function buyTokenPack() {
            showToast('Achat pack tokens en cours...', 'info');
            setTimeout(() => {
                showToast('Pack achet√© ! +500 tokens ajout√©s', 'success');
                updateTokenCount(500);
            }, 1500);
        }
        
        // Syst√®me de notifications toast
        function showToast(message, type = 'info') {
            const toastContainer = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            
            toastContainer.appendChild(toast);
            
            // Animation d'entr√©e
            setTimeout(() => {
                toast.classList.add('show');
            }, 100);
            
            // Suppression automatique
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    if (toastContainer.contains(toast)) {
                        toastContainer.removeChild(toast);
                    }
                }, 300);
            }, 4000);
        }
        
        function showNotifications() {
            showToast('5 nouvelles notifications', 'info');
            setTimeout(() => {
                showToast('üéâ Nouveau badge d√©bloqu√© : Expert IA !', 'success');
            }, 1000);
            setTimeout(() => {
                showToast('üí∞ Nouveau gain parrainage : +1,300 F', 'success');
            }, 2000);
            setTimeout(() => {
                showToast('üìö Rappel : Document en attente d\'analyse', 'warning');
            }, 3000);
            setTimeout(() => {
                showToast('üîî Tokens faibles : 847 restants', 'warning');
            }, 4000);
        }
        
        // Gestion responsive
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                closeMobileMenu();
            }
        });
        
        // Raccourcis clavier
        document.addEventListener('keydown', function(e) {
            // Ctrl+K pour focus sur input IA
            if (e.ctrlKey && e.key === 'k') {
                e.preventDefault();
                const input = document.getElementById('chatInput');
                if (input) {
                    input.focus();
                    showToast('Focus sur input IA', 'info');
                }
            }
            
            // Ctrl+D pour dashboard
            if (e.ctrlKey && e.key === 'd') {
                e.preventDefault();
                showSection('dashboard');
            }
            
            // Ctrl+Shift+C pour chat complet
            if (e.ctrlKey && e.shiftKey && e.key === 'C') {
                e.preventDefault();
                showSection('ia-chat');
            }
            
            // Escape pour fermer modals
            if (e.key === 'Escape') {
                closeMobileMenu();
            }
        });
        
        // Animation de d√©marrage
        window.addEventListener('load', function() {
            showToast('üéâ Bienvenue Jean-Baptiste ! Ton espace √âtudIA est pr√™t !', 'success');
            
            // Animation fade-in pour tous les √©l√©ments
            document.querySelectorAll('.stat-card, .action-card, .content-card').forEach((el, index) => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(10px)';
                
                setTimeout(() => {
                    el.style.transition = 'all 0.5s ease-out';
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                }, index * 50);
            });
        });
        
        // Simulation mise √† jour temps r√©el des stats
        setInterval(() => {
            if (Math.random() > 0.95) { // 5% de chance
                const gainTypes = [
                    { text: 'üí∞ Nouveau gain parrainage', value: '+750 F', type: 'success' },
                    { text: 'üèÜ Badge d√©bloqu√©', value: 'Expert Math√©matiques', type: 'success' },
                    { text: 'üìà Objectif atteint', value: 'Sessions quotidiennes', type: 'info' }
                ];
                
                const randomGain = gainTypes[Math.floor(Math.random() * gainTypes.length)];
                showToast(`${randomGain.text}: ${randomGain.value}`, randomGain.type);
            }
        }, 15000); // Toutes les 15 secondes
        
        // Auto-sauvegarde des donn√©es utilisateur (simulation)
        setInterval(() => {
            if (Math.random() > 0.9) { // 10% de chance
                showToast('üíæ Donn√©es sauvegard√©es automatiquement', 'info');
            }
        }, 30000); // Toutes les 30 secondes
        
        // Debug info pour d√©veloppement
        console.log('üöÄ √âtudIA V4.1 - Backoffice √âl√®ve PEAUFIN√â Initialis√©');
        console.log('‚úÖ Donn√©es production utilis√©es');
        console.log('‚úÖ √âl√©ments compacts appliqu√©s');
        console.log('‚úÖ Interface IA code complet int√©gr√©');
        console.log('‚úÖ Syst√®me parrainage V4.1 complet');
        console.log('‚úÖ Abonnements bas√©s sur plans.html');
        console.log('‚úÖ Bouton flottant IA ajout√©');
        console.log('üá®üáÆ Made with ‚ù§Ô∏è by @Pacousstar & MonAP');
    </script>
</body>
</html>
