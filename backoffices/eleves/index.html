<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backoffice √âl√®ves - √âtudIA V4.1 | PACOUSSTAR</title>
    <meta name="description" content="Tableau de bord personnel pour √©l√®ves - √âtudIA V4.1 avec IA DeepSeek R1">
    
    <!-- ===============================
         D√âBUT PARTIE 1/5 : HTML HEAD + CSS COMPLET
         =============================== -->
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iOCIgZmlsbD0iIzAwN0FGRiIvPgo8cGF0aCBkPSJNMTYgOEMxOS4zMTM3IDggMjIgMTAuNjg2MyAyMiAxNEMyMiAxNy4zMTM3IDE5LjMxMzcgMjAgMTYgMjBDMTIuNjg2MyAyMCAxMCAxNy4zMTM3IDEwIDE0QzEwIDEwLjY4NjMgMTIuNjg2MyA4IDE2IDhaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* ============================================
           CSS VARIABLES - THEME DARK/LIGHT
           ============================================ */
        :root {
            /* Primary Colors */
            --primary-50: #eff6ff;
            --primary-100: #dbeafe;
            --primary-200: #bfdbfe;
            --primary-300: #93c5fd;
            --primary-400: #60a5fa;
            --primary-500: #3b82f6;
            --primary-600: #2563eb;
            --primary-700: #1d4ed8;
            --primary-800: #1e40af;
            --primary-900: #1e3a8a;
            
            /* Success Colors */
            --success-50: #f0fdf4;
            --success-500: #22c55e;
            --success-600: #16a34a;
            
            /* Warning Colors */
            --warning-50: #fffbeb;
            --warning-500: #f59e0b;
            --warning-600: #d97706;
            
            /* Error Colors */
            --error-50: #fef2f2;
            --error-500: #ef4444;
            --error-600: #dc2626;
            
            /* Neutral Colors - Light Theme */
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-tertiary: #64748b;
            --border-color: #e2e8f0;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
            
            /* Sidebar */
            --sidebar-width: 280px;
            --sidebar-collapsed-width: 80px;
            
            /* Animation */
            --transition-fast: 0.15s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
        }
        
        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-tertiary: #94a3b8;
            --border-color: #475569;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.3);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.4);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.4);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.4);
        }
        
        /* ============================================
           RESET & BASE STYLES
           ============================================ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            font-size: 16px;
            scroll-behavior: smooth;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            transition: all var(--transition-normal);
        }
        
        /* ============================================
           LAYOUT STRUCTURE
           ============================================ */
        .app-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* ============================================
           SIDEBAR STYLES
           ============================================ */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(145deg, var(--primary-600), var(--primary-700));
            color: white;
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            overflow-y: auto;
            transition: all var(--transition-normal);
            z-index: 1000;
            box-shadow: var(--shadow-xl);
        }
        
        .sidebar.collapsed {
            width: var(--sidebar-collapsed-width);
        }
        
        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all var(--transition-normal);
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        
        .logo-text {
            font-size: 1.25rem;
            font-weight: 700;
            opacity: 1;
            transition: all var(--transition-normal);
        }
        
        .sidebar.collapsed .logo-text {
            opacity: 0;
            width: 0;
        }
        
        .toggle-btn {
            position: absolute;
            top: 50%;
            right: -15px;
            transform: translateY(-50%);
            width: 30px;
            height: 30px;
            background: var(--primary-500);
            border: 2px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all var(--transition-normal);
            z-index: 1001;
        }
        
        .toggle-btn:hover {
            background: var(--primary-400);
            transform: translateY(-50%) scale(1.1);
        }
        
        /* User Profile in Sidebar */
        .user-profile {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .user-avatar {
            width: 48px;
            height: 48px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            font-weight: 600;
            flex-shrink: 0;
        }
        
        .user-details {
            opacity: 1;
            transition: all var(--transition-normal);
        }
        
        .sidebar.collapsed .user-details {
            opacity: 0;
            width: 0;
        }
        
        .user-name {
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .user-role {
            font-size: 0.75rem;
            opacity: 0.8;
        }
        
        .user-stats {
            display: flex;
            gap: 16px;
            margin-top: 8px;
            opacity: 1;
            transition: all var(--transition-normal);
        }
        
        .sidebar.collapsed .user-stats {
            opacity: 0;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .stat-label {
            font-size: 0.625rem;
            opacity: 0.8;
        }
        
        /* Navigation */
        .nav-menu {
            padding: 1rem 0;
        }
        
        .nav-section {
            margin-bottom: 1.5rem;
        }
        
        .nav-section-title {
            padding: 0 1.5rem 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            opacity: 0.8;
            transition: all var(--transition-normal);
        }
        
        .sidebar.collapsed .nav-section-title {
            opacity: 0;
            height: 0;
            padding: 0;
            margin: 0;
        }
        
        .nav-item {
            position: relative;
            margin: 2px 8px;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            border-radius: 12px;
            transition: all var(--transition-normal);
            cursor: pointer;
            font-size: 0.875rem;
            position: relative;
        }
        
        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: translateX(4px);
        }
        
        .nav-link.active {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            box-shadow: var(--shadow-md);
        }
        
        .nav-link.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 24px;
            background: white;
            border-radius: 0 4px 4px 0;
        }
        
        .nav-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .nav-text {
            opacity: 1;
            transition: all var(--transition-normal);
        }
        
        .sidebar.collapsed .nav-text {
            opacity: 0;
            width: 0;
        }
        
        .nav-badge {
            background: #ef4444;
            color: white;
            font-size: 0.625rem;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: auto;
            opacity: 1;
            transition: all var(--transition-normal);
        }
        
        .sidebar.collapsed .nav-badge {
            opacity: 0;
        }
        
        /* ============================================
           MAIN CONTENT AREA
           ============================================ */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            background: var(--bg-secondary);
            min-height: 100vh;
            transition: all var(--transition-normal);
        }
        
        .sidebar.collapsed + .main-content {
            margin-left: var(--sidebar-collapsed-width);
        }
        
        /* Header */
        .header {
            background: var(--bg-primary);
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: between;
            align-items: center;
            gap: 2rem;
        }
        
        .header-title {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
        }
        
        .header-subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            margin: 4px 0 0 0;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-left: auto;
        }
        
        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 8px;
        }
        
        .quick-action {
            width: 44px;
            height: 44px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-fast);
            color: var(--text-secondary);
        }
        
        .quick-action:hover {
            background: var(--primary-50);
            border-color: var(--primary-200);
            color: var(--primary-600);
            transform: translateY(-1px);
        }
        
        /* Notification Badge */
        .notification-badge {
            position: relative;
        }
        
        .notification-badge::after {
            content: '';
            position: absolute;
            top: 8px;
            right: 8px;
            width: 8px;
            height: 8px;
            background: var(--error-500);
            border: 2px solid var(--bg-primary);
            border-radius: 50%;
        }
        
        /* ============================================
           CONTENT SECTIONS
           ============================================ */
        .content-section {
            display: none;
            padding: 2rem;
            animation: fadeIn 0.3s ease;
        }
        
        .content-section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ============================================
           DASHBOARD GRID
           ============================================ */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        /* Card Styles */
        .card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-normal);
        }
        
        .card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }
        
        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }
        
        .card-icon {
            width: 44px;
            height: 44px;
            background: var(--primary-50);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-600);
            font-size: 1.25rem;
        }
        
        /* Stats Cards */
        .stat-card {
            text-align: center;
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-600), var(--primary-400));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1;
        }
        
        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 4px;
        }
        
        .stat-change {
            font-size: 0.75rem;
            margin-top: 8px;
            padding: 4px 8px;
            border-radius: 12px;
            display: inline-block;
        }
        
        .stat-change.positive {
            background: var(--success-50);
            color: var(--success-600);
        }
        
        .stat-change.negative {
            background: var(--error-50);
            color: var(--error-600);
        }
        
        /* ============================================
           CHAT INTERFACE
           ============================================ */
        .chat-container {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: var(--shadow-md);
            height: 600px;
            display: flex;
            flex-direction: column;
        }
        
        .chat-header {
            background: linear-gradient(135deg, var(--primary-600), var(--primary-500));
            color: white;
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .chat-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin: 0;
        }
        
        .chat-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.875rem;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            background: #22c55e;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .chat-modes {
            padding: 1rem 1.5rem;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }
        
        .mode-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .mode-btn {
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            border-radius: 20px;
            background: var(--bg-primary);
            color: var(--text-secondary);
            font-size: 0.875rem;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .mode-btn:hover {
            border-color: var(--primary-300);
            color: var(--primary-600);
        }
        
        .mode-btn.active {
            background: var(--primary-500);
            border-color: var(--primary-500);
            color: white;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            background: var(--bg-secondary);
        }
        
        .message {
            margin-bottom: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        
        .message.user {
            flex-direction: row-reverse;
        }
        
        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            font-weight: 600;
            flex-shrink: 0;
        }
        
        .message.ai .message-avatar {
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            color: white;
        }
        
        .message.user .message-avatar {
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            color: white;
        }
        
        .message-content {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 12px 16px;
            max-width: 75%;
            box-shadow: var(--shadow-sm);
        }
        
        .message.user .message-content {
            background: var(--primary-500);
            border-color: var(--primary-500);
            color: white;
        }
        
        .message-text {
            font-size: 0.875rem;
            line-height: 1.5;
        }
        
        .message-time {
            font-size: 0.75rem;
            opacity: 0.6;
            margin-top: 4px;
        }
        
        .chat-input {
            padding: 1rem 1.5rem;
            background: var(--bg-primary);
            border-top: 1px solid var(--border-color);
        }
        
        .input-group {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }
        
        .chat-textarea {
            flex: 1;
            min-height: 44px;
            max-height: 120px;
            padding: 12px 16px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 0.875rem;
            font-family: inherit;
            resize: none;
            transition: all var(--transition-fast);
        }
        
        .chat-textarea:focus {
            outline: none;
            border-color: var(--primary-400);
            box-shadow: 0 0 0 3px var(--primary-100);
        }
        
        .send-btn {
            width: 44px;
            height: 44px;
            background: var(--primary-500);
            border: none;
            border-radius: 12px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
        }
        
        .send-btn:hover {
            background: var(--primary-600);
            transform: translateY(-1px);
        }
        
        .send-btn:disabled {
            background: var(--text-tertiary);
            cursor: not-allowed;
            transform: none;
        }
        
        /* ============================================
           BUTTONS & FORM ELEMENTS
           ============================================ */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-fast);
            text-decoration: none;
            white-space: nowrap;
        }
        
        .btn-primary {
            background: var(--primary-500);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-600);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }
        
        .btn-secondary {
            background: var(--bg-primary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }
        
        .btn-secondary:hover {
            background: var(--bg-tertiary);
            border-color: var(--primary-300);
        }
        
        .btn-sm {
            padding: 8px 16px;
            font-size: 0.75rem;
        }
        
        .btn-lg {
            padding: 16px 32px;
            font-size: 1rem;
        }
        
        /* ============================================
           PROGRESS & LOADING
           ============================================ */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-500), var(--primary-400));
            border-radius: 4px;
            transition: width var(--transition-normal);
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: 50%;
            border-top-color: var(--primary-500);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ============================================
           RESPONSIVE DESIGN
           ============================================ */
        @media (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                width: var(--sidebar-width);
                transform: translateX(-100%);
            }
            
            .sidebar.mobile-open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .header {
                padding: 1rem 1.5rem;
            }
            
            .header-title {
                font-size: 1.5rem;
            }
            
            .content-section {
                padding: 1rem;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .card {
                padding: 1rem;
            }
            
            .chat-container {
                height: 500px;
            }
            
            .mode-buttons {
                flex-wrap: wrap;
            }
            
            .message-content {
                max-width: 85%;
            }
        }
        
        @media (max-width: 480px) {
            .header-title {
                font-size: 1.25rem;
            }
            
            .header-subtitle {
                font-size: 0.875rem;
            }
            
            .quick-actions {
                gap: 4px;
            }
            
            .quick-action {
                width: 40px;
                height: 40px;
            }
            
            .stat-number {
                font-size: 2rem;
            }
            
            .chat-header {
                padding: 0.75rem 1rem;
            }
            
            .chat-modes {
                padding: 0.75rem 1rem;
            }
            
            .chat-input {
                padding: 0.75rem 1rem;
            }
        }
        
        /* ============================================
           MOBILE MENU OVERLAY
           ============================================ */
        .mobile-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
        
        @media (max-width: 768px) {
            .mobile-overlay.active {
                display: block;
            }
        }
        
        /* ============================================
           MOBILE MENU BUTTON
           ============================================ */
        .mobile-menu-btn {
            display: none;
            width: 44px;
            height: 44px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-secondary);
        }
        
        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: flex;
            }
        }
        
        /* ============================================
           TOAST NOTIFICATIONS
           ============================================ */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .toast {
            min-width: 320px;
            padding: 16px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            transform: translateX(100%);
            opacity: 0;
            transition: all var(--transition-normal);
        }
        
        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }
        
        .toast.success {
            border-left: 4px solid var(--success-500);
        }
        
        .toast.error {
            border-left: 4px solid var(--error-500);
        }
        
        .toast.warning {
            border-left: 4px solid var(--warning-500);
        }
        
        .toast-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .toast-title {
            font-size: 0.875rem;
            font-weight: 600;
            margin: 0;
        }
        
        .toast-close {
            background: none;
            border: none;
            color: var(--text-tertiary);
            cursor: pointer;
            padding: 0;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .toast-message {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin: 0;
        }
        
        /* ============================================
           UTILITY CLASSES
           ============================================ */
        .hidden {
            display: none !important;
        }
        
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        .text-center {
            text-align: center;
        }
        
        .text-left {
            text-align: left;
        }
        
        .text-right {
            text-align: right;
        }
        
        .mb-0 { margin-bottom: 0; }
        .mb-1 { margin-bottom: 0.25rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-5 { margin-bottom: 1.25rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        
        .mt-0 { margin-top: 0; }
        .mt-1 { margin-top: 0.25rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-3 { margin-top: 0.75rem; }
        .mt-4 { margin-top: 1rem; }
        .mt-5 { margin-top: 1.25rem; }
        .mt-6 { margin-top: 1.5rem; }
        
        .p-0 { padding: 0; }
        .p-1 { padding: 0.25rem; }
        .p-2 { padding: 0.5rem; }
        .p-3 { padding: 0.75rem; }
        .p-4 { padding: 1rem; }
        .p-5 { padding: 1.25rem; }
        .p-6 { padding: 1.5rem; }
        
        .rounded { border-radius: 0.375rem; }
        .rounded-lg { border-radius: 0.5rem; }
        .rounded-xl { border-radius: 0.75rem; }
        .rounded-2xl { border-radius: 1rem; }
        
        .shadow { box-shadow: var(--shadow-sm); }
        .shadow-md { box-shadow: var(--shadow-md); }
        .shadow-lg { box-shadow: var(--shadow-lg); }
        .shadow-xl { box-shadow: var(--shadow-xl); }
        
        /* ============================================
           CUSTOM SCROLLBARS
           ============================================ */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-tertiary);
        }
        
        /* ============================================
           PRINT STYLES
           ============================================ */
        @media print {
            .sidebar,
            .mobile-menu-btn,
            .quick-actions,
            .chat-container {
                display: none !important;
            }
            
            .main-content {
                margin-left: 0 !important;
            }
            
            .card {
                break-inside: avoid;
                border: 1px solid #ccc;
            }
        }
    </style>
    
    <!-- ===============================
         FIN PARTIE 1/5 : HTML HEAD + CSS COMPLET
         =============================== -->

    <!-- ===============================
         D√âBUT PARTIE 2/5 : STRUCTURE BODY + SIDEBAR
         =============================== -->
</head>
<body data-theme="light">
    <!-- Mobile Overlay -->
    <div class="mobile-overlay" id="mobileOverlay"></div>
    
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>
    
    <!-- App Container -->
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <!-- Sidebar Header -->
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="logo-text">√âtudIA V4.1</div>
                </div>
                <button class="toggle-btn" id="toggleSidebar" title="R√©duire/Agrandir">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>
            
            <!-- User Profile -->
            <div class="user-profile">
                <div class="user-info">
                    <div class="user-avatar">P</div>
                    <div class="user-details">
                        <div class="user-name">PACOUSSTAR</div>
                        <div class="user-role">√âl√®ve Premium</div>
                        <div class="user-stats">
                            <div class="stat-item">
                                <div class="stat-value">2,450</div>
                                <div class="stat-label">Tokens</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">Level 12</div>
                                <div class="stat-label">XP</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">89%</div>
                                <div class="stat-label">Progr√®s</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Navigation Menu -->
            <nav class="nav-menu">
                <!-- Section Principale -->
                <div class="nav-section">
                    <div class="nav-section-title">Principal</div>
                    <div class="nav-item">
                        <a href="#" class="nav-link active" onclick="showSection('dashboard')" data-section="dashboard">
                            <i class="fas fa-home nav-icon"></i>
                            <span class="nav-text">Dashboard</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('chat-ia')" data-section="chat-ia">
                            <i class="fas fa-robot nav-icon"></i>
                            <span class="nav-text">Chat IA DeepSeek</span>
                            <span class="nav-badge">Nouveau</span>
                        </a>
                    </div>
                </div>
                
                <!-- Section Acad√©mique -->
                <div class="nav-section">
                    <div class="nav-section-title">Acad√©mique</div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('cours')" data-section="cours">
                            <i class="fas fa-book nav-icon"></i>
                            <span class="nav-text">Mes Cours</span>
                            <span class="nav-badge">12</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('devoirs')" data-section="devoirs">
                            <i class="fas fa-clipboard-check nav-icon"></i>
                            <span class="nav-text">Devoirs</span>
                            <span class="nav-badge">3</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('notes')" data-section="notes">
                            <i class="fas fa-chart-line nav-icon"></i>
                            <span class="nav-text">Notes & R√©sultats</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('planning')" data-section="planning">
                            <i class="fas fa-calendar nav-icon"></i>
                            <span class="nav-text">Planning</span>
                        </a>
                    </div>
                </div>
                
                <!-- Section Outils -->
                <div class="nav-section">
                    <div class="nav-section-title">Outils √âtudIA</div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('bibliotheque')" data-section="bibliotheque">
                            <i class="fas fa-books nav-icon"></i>
                            <span class="nav-text">Biblioth√®que</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('documents')" data-section="documents">
                            <i class="fas fa-file-upload nav-icon"></i>
                            <span class="nav-text">Mes Documents</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('gamification')" data-section="gamification">
                            <i class="fas fa-trophy nav-icon"></i>
                            <span class="nav-text">Gamification</span>
                        </a>
                    </div>
                </div>
                
                <!-- Section Social -->
                <div class="nav-section">
                    <div class="nav-section-title">Social & Support</div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('parrainage')" data-section="parrainage">
                            <i class="fas fa-users nav-icon"></i>
                            <span class="nav-text">Parrainage</span>
                            <span class="nav-badge">üí∞</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('liaison-parents')" data-section="liaison-parents">
                            <i class="fas fa-user-friends nav-icon"></i>
                            <span class="nav-text">Liaison Parents</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('communaute')" data-section="communaute">
                            <i class="fas fa-comments nav-icon"></i>
                            <span class="nav-text">Communaut√©</span>
                        </a>
                    </div>
                </div>
                
                <!-- Section Navigation Inter-Sites -->
                <div class="nav-section">
                    <div class="nav-section-title">Navigation √âtudIA</div>
                    <div class="nav-item">
                        <a href="https://etudia.gsnexpertises.com" class="nav-link" target="_blank">
                            <i class="fas fa-home nav-icon"></i>
                            <span class="nav-text">üè† Site Principal</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="https://adminetudia.gsnexpertises.com" class="nav-link" target="_blank">
                            <i class="fas fa-rocket nav-icon"></i>
                            <span class="nav-text">üöÄ Interface IA</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="https://appetudia.gsnexpertises.com" class="nav-link" target="_blank">
                            <i class="fas fa-mobile-alt nav-icon"></i>
                            <span class="nav-text">üì± App Mobile</span>
                        </a>
                    </div>
                </div>
                
                <!-- Section Param√®tres -->
                <div class="nav-section">
                    <div class="nav-section-title">Compte</div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('profil')" data-section="profil">
                            <i class="fas fa-user nav-icon"></i>
                            <span class="nav-text">Mon Profil</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('abonnement')" data-section="abonnement">
                            <i class="fas fa-credit-card nav-icon"></i>
                            <span class="nav-text">Abonnement</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('parametres')" data-section="parametres">
                            <i class="fas fa-cog nav-icon"></i>
                            <span class="nav-text">Param√®tres</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('aide')" data-section="aide">
                            <i class="fas fa-question-circle nav-icon"></i>
                            <span class="nav-text">Aide & Support</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="/login.html" class="nav-link">
                            <i class="fas fa-sign-out-alt nav-icon"></i>
                            <span class="nav-text">D√©connexion</span>
                        </a>
                    </div>
                </div>
            </nav>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-content">
                    <!-- Mobile Menu Button -->
                    <button class="mobile-menu-btn" id="mobileMenuBtn">
                        <i class="fas fa-bars"></i>
                    </button>
                    
                    <!-- Header Info -->
                    <div class="header-info">
                        <h1 class="header-title">Dashboard Personnel üë®‚Äçüéì</h1>
                        <p class="header-subtitle">Bienvenue PACOUSSTAR ! Voici votre espace d'apprentissage personnalis√© avec √âtudIA V4.1</p>
                    </div>
                    
                    <!-- Header Actions -->
                    <div class="header-actions">
                        <!-- Quick Actions -->
                        <div class="quick-actions">
                            <button class="quick-action" onclick="showSection('chat-ia')" title="Chat IA Rapide">
                                <i class="fas fa-robot"></i>
                            </button>
                            <button class="quick-action" onclick="showSection('documents')" title="Upload Document">
                                <i class="fas fa-upload"></i>
                            </button>
                            <button class="quick-action notification-badge" onclick="showSection('notifications')" title="Notifications">
                                <i class="fas fa-bell"></i>
                            </button>
                            <button class="quick-action" onclick="toggleTheme()" title="Changer de th√®me">
                                <i class="fas fa-moon" id="themeIcon"></i>
                            </button>
                        </div>
                        
                        <!-- User Dropdown -->
                        <div class="user-dropdown" onclick="toggleUserDropdown()">
                            <div class="user-avatar">P</div>
                            <div class="dropdown-content" id="userDropdown">
                                <a href="#" onclick="showSection('profil')">
                                    <i class="fas fa-user"></i> Mon Profil
                                </a>
                                <a href="#" onclick="showSection('abonnement')">
                                    <i class="fas fa-credit-card"></i> Abonnement
                                </a>
                                <a href="#" onclick="showSection('parametres')">
                                    <i class="fas fa-cog"></i> Param√®tres
                                </a>
                                <hr>
                                <a href="/login.html">
                                    <i class="fas fa-sign-out-alt"></i> D√©connexion
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Progress Bar (XP) -->
                <div class="xp-progress">
                    <div class="progress-info">
                        <span class="xp-text">Level 12 - Expert √âtudiant</span>
                        <span class="xp-points">2,450 / 3,000 XP</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 82%"></div>
                    </div>
                </div>
            </header>
    
    <!-- ===============================
         FIN PARTIE 2/5 : STRUCTURE BODY + SIDEBAR
         =============================== -->

<!-- ===============================
                 D√âBUT PARTIE 3/5 : DASHBOARD + CHAT IA
                 =============================== -->
            
            <!-- Section Dashboard -->
            <div id="dashboard" class="content-section active">
                <!-- Dashboard Stats Grid -->
                <div class="dashboard-grid">
                    <!-- Stat Card - Tokens Disponibles -->
                    <div class="card stat-card">
                        <div class="card-header">
                            <h3 class="card-title">Tokens Disponibles</h3>
                            <div class="card-icon">
                                <i class="fas fa-coins"></i>
                            </div>
                        </div>
                        <div class="stat-number">2,450</div>
                        <div class="stat-label">Interactions IA restantes</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i> +180 aujourd'hui
                        </div>
                        <div class="mt-4">
                            <a href="#" class="btn btn-primary btn-sm" onclick="showSection('abonnement')">
                                <i class="fas fa-plus"></i> Recharger
                            </a>
                        </div>
                    </div>
                    
                    <!-- Stat Card - Sessions IA -->
                    <div class="card stat-card">
                        <div class="card-header">
                            <h3 class="card-title">Sessions IA Aujourd'hui</h3>
                            <div class="card-icon">
                                <i class="fas fa-robot"></i>
                            </div>
                        </div>
                        <div class="stat-number">47</div>
                        <div class="stat-label">Questions pos√©es</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i> +12 vs hier
                        </div>
                        <div class="mt-4">
                            <a href="#" class="btn btn-primary btn-sm" onclick="showSection('chat-ia')">
                                <i class="fas fa-robot"></i> Nouveau Chat
                            </a>
                        </div>
                    </div>
                    
                    <!-- Stat Card - Progression XP -->
                    <div class="card stat-card">
                        <div class="card-header">
                            <h3 class="card-title">Progression XP</h3>
                            <div class="card-icon">
                                <i class="fas fa-trophy"></i>
                            </div>
                        </div>
                        <div class="stat-number">Level 12</div>
                        <div class="stat-label">Expert √âtudiant</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i> 550 XP restants
                        </div>
                        <div class="progress-bar mt-3">
                            <div class="progress-fill" style="width: 82%"></div>
                        </div>
                    </div>
                    
                    <!-- Stat Card - Gains Parrainage -->
                    <div class="card stat-card">
                        <div class="card-header">
                            <h3 class="card-title">Gains Parrainage</h3>
                            <div class="card-icon">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                        </div>
                        <div class="stat-number">12,500</div>
                        <div class="stat-label">FCFA ce mois</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i> +2,100 FCFA
                        </div>
                        <div class="mt-4">
                            <a href="#" class="btn btn-primary btn-sm" onclick="showSection('parrainage')">
                                <i class="fas fa-users"></i> Parrainer
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Actions Dashboard -->
                <div class="dashboard-grid mt-6">
                    <!-- Quick Action - Chat IA -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">D√©marrer une Session IA</h3>
                            <div class="card-icon">
                                <i class="fas fa-robot"></i>
                            </div>
                        </div>
                        <p class="text-secondary mb-4">Posez vos questions √† DeepSeek R1 avec 4 modes d'apprentissage diff√©rents.</p>
                        <div class="mode-buttons">
                            <button class="mode-btn" onclick="startChatWithMode('normal')">
                                üí¨ Normal (250 tokens)
                            </button>
                            <button class="mode-btn" onclick="startChatWithMode('step_by_step')">
                                üìö √âtape par √âtape (180 tokens)
                            </button>
                            <button class="mode-btn" onclick="startChatWithMode('direct_solution')">
                                ‚ö° Solution Directe (400 tokens)
                            </button>
                            <button class="mode-btn" onclick="startChatWithMode('audio')">
                                üé§ Mode Audio (200 tokens)
                            </button>
                        </div>
                    </div>
                    
                    <!-- Quick Action - Upload Document -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Analyser un Document</h3>
                            <div class="card-icon">
                                <i class="fas fa-file-upload"></i>
                            </div>
                        </div>
                        <p class="text-secondary mb-4">Uploadez un PDF, image ou document pour analyse IA instantan√©e.</p>
                        <div class="upload-zone" onclick="document.getElementById('fileInput').click()">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Cliquez pour s√©lectionner ou glissez un fichier</p>
                            <input type="file" id="fileInput" multiple accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" style="display:none" onchange="handleFileUpload(event)">
                        </div>
                    </div>
                </div>
                
                <!-- Recent Activity -->
                <div class="card mt-6">
                    <div class="card-header">
                        <h3 class="card-title">Activit√© R√©cente</h3>
                        <a href="#" class="btn btn-secondary btn-sm">Voir tout</a>
                    </div>
                    <div class="activity-list">
                        <div class="activity-item">
                            <div class="activity-icon success">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="activity-content">
                                <p class="activity-title">Session IA - Math√©matiques</p>
                                <p class="activity-description">R√©solution d'√©quations du second degr√© avec DeepSeek R1</p>
                                <span class="activity-time">Il y a 2 heures</span>
                            </div>
                            <div class="activity-meta">
                                <span class="token-cost">-180 tokens</span>
                            </div>
                        </div>
                        
                        <div class="activity-item">
                            <div class="activity-icon primary">
                                <i class="fas fa-upload"></i>
                            </div>
                            <div class="activity-content">
                                <p class="activity-title">Document Analys√©</p>
                                <p class="activity-description">Cours_Physique_Chapitre_5.pdf trait√© avec succ√®s</p>
                                <span class="activity-time">Il y a 4 heures</span>
                            </div>
                            <div class="activity-meta">
                                <span class="token-cost">-120 tokens</span>
                            </div>
                        </div>
                        
                        <div class="activity-item">
                            <div class="activity-icon warning">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <div class="activity-content">
                                <p class="activity-title">Gain Parrainage</p>
                                <p class="activity-description">Commission de 1,300 FCFA re√ßue (Nouveau filleul)</p>
                                <span class="activity-time">Hier</span>
                            </div>
                            <div class="activity-meta">
                                <span class="gain-amount">+1,300 FCFA</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Section Chat IA -->
            <div id="chat-ia" class="content-section">
                <!-- Chat IA Interface Compl√®te -->
                <div class="chat-container">
                    <!-- Chat Header -->
                    <div class="chat-header">
                        <div class="chat-title-section">
                            <h3 class="chat-title">
                                <i class="fas fa-robot"></i>
                                DeepSeek R1 - Assistant IA
                            </h3>
                            <div class="chat-status">
                                <span class="status-dot"></span>
                                Connect√© ‚Ä¢ Tokens: <span id="tokenCount">2,450</span>
                            </div>
                        </div>
                        <div class="chat-actions">
                            <button class="btn btn-sm" onclick="newChatSession()" title="Nouvelle session">
                                <i class="fas fa-plus"></i>
                            </button>
                            <button class="btn btn-sm" onclick="clearChat()" title="Effacer chat">
                                <i class="fas fa-trash"></i>
                            </button>
                            <button class="btn btn-sm" onclick="exportChat()" title="Exporter chat">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Chat Sessions Tabs -->
                    <div class="chat-sessions">
                        <div class="session-tabs" id="sessionTabs">
                            <div class="session-tab active" data-session="1" onclick="switchSession(1)">
                                <span class="tab-title">Math√©matiques</span>
                                <button class="tab-close" onclick="closeSession(1)">√ó</button>
                            </div>
                            <div class="session-tab" data-session="2" onclick="switchSession(2)">
                                <span class="tab-title">Physique</span>
                                <button class="tab-close" onclick="closeSession(2)">√ó</button>
                            </div>
                            <button class="add-session-btn" onclick="newChatSession()">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Chat Modes -->
                    <div class="chat-modes">
                        <div class="mode-buttons">
                            <button class="mode-btn active" data-mode="normal" onclick="setMode('normal')">
                                üí¨ Normal <small>(250 tokens)</small>
                            </button>
                            <button class="mode-btn" data-mode="step_by_step" onclick="setMode('step_by_step')">
                                üìö √âtape par √âtape <small>(180 tokens)</small>
                            </button>
                            <button class="mode-btn" data-mode="direct_solution" onclick="setMode('direct_solution')">
                                ‚ö° Solution Directe <small>(400 tokens)</small>
                            </button>
                            <button class="mode-btn" data-mode="audio" onclick="setMode('audio')">
                                üé§ Mode Audio <small>(200 tokens)</small>
                            </button>
                        </div>
                        <div class="mode-description">
                            <p id="modeDescription">Mode Normal : Conversation √©quilibr√©e avec explications d√©taill√©es et exemples.</p>
                        </div>
                    </div>
                    
                    <!-- Documents Context -->
                    <div class="documents-context" id="documentsContext" style="display: none;">
                        <div class="context-header">
                            <h4>Documents en contexte :</h4>
                            <button onclick="toggleDocumentsContext()" class="btn btn-sm">
                                <i class="fas fa-eye-slash"></i>
                            </button>
                        </div>
                        <div class="context-documents" id="contextDocuments">
                            <!-- Documents will be populated here -->
                        </div>
                    </div>
                    
                    <!-- Chat Messages -->
                    <div class="chat-messages" id="chatMessages">
                        <!-- Welcome Message -->
                        <div class="message ai">
                            <div class="message-avatar">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="message-content">
                                <div class="message-text">
                                    Salut PACOUSSTAR ! üëã Je suis DeepSeek R1, votre assistant IA personnel pour l'apprentissage.
                                    <br><br>
                                    <strong>Comment puis-je vous aider aujourd'hui ?</strong>
                                    <br>
                                    ‚Ä¢ Expliquer des concepts difficiles
                                    ‚Ä¢ R√©soudre des exercices √©tape par √©tape
                                    ‚Ä¢ Analyser vos documents PDF
                                    ‚Ä¢ R√©pondre √† vos questions acad√©miques
                                    <br><br>
                                    <em>Choisissez un mode d'apprentissage ci-dessus et posez votre premi√®re question !</em>
                                </div>
                                <div class="message-time">Maintenant</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Chat Input -->
                    <div class="chat-input">
                        <div class="input-group">
                            <div class="input-tools">
                                <button class="tool-btn" onclick="toggleDocumentsContext()" title="Ajouter documents au contexte">
                                    <i class="fas fa-paperclip"></i>
                                </button>
                                <button class="tool-btn" onclick="startVoiceInput()" title="Saisie vocale">
                                    <i class="fas fa-microphone"></i>
                                </button>
                                <button class="tool-btn" onclick="insertTemplate()" title="Templates rapides">
                                    <i class="fas fa-magic"></i>
                                </button>
                            </div>
                            <textarea 
                                class="chat-textarea" 
                                id="chatInput" 
                                placeholder="Tapez votre question ici... (Ctrl+Entr√©e pour envoyer)"
                                rows="1"
                                onkeydown="handleKeyDown(event)"
                                oninput="autoResize(this)"
                            ></textarea>
                            <button class="send-btn" id="sendBtn" onclick="sendMessage()" disabled>
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                        <div class="input-footer">
                            <div class="input-stats">
                                <span class="char-count">0 / 2000 caract√®res</span>
                                <span class="estimated-tokens">~0 tokens estim√©s</span>
                            </div>
                            <div class="quick-prompts">
                                <button class="quick-prompt" onclick="insertQuickPrompt('Explique-moi')">Explique-moi</button>
                                <button class="quick-prompt" onclick="insertQuickPrompt('R√©sous cet exercice')">R√©sous cet exercice</button>
                                <button class="quick-prompt" onclick="insertQuickPrompt('Donne-moi un exemple')">Donne-moi un exemple</button>
                                <button class="quick-prompt" onclick="insertQuickPrompt('Corrige mes erreurs')">Corrige mes erreurs</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Section Documents Upload -->
            <div id="documents" class="content-section">
                <div class="section-header">
                    <h2>üìÅ Gestion des Documents</h2>
                    <p>Uploadez et g√©rez vos documents pour l'analyse IA</p>
                </div>
                
                <!-- Upload Zone -->
                <div class="card">
                    <div class="upload-zone-large" id="uploadZone">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <h3>Glissez vos fichiers ici ou cliquez pour s√©lectionner</h3>
                        <p>Formats support√©s: PDF, JPG, PNG, DOC, DOCX (Max: 10MB par fichier)</p>
                        <input type="file" id="documentInput" multiple accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" style="display:none" onchange="handleDocumentUpload(event)">
                        <button class="btn btn-primary" onclick="document.getElementById('documentInput').click()">
                            <i class="fas fa-plus"></i> S√©lectionner des fichiers
                        </button>
                    </div>
                </div>
                
                <!-- Documents List -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h3 class="card-title">Mes Documents</h3>
                        <div class="document-actions">
                            <button class="btn btn-sm btn-secondary" onclick="selectAllDocuments()">
                                <i class="fas fa-check-square"></i> Tout s√©lectionner
                            </button>
                            <button class="btn btn-sm btn-primary" onclick="analyzeSelectedDocuments()">
                                <i class="fas fa-robot"></i> Analyser s√©lectionn√©s
                            </button>
                        </div>
                    </div>
                    <div class="documents-grid" id="documentsGrid">
                        <!-- Documents will be populated here -->
                        <div class="document-card">
                            <div class="document-icon">
                                <i class="fas fa-file-pdf"></i>
                            </div>
                            <div class="document-info">
                                <h4>Cours_Math√©matiques_Ch5.pdf</h4>
                                <p>Ajout√© il y a 2 heures ‚Ä¢ 2.3 MB</p>
                                <div class="document-status">
                                    <span class="status-badge success">Analys√©</span>
                                </div>
                            </div>
                            <div class="document-actions">
                                <button class="action-btn" onclick="previewDocument('doc1')" title="Aper√ßu">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="action-btn" onclick="analyzeDocument('doc1')" title="Analyser">
                                    <i class="fas fa-robot"></i>
                                </button>
                                <button class="action-btn" onclick="downloadDocument('doc1')" title="T√©l√©charger">
                                    <i class="fas fa-download"></i>
                                </button>
                                <button class="action-btn danger" onclick="deleteDocument('doc1')" title="Supprimer">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ===============================
                 FIN PARTIE 3/5 : DASHBOARD + CHAT IA
                 =============================== -->


<!-- ===============================
                 D√âBUT PARTIE 4/5 : SECTIONS D√âTAILL√âES
                 =============================== -->
            
            <!-- Section Cours -->
            <div id="cours" class="content-section">
                <div class="section-header">
                    <h2>üìö Mes Cours</h2>
                    <p>G√©rez vos mati√®res et progressez avec l'IA</p>
                </div>
                
                <div class="dashboard-grid">
                    <!-- Math√©matiques -->
                    <div class="card course-card">
                        <div class="course-header">
                            <div class="course-icon math">
                                <i class="fas fa-calculator"></i>
                            </div>
                            <div class="course-info">
                                <h3>Math√©matiques</h3>
                                <p>Alg√®bre & G√©om√©trie ‚Ä¢ Terminale C</p>
                            </div>
                            <div class="course-progress">85%</div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 85%"></div>
                        </div>
                        <div class="course-stats">
                            <div class="stat">
                                <span class="stat-label">Chapitres</span>
                                <span class="stat-value">17/20</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Sessions IA</span>
                                <span class="stat-value">127</span>
                            </div>
                        </div>
                        <div class="course-actions">
                            <button class="btn btn-primary btn-sm" onclick="startCourseChat('math')">
                                <i class="fas fa-robot"></i> Chat IA
                            </button>
                            <button class="btn btn-secondary btn-sm" onclick="viewCourseDetails('math')">
                                <i class="fas fa-eye"></i> D√©tails
                            </button>
                        </div>
                    </div>
                    
                    <!-- Physique-Chimie -->
                    <div class="card course-card">
                        <div class="course-header">
                            <div class="course-icon physics">
                                <i class="fas fa-atom"></i>
                            </div>
                            <div class="course-info">
                                <h3>Physique-Chimie</h3>
                                <p>M√©canique & Chimie ‚Ä¢ Terminale C</p>
                            </div>
                            <div class="course-progress">72%</div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 72%"></div>
                        </div>
                        <div class="course-stats">
                            <div class="stat">
                                <span class="stat-label">Chapitres</span>
                                <span class="stat-value">13/18</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Sessions IA</span>
                                <span class="stat-value">89</span>
                            </div>
                        </div>
                        <div class="course-actions">
                            <button class="btn btn-primary btn-sm" onclick="startCourseChat('physics')">
                                <i class="fas fa-robot"></i> Chat IA
                            </button>
                            <button class="btn btn-secondary btn-sm" onclick="viewCourseDetails('physics')">
                                <i class="fas fa-eye"></i> D√©tails
                            </button>
                        </div>
                    </div>
                    
                    <!-- Sciences Naturelles -->
                    <div class="card course-card">
                        <div class="course-header">
                            <div class="course-icon biology">
                                <i class="fas fa-microscope"></i>
                            </div>
                            <div class="course-info">
                                <h3>Sciences Naturelles</h3>
                                <p>Biologie & G√©ologie ‚Ä¢ Terminale D</p>
                            </div>
                            <div class="course-progress">91%</div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 91%"></div>
                        </div>
                        <div class="course-stats">
                            <div class="stat">
                                <span class="stat-label">Chapitres</span>
                                <span class="stat-value">19/21</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Sessions IA</span>
                                <span class="stat-value">156</span>
                            </div>
                        </div>
                        <div class="course-actions">
                            <button class="btn btn-primary btn-sm" onclick="startCourseChat('biology')">
                                <i class="fas fa-robot"></i> Chat IA
                            </button>
                            <button class="btn btn-secondary btn-sm" onclick="viewCourseDetails('biology')">
                                <i class="fas fa-eye"></i> D√©tails
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Section Devoirs -->
            <div id="devoirs" class="content-section">
                <div class="section-header">
                    <h2>üìù Mes Devoirs</h2>
                    <p>Suivez vos devoirs et obtenez de l'aide IA</p>
                </div>
                
                <div class="assignments-container">
                    <!-- Devoir En Cours -->
                    <div class="card assignment-card urgent">
                        <div class="assignment-header">
                            <div class="assignment-subject math">Math√©matiques</div>
                            <div class="assignment-due">
                                <i class="fas fa-clock"></i> Due demain
                            </div>
                        </div>
                        <h3>Devoir Surveill√© - Fonctions Logarithmiques</h3>
                        <p>√âtude compl√®te des fonctions ln(x) avec d√©riv√©es et primitives</p>
                        <div class="assignment-progress">
                            <span>Progression: 65%</span>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 65%"></div>
                            </div>
                        </div>
                        <div class="assignment-actions">
                            <button class="btn btn-primary" onclick="continueAssignment('math-log')">
                                <i class="fas fa-robot"></i> Aide IA
                            </button>
                            <button class="btn btn-secondary" onclick="viewAssignment('math-log')">
                                <i class="fas fa-eye"></i> Voir d√©tails
                            </button>
                        </div>
                    </div>
                    
                    <!-- Devoir Cette Semaine -->
                    <div class="card assignment-card">
                        <div class="assignment-header">
                            <div class="assignment-subject physics">Physique-Chimie</div>
                            <div class="assignment-due">
                                <i class="fas fa-calendar"></i> Vendredi
                            </div>
                        </div>
                        <h3>TP - √âlectrolyse et R√©actions Redox</h3>
                        <p>Analyse exp√©rimentale des r√©actions d'oxydor√©duction</p>
                        <div class="assignment-progress">
                            <span>Progression: 20%</span>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 20%"></div>
                            </div>
                        </div>
                        <div class="assignment-actions">
                            <button class="btn btn-primary" onclick="continueAssignment('physics-redox')">
                                <i class="fas fa-robot"></i> Aide IA
                            </button>
                            <button class="btn btn-secondary" onclick="viewAssignment('physics-redox')">
                                <i class="fas fa-eye"></i> Voir d√©tails
                            </button>
                        </div>
                    </div>
                    
                    <!-- Devoir Termin√© -->
                    <div class="card assignment-card completed">
                        <div class="assignment-header">
                            <div class="assignment-subject biology">Sciences Naturelles</div>
                            <div class="assignment-status completed">
                                <i class="fas fa-check"></i> Termin√©
                            </div>
                        </div>
                        <h3>Expos√© - Syst√®me Nerveux Central</h3>
                        <p>Pr√©sentation sur l'anatomie et fonctionnement du SNC</p>
                        <div class="assignment-grade">
                            <span class="grade excellent">18/20</span>
                            <span class="grade-label">Excellent travail !</span>
                        </div>
                        <div class="assignment-actions">
                            <button class="btn btn-secondary" onclick="viewFeedback('biology-snc')">
                                <i class="fas fa-comment"></i> Feedback
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Section Parrainage -->
            <div id="parrainage" class="content-section">
                <div class="section-header">
                    <h2>üë• Syst√®me de Parrainage</h2>
                    <p>Invitez vos amis et gagnez des commissions sur 3 niveaux</p>
                </div>
                
                <!-- Stats Parrainage -->
                <div class="dashboard-grid">
                    <div class="card stat-card">
                        <div class="card-header">
                            <h3 class="card-title">Gains Total</h3>
                            <div class="card-icon">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                        </div>
                        <div class="stat-number">47,850</div>
                        <div class="stat-label">FCFA gagn√©s</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i> +12,500 ce mois
                        </div>
                    </div>
                    
                    <div class="card stat-card">
                        <div class="card-header">
                            <h3 class="card-title">Filleuls Directs</h3>
                            <div class="card-icon">
                                <i class="fas fa-user-plus"></i>
                            </div>
                        </div>
                        <div class="stat-number">23</div>
                        <div class="stat-label">Niveau 1</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i> +3 cette semaine
                        </div>
                    </div>
                    
                    <div class="card stat-card">
                        <div class="card-header">
                            <h3 class="card-title">R√©seau Complet</h3>
                            <div class="card-icon">
                                <i class="fas fa-sitemap"></i>
                            </div>
                        </div>
                        <div class="stat-number">127</div>
                        <div class="stat-label">Tous niveaux</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i> R√©seau actif
                        </div>
                    </div>
                </div>
                
                <!-- Lien de Parrainage -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Votre Lien de Parrainage</h3>
                        <button class="btn btn-primary btn-sm" onclick="generateNewLink()">
                            <i class="fas fa-sync"></i> Nouveau lien
                        </button>
                    </div>
                    <div class="referral-link-container">
                        <div class="referral-link">
                            <input type="text" id="referralLink" value="https://etudia.gsnexpertises.com/register?ref=PACOUSSTAR2024" readonly>
                            <button class="copy-btn" onclick="copyReferralLink()">
                                <i class="fas fa-copy"></i> Copier
                            </button>
                        </div>
                        <div class="share-buttons">
                            <button class="share-btn whatsapp" onclick="shareToWhatsApp()">
                                <i class="fab fa-whatsapp"></i> WhatsApp
                            </button>
                            <button class="share-btn facebook" onclick="shareToFacebook()">
                                <i class="fab fa-facebook"></i> Facebook
                            </button>
                            <button class="share-btn telegram" onclick="shareToTelegram()">
                                <i class="fab fa-telegram"></i> Telegram
                            </button>
                            <button class="share-btn instagram" onclick="shareToInstagram()">
                                <i class="fab fa-instagram"></i> Instagram
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Commission Calculator -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Calculateur de Commissions</h3>
                    </div>
                    <div class="commission-calculator">
                        <div class="calculator-input">
                            <label>Nombre de filleuls par mois :</label>
                            <input type="number" id="filleulsCount" value="5" min="1" max="100" onchange="calculateCommissions()">
                        </div>
                        <div class="calculator-results">
                            <div class="commission-breakdown">
                                <div class="level-commission">
                                    <span class="level">Niveau 1 (40%)</span>
                                    <span class="amount" id="level1Amount">13,000 FCFA/mois</span>
                                </div>
                                <div class="level-commission">
                                    <span class="level">Niveau 2 (20%)</span>
                                    <span class="amount" id="level2Amount">6,500 FCFA/mois</span>
                                </div>
                                <div class="level-commission">
                                    <span class="level">Niveau 3 (10%)</span>
                                    <span class="amount" id="level3Amount">3,250 FCFA/mois</span>
                                </div>
                                <div class="total-commission">
                                    <span class="level">Total Estim√©</span>
                                    <span class="amount total" id="totalAmount">22,750 FCFA/mois</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Demande de Retrait -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Demande de Retrait</h3>
                    </div>
                    <div class="withdrawal-form">
                        <div class="balance-info">
                            <div class="available-balance">
                                <span class="balance-label">Solde disponible :</span>
                                <span class="balance-amount">47,850 FCFA</span>
                            </div>
                            <div class="minimum-withdrawal">
                                <small>Retrait minimum : 5,000 FCFA</small>
                            </div>
                        </div>
                        <div class="withdrawal-inputs">
                            <div class="input-group">
                                <label>Montant √† retirer :</label>
                                <input type="number" id="withdrawalAmount" min="5000" max="47850" placeholder="Ex: 20000">
                                <span class="input-suffix">FCFA</span>
                            </div>
                            <div class="input-group">
                                <label>Num√©ro Mobile Money :</label>
                                <input type="tel" id="mobileNumber" placeholder="Ex: +225 07 XX XX XX XX">
                            </div>
                            <div class="fees-info">
                                <small>Frais de retrait : 2% (min 100 FCFA, max 1000 FCFA)</small>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="requestWithdrawal()">
                            <i class="fas fa-money-bill-wave"></i> Demander le retrait
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Section Profil -->
            <div id="profil" class="content-section">
                <div class="section-header">
                    <h2>üë§ Mon Profil</h2>
                    <p>G√©rez vos informations personnelles</p>
                </div>
                
                <div class="profile-container">
                    <!-- Profile Card -->
                    <div class="card profile-card">
                        <div class="profile-header">
                            <div class="profile-avatar-large">
                                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiByeD0iNTAiIGZpbGw9InVybCgjZ3JhZGllbnQwKSIvPgo8dGV4dCB4PSI1MCIgeT0iNjAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSI0MCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5QPC90ZXh0Pgo8ZGVmcz4KPGxpbmVhckdyYWRpZW50IGlkPSJncmFkaWVudDAiIHgxPSIwIiB5MT0iMCIgeDI9IjEwMCIgeTI9IjEwMCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgo8c3RvcCBzdG9wLWNvbG9yPSIjRkY2QjZCIi8+CjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzRFQ0RDNCIvPgo8L2xpbmVhckdyYWRpZW50Pgo8L2RlZnM+Cjwvc3ZnPgo=" alt="PACOUSSTAR">
                                <button class="edit-avatar" onclick="editAvatar()">
                                    <i class="fas fa-camera"></i>
                                </button>
                            </div>
                            <div class="profile-info">
                                <h2>PACOUSSTAR</h2>
                                <p>√âl√®ve Premium ‚Ä¢ Level 12</p>
                                <div class="profile-badges">
                                    <span class="badge premium">Premium</span>
                                    <span class="badge expert">Expert</span>
                                    <span class="badge early-adopter">Early Adopter</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="profile-stats">
                            <div class="stat-item">
                                <div class="stat-icon">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value">1,247</span>
                                    <span class="stat-label">Sessions IA</span>
                                </div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-icon">
                                    <i class="fas fa-trophy"></i>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value">12,450</span>
                                    <span class="stat-label">XP Total</span>
                                </div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value">23</span>
                                    <span class="stat-label">Filleuls</span>
                                </div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-icon">
                                    <i class="fas fa-calendar"></i>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value">127</span>
                                    <span class="stat-label">Jours actifs</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Profile Form -->
                    <div class="card profile-form">
                        <div class="card-header">
                            <h3 class="card-title">Informations Personnelles</h3>
                            <button class="btn btn-primary btn-sm" onclick="editProfile()">
                                <i class="fas fa-edit"></i> Modifier
                            </button>
                        </div>
                        
                        <form id="profileForm">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Nom d'utilisateur</label>
                                    <input type="text" id="username" value="PACOUSSTAR" readonly>
                                </div>
                                <div class="form-group">
                                    <label>Email</label>
                                    <input type="email" id="email" value="pacousstar@etudia.ci" readonly>
                                </div>
                                <div class="form-group">
                                    <label>T√©l√©phone</label>
                                    <input type="tel" id="phone" value="+225 07 XX XX XX XX" readonly>
                                </div>
                                <div class="form-group">
                                    <label>Date de naissance</label>
                                    <input type="date" id="birthdate" value="2005-03-15" readonly>
                                </div>
                                <div class="form-group">
                                    <label>√âtablissement</label>
                                    <input type="text" id="school" value="Lyc√©e Moderne d'Abidjan" readonly>
                                </div>
                                <div class="form-group">
                                    <label>Classe</label>
                                    <input type="text" id="class" value="Terminale C" readonly>
                                </div>
                                <div class="form-group">
                                    <label>Ville</label>
                                    <input type="text" id="city" value="Abidjan" readonly>
                                </div>
                                <div class="form-group">
                                    <label>Pays</label>
                                    <input type="text" id="country" value="C√¥te d'Ivoire" readonly>
                                </div>
                            </div>
                            
                            <div class="form-actions" id="formActions" style="display: none;">
                                <button type="button" class="btn btn-secondary" onclick="cancelEdit()">
                                    <i class="fas fa-times"></i> Annuler
                                </button>
                                <button type="submit" class="btn btn-primary" onclick="saveProfile()">
                                    <i class="fas fa-save"></i> Sauvegarder
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Section Abonnement -->
            <div id="abonnement" class="content-section">
                <div class="section-header">
                    <h2>üí≥ Mon Abonnement</h2>
                    <p>G√©rez votre plan d'abonnement √âtudIA</p>
                </div>
                
                <!-- Plan Actuel -->
                <div class="card current-plan">
                    <div class="plan-header">
                        <div class="plan-info">
                            <h3>Plan Premium</h3>
                            <p>1,500 interactions/mois ‚Ä¢ Support prioritaire</p>
                        </div>
                        <div class="plan-price">
                            <span class="price">6,500</span>
                            <span class="currency">FCFA/mois</span>
                        </div>
                    </div>
                    
                    <div class="plan-usage">
                        <div class="usage-stat">
                            <span class="usage-label">Interactions utilis√©es ce mois</span>
                            <span class="usage-value">847 / 1,500</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 56%"></div>
                        </div>
                    </div>
                    
                    <div class="plan-features">
                        <div class="feature active">
                            <i class="fas fa-check"></i> 1,500 interactions IA/mois
                        </div>
                        <div class="feature active">
                            <i class="fas fa-check"></i> 4 modes d'apprentissage
                        </div>
                        <div class="feature active">
                            <i class="fas fa-check"></i> Upload documents illimit√©
                        </div>
                        <div class="feature active">
                            <i class="fas fa-check"></i> Syst√®me de parrainage
                        </div>
                        <div class="feature active">
                            <i class="fas fa-check"></i> Support prioritaire
                        </div>
                    </div>
                    
                    <div class="plan-actions">
                        <button class="btn btn-primary" onclick="showUpgradeOptions()">
                            <i class="fas fa-arrow-up"></i> Upgrader vers Excellence
                        </button>
                        <button class="btn btn-secondary" onclick="manageBilling()">
                            <i class="fas fa-credit-card"></i> G√©rer facturation
                        </button>
                    </div>
                </div>
                
                <!-- Plans Disponibles -->
                <div class="plans-grid">
                    <!-- Plan Excellence -->
                    <div class="card plan-card recommended">
                        <div class="plan-badge">Recommand√©</div>
                        <div class="plan-header">
                            <h3>Excellence</h3>
                            <div class="plan-price">
                                <span class="price">10,000</span>
                                <span class="currency">FCFA/mois</span>
                            </div>
                        </div>
                        
                        <div class="plan-features">
                            <div class="feature">
                                <i class="fas fa-check"></i> 6,000 interactions IA/mois
                            </div>
                            <div class="feature">
                                <i class="fas fa-check"></i> Tous les modes d'apprentissage
                            </div>
                            <div class="feature">
                                <i class="fas fa-check"></i> Upload documents illimit√©
                            </div>
                            <div class="feature">
                                <i class="fas fa-check"></i> Analyse avanc√©e PDF
                            </div>
                            <div class="feature">
                                <i class="fas fa-check"></i> Syst√®me parrainage premium
                            </div>
                            <div class="feature">
                                <i class="fas fa-check"></i> Support 24/7
                            </div>
                            <div class="feature">
                                <i class="fas fa-check"></i> Acc√®s early features
                            </div>
                        </div>
                        
                        <button class="btn btn-primary" onclick="upgradeToPlan('excellence')">
                            <i class="fas fa-arrow-up"></i> Upgrader
                        </button>
                    </div>
                    
                    <!-- Plans Journaliers -->
                    <div class="card plan-card">
                        <div class="plan-header">
                            <h3>Plans Journaliers</h3>
                            <div class="plan-price">
                                <span class="price">500-750</span>
                                <span class="currency">FCFA/jour</span>
                            </div>
                        </div>
                        
                        <div class="plan-features">
                            <div class="feature">
                                <i class="fas fa-check"></i> Premium : 20 interactions/24h
                            </div>
                            <div class="feature">
                                <i class="fas fa-check"></i> Excellence : 50 interactions/24h
                            </div>
                            <div class="feature">
                                <i class="fas fa-check"></i> Id√©al pour usage ponctuel
                            </div>
                            <div class="feature">
                                <i class="fas fa-check"></i> Activation imm√©diate
                            </div>
                        </div>
                        
                        <button class="btn btn-secondary" onclick="showDailyPlans()">
                            <i class="fas fa-calendar-day"></i> Voir plans
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Section Param√®tres -->
            <div id="parametres" class="content-section">
                <div class="section-header">
                    <h2>‚öôÔ∏è Param√®tres</h2>
                    <p>Personnalisez votre exp√©rience √âtudIA</p>
                </div>
                
                <!-- Param√®tres G√©n√©raux -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Pr√©f√©rences G√©n√©rales</h3>
                    </div>
                    
                    <div class="settings-grid">
                        <!-- Th√®me -->
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Th√®me d'affichage</h4>
                                <p>Choisissez entre le mode clair et sombre</p>
                            </div>
                            <div class="setting-control">
                                <select id="themeSelect" onchange="changeTheme(this.value)">
                                    <option value="light">Clair</option>
                                    <option value="dark">Sombre</option>
                                    <option value="auto">Automatique</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Langue -->
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Langue</h4>
                                <p>Langue de l'interface utilisateur</p>
                            </div>
                            <div class="setting-control">
                                <select id="languageSelect" onchange="changeLanguage(this.value)">
                                    <option value="fr">Fran√ßais</option>
                                    <option value="en">English</option>
                                    <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Auto-save -->
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Sauvegarde automatique</h4>
                                <p>Sauvegarder automatiquement vos conversations</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle">
                                    <input type="checkbox" id="autoSave" checked onchange="toggleAutoSave()">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- Notifications -->
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Notifications push</h4>
                                <p>Recevoir des notifications dans le navigateur</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle">
                                    <input type="checkbox" id="pushNotifications" onchange="toggleNotifications()">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Param√®tres IA -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h3 class="card-title">Param√®tres IA DeepSeek R1</h3>
                    </div>
                    
                    <div class="settings-grid">
                        <!-- Mode par d√©faut -->
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Mode IA par d√©faut</h4>
                                <p>Mode d'apprentissage utilis√© par d√©faut</p>
                            </div>
                            <div class="setting-control">
                                <select id="defaultMode" onchange="setDefaultMode(this.value)">
                                    <option value="normal">üí¨ Normal</option>
                                    <option value="step_by_step">üìö √âtape par √âtape</option>
                                    <option value="direct_solution">‚ö° Solution Directe</option>
                                    <option value="audio">üé§ Mode Audio</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Longueur r√©ponses -->
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Longueur des r√©ponses</h4>
                                <p>Pr√©f√©rence pour la longueur des r√©ponses IA</p>
                            </div>
                            <div class="setting-control">
                                <select id="responseLength" onchange="setResponseLength(this.value)">
                                    <option value="concise">Concis</option>
                                    <option value="balanced" selected>√âquilibr√©</option>
                                    <option value="detailed">D√©taill√©</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Context documents -->
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Contexte documents automatique</h4>
                                <p>Inclure automatiquement vos documents r√©cents</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle">
                                    <input type="checkbox" id="autoContext" checked onchange="toggleAutoContext()">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- Voice input -->
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Saisie vocale</h4>
                                <p>Activer la reconnaissance vocale</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle">
                                    <input type="checkbox" id="voiceInput" onchange="toggleVoiceInput()">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- S√©curit√© et Confidentialit√© -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h3 class="card-title">S√©curit√© et Confidentialit√©</h3>
                    </div>
                    
                    <div class="settings-grid">
                        <!-- Historique conversations -->
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Historique des conversations</h4>
                                <p>Dur√©e de conservation de vos chats IA</p>
                            </div>
                            <div class="setting-control">
                                <select id="historyRetention" onchange="setHistoryRetention(this.value)">
                                    <option value="7">7 jours</option>
                                    <option value="30" selected>30 jours</option>
                                    <option value="90">90 jours</option>
                                    <option value="365">1 an</option>
                                    <option value="never">Jamais supprimer</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Donn√©es anonymes -->
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Am√©lioration du service</h4>
                                <p>Partager des donn√©es anonymes pour am√©liorer √âtudIA</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle">
                                    <input type="checkbox" id="anonymousData" checked onchange="toggleAnonymousData()">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- Authentification 2FA -->
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Authentification √† deux facteurs</h4>
                                <p>S√©curiser votre compte avec 2FA</p>
                            </div>
                            <div class="setting-control">
                                <button class="btn btn-primary btn-sm" onclick="setup2FA()">
                                    <i class="fas fa-shield-alt"></i> Configurer
                                </button>
                            </div>
                        </div>
                        
                        <!-- Export donn√©es -->
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Export des donn√©es</h4>
                                <p>T√©l√©charger une copie de vos donn√©es</p>
                            </div>
                            <div class="setting-control">
                                <button class="btn btn-secondary btn-sm" onclick="exportUserData()">
                                    <i class="fas fa-download"></i> Exporter
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Actions de Compte -->
                <div class="card mt-4 danger-zone">
                    <div class="card-header">
                        <h3 class="card-title">Zone de Danger</h3>
                    </div>
                    
                    <div class="danger-actions">
                        <div class="danger-item">
                            <div class="danger-info">
                                <h4>Supprimer l'historique</h4>
                                <p>Effacer d√©finitivement toutes vos conversations</p>
                            </div>
                            <button class="btn btn-danger btn-sm" onclick="clearAllHistory()">
                                <i class="fas fa-trash"></i> Effacer tout
                            </button>
                        </div>
                        
                        <div class="danger-item">
                            <div class="danger-info">
                                <h4>D√©sactiver le compte</h4>
                                <p>Suspendre temporairement votre compte</p>
                            </div>
                            <button class="btn btn-warning btn-sm" onclick="deactivateAccount()">
                                <i class="fas fa-pause"></i> D√©sactiver
                            </button>
                        </div>
                        
                        <div class="danger-item">
                            <div class="danger-info">
                                <h4>Supprimer le compte</h4>
                                <p>Supprimer d√©finitivement votre compte √âtudIA</p>
                            </div>
                            <button class="btn btn-danger btn-sm" onclick="deleteAccount()">
                                <i class="fas fa-trash-alt"></i> Supprimer
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Section Aide -->
            <div id="aide" class="content-section">
                <div class="section-header">
                    <h2>‚ùì Aide & Support</h2>
                    <p>Trouvez des r√©ponses et contactez notre √©quipe</p>
                </div>
                
                <!-- FAQ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Questions Fr√©quentes</h3>
                    </div>
                    
                    <div class="faq-list">
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(1)">
                                <h4>Comment fonctionne le syst√®me de parrainage ?</h4>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="faq-answer" id="faq1">
                                <p>Le syst√®me de parrainage √âtudIA vous permet de gagner des commissions sur 3 niveaux :</p>
                                <ul>
                                    <li><strong>Niveau 1 (40%)</strong> : Commission directe sur vos filleuls</li>
                                    <li><strong>Niveau 2 (20%)</strong> : Commission sur les filleuls de vos filleuls</li>
                                    <li><strong>Niveau 3 (10%)</strong> : Commission sur le 3√®me niveau</li>
                                </ul>
                                <p>Partagez votre lien unique et gagnez √† chaque nouvel abonnement !</p>
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(2)">
                                <h4>Quels sont les diff√©rents modes IA disponibles ?</h4>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="faq-answer" id="faq2">
                                <p>√âtudIA V4.1 propose 4 modes d'apprentissage avec DeepSeek R1 :</p>
                                <ul>
                                    <li><strong>üí¨ Mode Normal (250 tokens)</strong> : Conversation √©quilibr√©e avec explications</li>
                                    <li><strong>üìö √âtape par √âtape (180 tokens)</strong> : R√©solution progressive et p√©dagogique</li>
                                    <li><strong>‚ö° Solution Directe (400 tokens)</strong> : R√©ponse compl√®te et imm√©diate</li>
                                    <li><strong>üé§ Mode Audio (200 tokens)</strong> : R√©ponses optimis√©es pour la synth√®se vocale</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(3)">
                                <h4>Comment analyser mes documents PDF ?</h4>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="faq-answer" id="faq3">
                                <p>Pour analyser vos documents :</p>
                                <ol>
                                    <li>Allez dans la section "Mes Documents"</li>
                                    <li>Glissez-d√©posez votre PDF ou cliquez pour s√©lectionner</li>
                                    <li>Attendez le traitement OCR automatique</li>
                                    <li>Utilisez le Chat IA avec le contexte du document</li>
                                    <li>Posez vos questions sur le contenu !</li>
                                </ol>
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(4)">
                                <h4>Comment upgrader mon abonnement ?</h4>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="faq-answer" id="faq4">
                                <p>Pour upgrader votre plan :</p>
                                <ol>
                                    <li>Allez dans "Mon Abonnement"</li>
                                    <li>Consultez les plans disponibles</li>
                                    <li>Cliquez sur "Upgrader" pour le plan souhait√©</li>
                                    <li>Effectuez le paiement via Mobile Money</li>
                                    <li>Profitez imm√©diatement des nouvelles fonctionnalit√©s !</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Contact Support -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h3 class="card-title">Contactez le Support</h3>
                    </div>
                    
                    <div class="support-options">
                        <div class="support-option">
                            <div class="support-icon">
                                <i class="fas fa-comments"></i>
                            </div>
                            <div class="support-info">
                                <h4>Chat en direct</h4>
                                <p>R√©ponse imm√©diate de notre √©quipe</p>
                                <button class="btn btn-primary btn-sm" onclick="openLiveChat()">
                                    <i class="fas fa-comment"></i> D√©marrer le chat
                                </button>
                            </div>
                        </div>
                        
                        <div class="support-option">
                            <div class="support-icon">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="support-info">
                                <h4>Email Support</h4>
                                <p>R√©ponse sous 24h ouvr√©es</p>
                                <a href="mailto:support@etudia.ci" class="btn btn-secondary btn-sm">
                                    <i class="fas fa-envelope"></i> support@etudia.ci
                                </a>
                            </div>
                        </div>
                        
                        <div class="support-option">
                            <div class="support-icon">
                                <i class="fab fa-whatsapp"></i>
                            </div>
                            <div class="support-info">
                                <h4>WhatsApp</h4>
                                <p>Support technique rapide</p>
                                <a href="https://wa.me/2250700000000" class="btn btn-success btn-sm" target="_blank">
                                    <i class="fab fa-whatsapp"></i> +225 07 00 00 00 00
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Ticket Support -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h3 class="card-title">Cr√©er un Ticket</h3>
                    </div>
                    
                    <form id="supportTicketForm" class="support-form">
                        <div class="form-group">
                            <label>Type de probl√®me</label>
                            <select id="ticketType" required>
                                <option value="">S√©lectionnez une cat√©gorie</option>
                                <option value="technical">Probl√®me technique</option>
                                <option value="billing">Facturation</option>
                                <option value="account">Compte utilisateur</option>
                                <option value="feature">Demande de fonctionnalit√©</option>
                                <option value="other">Autre</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Sujet</label>
                            <input type="text" id="ticketSubject" placeholder="R√©sum√© du probl√®me" required>
                        </div>
                        
                        <div class="form-group">
                            <label>Description d√©taill√©e</label>
                            <textarea id="ticketDescription" rows="5" placeholder="D√©crivez votre probl√®me en d√©tail..." required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>Priorit√©</label>
                            <select id="ticketPriority">
                                <option value="low">Basse</option>
                                <option value="normal" selected>Normale</option>
                                <option value="high">Haute</option>
                                <option value="urgent">Urgente</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Fichiers joints (optionnel)</label>
                            <input type="file" id="ticketAttachments" multiple accept=".jpg,.jpeg,.png,.pdf,.doc,.docx">
                            <small>Formats accept√©s: JPG, PNG, PDF, DOC, DOCX (Max: 5MB par fichier)</small>
                        </div>
                        
                        <button type="submit" class="btn btn-primary" onclick="submitTicket()">
                            <i class="fas fa-ticket-alt"></i> Cr√©er le ticket
                        </button>
                    </form>
                </div>
            </div>
            
            <!-- Sections placeholders pour autres fonctionnalit√©s -->
            <div id="notes" class="content-section">
                <div class="section-header">
                    <h2>üìä Notes & R√©sultats</h2>
                    <p>Section en d√©veloppement - Disponible bient√¥t !</p>
                </div>
                <div class="card">
                    <div class="coming-soon">
                        <i class="fas fa-chart-line"></i>
                        <h3>Fonctionnalit√© en cours de d√©veloppement</h3>
                        <p>Le suivi des notes et r√©sultats sera bient√¥t disponible !</p>
                    </div>
                </div>
            </div>
            
            <div id="planning" class="content-section">
                <div class="section-header">
                    <h2>üìÖ Planning</h2>
                    <p>Section en d√©veloppement - Disponible bient√¥t !</p>
                </div>
                <div class="card">
                    <div class="coming-soon">
                        <i class="fas fa-calendar"></i>
                        <h3>Fonctionnalit√© en cours de d√©veloppement</h3>
                        <p>La gestion du planning sera bient√¥t disponible !</p>
                    </div>
                </div>
            </div>
            
            <div id="bibliotheque" class="content-section">
                <div class="section-header">
                    <h2>üìö Biblioth√®que</h2>
                    <p>Section en d√©veloppement - Disponible bient√¥t !</p>
                </div>
                <div class="card">
                    <div class="coming-soon">
                        <i class="fas fa-books"></i>
                        <h3>Fonctionnalit√© en cours de d√©veloppement</h3>
                        <p>La biblioth√®que num√©rique sera bient√¥t disponible !</p>
                    </div>
                </div>
            </div>
            
            <div id="gamification" class="content-section">
                <div class="section-header">
                    <h2>üèÜ Gamification</h2>
                    <p>Section en d√©veloppement - Disponible bient√¥t !</p>
                </div>
                <div class="card">
                    <div class="coming-soon">
                        <i class="fas fa-trophy"></i>
                        <h3>Fonctionnalit√© en cours de d√©veloppement</h3>
                        <p>Le syst√®me de badges et r√©compenses sera bient√¥t disponible !</p>
                    </div>
                </div>
            </div>
            
            <div id="liaison-parents" class="content-section">
                <div class="section-header">
                    <h2>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Liaison Parents</h2>
                    <p>Section en d√©veloppement - Disponible bient√¥t !</p>
                </div>
                <div class="card">
                    <div class="coming-soon">
                        <i class="fas fa-user-friends"></i>
                        <h3>Fonctionnalit√© en cours de d√©veloppement</h3>
                        <p>La liaison avec les parents sera bient√¥t disponible !</p>
                    </div>
                </div>
            </div>
            
            <div id="communaute" class="content-section">
                <div class="section-header">
                    <h2>üí¨ Communaut√©</h2>
                    <p>Section en d√©veloppement - Disponible bient√¥t !</p>
                </div>
                <div class="card">
                    <div class="coming-soon">
                        <i class="fas fa-comments"></i>
                        <h3>Fonctionnalit√© en cours de d√©veloppement</h3>
                        <p>Le forum communautaire sera bient√¥t disponible !</p>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- ===============================
         FIN PARTIE 4/5 : SECTIONS D√âTAILL√âES
         =============================== -->

    <!-- ===============================
         D√âBUT PARTIE 5/5 : JAVASCRIPT + WIDGET IA FLOTTANT
         =============================== -->
    
    <!-- Widget IA Flottant -->
    <div id="aiFloatingWidget" class="ai-floating-widget">
        <button class="ai-toggle-btn" id="aiToggleBtn" onclick="toggleAIWidget()">
            <i class="fas fa-robot"></i>
            <div class="ai-status-indicator"></div>
        </button>
        
        <div class="ai-widget-container" id="aiWidgetContainer" style="display: none;">
            <!-- Widget Header -->
            <div class="ai-widget-header">
                <div class="ai-widget-title">
                    <i class="fas fa-robot"></i>
                    <span>DeepSeek R1</span>
                </div>
                <div class="ai-widget-actions">
                    <button class="widget-action-btn" onclick="minimizeAIWidget()" title="R√©duire">
                        <i class="fas fa-minus"></i>
                    </button>
                    <button class="widget-action-btn" onclick="closeAIWidget()" title="Fermer">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            
            <!-- Widget Modes -->
            <div class="ai-widget-modes">
                <button class="ai-mode-btn active" data-mode="normal" onclick="setWidgetMode('normal')">
                    üí¨ <small>250t</small>
                </button>
                <button class="ai-mode-btn" data-mode="step_by_step" onclick="setWidgetMode('step_by_step')">
                    üìö <small>180t</small>
                </button>
                <button class="ai-mode-btn" data-mode="direct_solution" onclick="setWidgetMode('direct_solution')">
                    ‚ö° <small>400t</small>
                </button>
                <button class="ai-mode-btn" data-mode="audio" onclick="setWidgetMode('audio')">
                    üé§ <small>200t</small>
                </button>
            </div>
            
            <!-- Widget Messages -->
            <div class="ai-widget-messages" id="aiWidgetMessages">
                <div class="ai-widget-message ai">
                    <div class="ai-message-avatar">ü§ñ</div>
                    <div class="ai-message-content">
                        Salut PACOUSSTAR ! Je suis ton assistant IA personnel. Comment puis-je t'aider ?
                    </div>
                </div>
            </div>
            
            <!-- Widget Input -->
            <div class="ai-widget-input">
                <div class="ai-input-group">
                    <textarea 
                        id="aiWidgetTextarea" 
                        placeholder="Pose ta question..."
                        rows="1"
                        onkeydown="handleWidgetKeyDown(event)"
                        oninput="autoResizeWidget(this)"
                    ></textarea>
                    <button class="ai-send-btn" id="aiWidgetSendBtn" onclick="sendWidgetMessage()" disabled>
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                <div class="ai-widget-footer">
                    <span class="tokens-left">Tokens: 2,450</span>
                    <button class="expand-chat-btn" onclick="expandToFullChat()">
                        <i class="fas fa-expand"></i> Chat complet
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <style>
        /* ============================================
           WIDGET IA FLOTTANT STYLES
           ============================================ */
        .ai-floating-widget {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 10000;
            font-family: 'Inter', sans-serif;
        }
        
        .ai-toggle-btn {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-600), var(--primary-500));
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            transition: all var(--transition-normal);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .ai-toggle-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }
        
        .ai-status-indicator {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 12px;
            height: 12px;
            background: #22c55e;
            border: 2px solid white;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .ai-widget-container {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 350px;
            height: 500px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            box-shadow: var(--shadow-xl);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            animation: slideUp 0.3s ease;
        }
        
        @keyframes slideUp {
            from { 
                opacity: 0; 
                transform: translateY(20px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        .ai-widget-header {
            background: linear-gradient(135deg, var(--primary-600), var(--primary-500));
            color: white;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .ai-widget-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            font-size: 0.875rem;
        }
        
        .ai-widget-actions {
            display: flex;
            gap: 4px;
        }
        
        .widget-action-btn {
            width: 24px;
            height: 24px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            transition: all var(--transition-fast);
        }
        
        .widget-action-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .ai-widget-modes {
            padding: 8px 12px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            gap: 4px;
        }
        
        .ai-mode-btn {
            flex: 1;
            padding: 6px 4px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-primary);
            color: var(--text-secondary);
            font-size: 0.75rem;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }
        
        .ai-mode-btn:hover {
            border-color: var(--primary-300);
            color: var(--primary-600);
        }
        
        .ai-mode-btn.active {
            background: var(--primary-500);
            border-color: var(--primary-500);
            color: white;
        }
        
        .ai-widget-messages {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
            background: var(--bg-secondary);
        }
        
        .ai-widget-message {
            margin-bottom: 12px;
            display: flex;
            align-items: flex-start;
            gap: 8px;
        }
        
        .ai-widget-message.user {
            flex-direction: row-reverse;
        }
        
        .ai-message-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            flex-shrink: 0;
        }
        
        .ai-widget-message.user .ai-message-avatar {
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
        }
        
        .ai-message-content {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 8px 12px;
            font-size: 0.8rem;
            line-height: 1.4;
            max-width: 80%;
            box-shadow: var(--shadow-sm);
        }
        
        .ai-widget-message.user .ai-message-content {
            background: var(--primary-500);
            border-color: var(--primary-500);
            color: white;
        }
        
        .ai-widget-input {
            padding: 12px;
            background: var(--bg-primary);
            border-top: 1px solid var(--border-color);
        }
        
        .ai-input-group {
            display: flex;
            gap: 8px;
            align-items: flex-end;
        }
        
        #aiWidgetTextarea {
            flex: 1;
            min-height: 36px;
            max-height: 80px;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 0.8rem;
            font-family: inherit;
            resize: none;
            transition: all var(--transition-fast);
        }
        
        #aiWidgetTextarea:focus {
            outline: none;
            border-color: var(--primary-400);
            box-shadow: 0 0 0 2px var(--primary-100);
        }
        
        .ai-send-btn {
            width: 36px;
            height: 36px;
            background: var(--primary-500);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
        }
        
        .ai-send-btn:hover:not(:disabled) {
            background: var(--primary-600);
        }
        
        .ai-send-btn:disabled {
            background: var(--text-tertiary);
            cursor: not-allowed;
        }
        
        .ai-widget-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 8px;
            font-size: 0.7rem;
            color: var(--text-tertiary);
        }
        
        .expand-chat-btn {
            background: none;
            border: none;
            color: var(--primary-600);
            cursor: pointer;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: all var(--transition-fast);
        }
        
        .expand-chat-btn:hover {
            color: var(--primary-700);
        }
        
        /* Responsive Widget */
        @media (max-width: 768px) {
            .ai-widget-container {
                width: 300px;
                height: 400px;
                bottom: 70px;
            }
        }
        
        @media (max-width: 480px) {
            .ai-floating-widget {
                bottom: 80px;
                right: 15px;
            }
            
            .ai-widget-container {
                width: 280px;
                height: 350px;
                bottom: 60px;
            }
        }
        
        /* Additional CSS for missing styles */
        .activity-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .activity-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 12px;
            transition: all var(--transition-fast);
        }
        
        .activity-item:hover {
            background: var(--bg-tertiary);
        }
        
        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            flex-shrink: 0;
        }
        
        .activity-icon.success {
            background: var(--success-500);
        }
        
        .activity-icon.primary {
            background: var(--primary-500);
        }
        
        .activity-icon.warning {
            background: var(--warning-500);
        }
        
        .activity-content {
            flex: 1;
        }
        
        .activity-title {
            font-size: 0.875rem;
            font-weight: 600;
            margin: 0 0 4px 0;
        }
        
        .activity-description {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin: 0 0 4px 0;
        }
        
        .activity-time {
            font-size: 0.7rem;
            color: var(--text-tertiary);
        }
        
        .activity-meta {
            text-align: right;
        }
        
        .token-cost {
            font-size: 0.75rem;
            color: var(--error-600);
        }
        
        .gain-amount {
            font-size: 0.75rem;
            color: var(--success-600);
            font-weight: 600;
        }
        
        .course-card {
            transition: all var(--transition-normal);
        }
        
        .course-card:hover {
            transform: translateY(-2px);
        }
        
        .course-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .course-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
        }
        
        .course-icon.math {
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
        }
        
        .course-icon.physics {
            background: linear-gradient(135deg, #06b6d4, #0891b2);
        }
        
        .course-icon.biology {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .course-info h3 {
            margin: 0 0 4px 0;
            font-size: 1.125rem;
        }
        
        .course-info p {
            margin: 0;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        
        .course-progress {
            margin-left: auto;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary-600);
        }
        
        .course-stats {
            display: flex;
            gap: 2rem;
            margin: 1rem 0;
        }
        
        .course-stats .stat {
            text-align: center;
        }
        
        .course-stats .stat-label {
            display: block;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }
        
        .course-stats .stat-value {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .course-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .upload-zone, .upload-zone-large {
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-normal);
        }
        
        .upload-zone:hover, .upload-zone-large:hover {
            border-color: var(--primary-400);
            background: var(--primary-50);
        }
        
        .upload-zone-large {
            padding: 3rem 2rem;
        }
        
        .upload-zone-large .upload-icon {
            font-size: 3rem;
            color: var(--primary-500);
            margin-bottom: 1rem;
        }
        
        .upload-zone-large h3 {
            margin: 0 0 0.5rem 0;
            color: var(--text-primary);
        }
        
        .upload-zone-large p {
            margin: 0 0 1.5rem 0;
            color: var(--text-secondary);
        }
        
        .assignments-container {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .assignment-card {
            border-left: 4px solid var(--border-color);
        }
        
        .assignment-card.urgent {
            border-left-color: var(--error-500);
        }
        
        .assignment-card.completed {
            border-left-color: var(--success-500);
        }
        
        .assignment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .assignment-subject {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
        }
        
        .assignment-subject.math {
            background: var(--primary-500);
        }
        
        .assignment-subject.physics {
            background: #06b6d4;
        }
        
        .assignment-subject.biology {
            background: var(--success-500);
        }
        
        .assignment-due, .assignment-status {
            font-size: 0.75rem;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .assignment-status.completed {
            color: var(--success-600);
        }
        
        .assignment-card h3 {
            margin: 0 0 0.5rem 0;
            font-size: 1.125rem;
        }
        
        .assignment-card p {
            margin: 0 0 1rem 0;
            color: var(--text-secondary);
        }
        
        .assignment-progress {
            margin: 1rem 0;
        }
        
        .assignment-progress span {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        
        .assignment-grade {
            margin: 1rem 0;
            text-align: center;
        }
        
        .grade {
            display: block;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }
        
        .grade.excellent {
            color: var(--success-600);
        }
        
        .grade-label {
            font-size: 0.875rem;
            color: var(--success-600);
        }
        
        .assignment-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .coming-soon {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--text-secondary);
        }
        
        .coming-soon i {
            font-size: 3rem;
            color: var(--primary-500);
            margin-bottom: 1rem;
        }
        
        .coming-soon h3 {
            margin: 0 0 0.5rem 0;
            color: var(--text-primary);
        }
        
        .coming-soon p {
            margin: 0;
        }
        
        /* User dropdown styles */
        .user-dropdown {
            position: relative;
            cursor: pointer;
        }
        
        .user-dropdown .user-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            font-weight: 600;
            color: white;
        }
        
        .dropdown-content {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            min-width: 200px;
            display: none;
            z-index: 1000;
        }
        
        .dropdown-content.show {
            display: block;
        }
        
        .dropdown-content a {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            text-decoration: none;
            color: var(--text-primary);
            transition: all var(--transition-fast);
        }
        
        .dropdown-content a:hover {
            background: var(--bg-secondary);
        }
        
        .dropdown-content hr {
            margin: 0;
            border: none;
            border-top: 1px solid var(--border-color);
        }
        
        .xp-progress {
            margin-top: 12px;
        }
        
        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .xp-text {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .xp-points {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }
    </style>
    
    <script>
        // ============================================
        // VARIABLES GLOBALES
        // ============================================
        let currentSection = 'dashboard';
        let sidebarCollapsed = false;
        let currentAIMode = 'normal';
        let aiWidgetOpen = false;
        let userTokens = 2450;
        let chatSessions = {
            1: { title: 'Math√©matiques', messages: [] },
            2: { title: 'Physique', messages: [] }
        };
        let currentSession = 1;
        let sessionCounter = 2;
        
        // ============================================
        // FONCTIONS DE NAVIGATION
        // ============================================
        function showSection(sectionId) {
            // Cacher toutes les sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Afficher la section demand√©e
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add('active');
            }
            
            // Mettre √† jour la navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            const activeLink = document.querySelector(`[data-section="${sectionId}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }
            
            currentSection = sectionId;
            
            // Fermer le menu mobile si ouvert
            closeMobileMenu();
            
            // Toast de notification
            showToast(`Section ${getSectionName(sectionId)} ouverte`, 'success');
        }
        
        function getSectionName(sectionId) {
            const names = {
                'dashboard': 'Dashboard',
                'chat-ia': 'Chat IA',
                'cours': 'Mes Cours',
                'devoirs': 'Devoirs',
                'notes': 'Notes & R√©sultats',
                'planning': 'Planning',
                'bibliotheque': 'Biblioth√®que',
                'documents': 'Mes Documents',
                'gamification': 'Gamification',
                'parrainage': 'Parrainage',
                'liaison-parents': 'Liaison Parents',
                'communaute': 'Communaut√©',
                'profil': 'Mon Profil',
                'abonnement': 'Abonnement',
                'parametres': 'Param√®tres',
                'aide': 'Aide & Support'
            };
            return names[sectionId] || sectionId;
        }
        
        // ============================================
        // FONCTIONS SIDEBAR
        // ============================================
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const toggleBtn = document.getElementById('toggleSidebar');
            
            sidebar.classList.toggle('collapsed');
            sidebarCollapsed = !sidebarCollapsed;
            
            // Changer l'ic√¥ne
            const icon = toggleBtn.querySelector('i');
            icon.className = sidebarCollapsed ? 'fas fa-chevron-right' : 'fas fa-chevron-left';
        }
        
        // ============================================
        // FONCTIONS MENU MOBILE
        // ============================================
        function toggleMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobileOverlay');
            
            sidebar.classList.toggle('mobile-open');
            overlay.classList.toggle('active');
        }
        
        function closeMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobileOverlay');
            
            sidebar.classList.remove('mobile-open');
            overlay.classList.remove('active');
        }
        
        // ============================================
        // FONCTIONS WIDGET IA FLOTTANT
        // ============================================
        function toggleAIWidget() {
            const widget = document.getElementById('aiWidgetContainer');
            const toggleBtn = document.getElementById('aiToggleBtn');
            
            if (aiWidgetOpen) {
                widget.style.display = 'none';
                toggleBtn.innerHTML = '<i class="fas fa-robot"></i><div class="ai-status-indicator"></div>';
                aiWidgetOpen = false;
            } else {
                widget.style.display = 'flex';
                toggleBtn.innerHTML = '<i class="fas fa-times"></i><div class="ai-status-indicator"></div>';
                aiWidgetOpen = true;
                
                // Focus sur l'input
                setTimeout(() => {
                    document.getElementById('aiWidgetTextarea').focus();
                }, 100);
            }
        }
        
        function minimizeAIWidget() {
            const widget = document.getElementById('aiWidgetContainer');
            widget.style.display = 'none';
            aiWidgetOpen = false;
            
            const toggleBtn = document.getElementById('aiToggleBtn');
            toggleBtn.innerHTML = '<i class="fas fa-robot"></i><div class="ai-status-indicator"></div>';
        }
        
        function closeAIWidget() {
            minimizeAIWidget();
        }
        
        function setWidgetMode(mode) {
            currentAIMode = mode;
            
            // Mettre √† jour les boutons
            document.querySelectorAll('.ai-mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
            
            // Descriptions des modes
            const descriptions = {
                'normal': 'Mode Normal : Conversation √©quilibr√©e avec explications d√©taill√©es',
                'step_by_step': 'Mode √âtape par √âtape : R√©solution progressive et p√©dagogique',
                'direct_solution': 'Mode Solution Directe : R√©ponse compl√®te et imm√©diate',
                'audio': 'Mode Audio : R√©ponses optimis√©es pour la synth√®se vocale'
            };
            
            showToast(`Mode ${descriptions[mode]} activ√©`, 'success');
        }
        
        function handleWidgetKeyDown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendWidgetMessage();
            }
        }
        
        function autoResizeWidget(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 80) + 'px';
            
            // Activer/d√©sactiver le bouton d'envoi
            const sendBtn = document.getElementById('aiWidgetSendBtn');
            sendBtn.disabled = textarea.value.trim() === '';
        }
        
        async function sendWidgetMessage() {
            const textarea = document.getElementById('aiWidgetTextarea');
            const message = textarea.value.trim();
            
            if (!message) return;
            
        async function sendWidgetMessage() {
            const textarea = document.getElementById('aiWidgetTextarea');
            const message = textarea.value.trim();
            
            if (!message) return;
            
            // Ajouter le message utilisateur
            addWidgetMessage(message, 'user');
            
            // Vider et r√©initialiser l'input
            textarea.value = '';
            textarea.style.height = 'auto';
            document.getElementById('aiWidgetSendBtn').disabled = true;
            
            // Simuler la frappe de l'IA
            addWidgetMessage('IA en train d\'√©crire...', 'ai', true);
            
            try {
                // Appel API r√©el vers OpenRouter
                const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer YOUR_OPENROUTER_API_KEY', // √Ä remplacer
                        'HTTP-Referer': 'https://etudia.gsnexpertises.com',
                        'X-Title': '√âtudIA V4.1'
                    },
                    body: JSON.stringify({
                        model: 'deepseek/deepseek-r1',
                        messages: [
                            {
                                role: 'system',
                                content: getSystemPrompt()
                            },
                            {
                                role: 'user',
                                content: message
                            }
                        ],
                        max_tokens: getTokensForMode(),
                        temperature: 0.7
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const aiResponse = data.choices[0].message.content;
                    
                    // Remplacer le message de frappe par la vraie r√©ponse
                    replaceLastWidgetMessage(aiResponse);
                    
                    // D√©compter les tokens
                    const tokensUsed = getTokensForMode();
                    userTokens -= tokensUsed;
                    updateTokensDisplay();
                    
                    // Toast de succ√®s
                    showToast(`R√©ponse IA re√ßue (-${tokensUsed} tokens)`, 'success');
                } else {
                    throw new Error('Erreur API');
                }
            } catch (error) {
                console.error('Erreur API:', error);
                
                // Fallback avec r√©ponse simul√©e intelligente
                const aiResponse = generateSmartResponse(message);
                replaceLastWidgetMessage(aiResponse);
                
                // D√©compter les tokens m√™me en simulation
                const tokensUsed = getTokensForMode();
                userTokens -= tokensUsed;
                updateTokensDisplay();
                
                showToast(`R√©ponse IA simul√©e (-${tokensUsed} tokens)`, 'warning');
            }
        }
        
        function addWidgetMessage(message, sender, isTyping = false) {
            const messagesContainer = document.getElementById('aiWidgetMessages');
            
            const messageElement = document.createElement('div');
            messageElement.className = `ai-widget-message ${sender}`;
            
            const avatar = sender === 'ai' ? 'ü§ñ' : 'P';
            
            messageElement.innerHTML = `
                <div class="ai-message-avatar">${avatar}</div>
                <div class="ai-message-content ${isTyping ? 'typing' : ''}">${message}</div>
            `;
            
            messagesContainer.appendChild(messageElement);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function replaceLastWidgetMessage(newMessage) {
            const messagesContainer = document.getElementById('aiWidgetMessages');
            const lastMessage = messagesContainer.lastElementChild;
            
            if (lastMessage) {
                const contentElement = lastMessage.querySelector('.ai-message-content');
                contentElement.textContent = newMessage;
                contentElement.classList.remove('typing');
            }
        }
        
        function expandToFullChat() {
            showSection('chat-ia');
            closeAIWidget();
            showToast('Chat complet ouvert', 'info');
        }
        
        // ============================================
        // FONCTIONS CHAT IA PRINCIPAL
        // ============================================
        function newChatSession() {
            sessionCounter++;
            const newSessionId = sessionCounter;
            
            chatSessions[newSessionId] = {
                title: `Session ${newSessionId}`,
                messages: []
            };
            
            // Ajouter l'onglet
            const tabsContainer = document.getElementById('sessionTabs');
            const addButton = tabsContainer.querySelector('.add-session-btn');
            
            const newTab = document.createElement('div');
            newTab.className = 'session-tab';
            newTab.dataset.session = newSessionId;
            newTab.onclick = () => switchSession(newSessionId);
            newTab.innerHTML = `
                <span class="tab-title">Session ${newSessionId}</span>
                <button class="tab-close" onclick="closeSession(${newSessionId})">√ó</button>
            `;
            
            tabsContainer.insertBefore(newTab, addButton);
            switchSession(newSessionId);
            
            showToast(`Nouvelle session cr√©√©e`, 'success');
        }
        
        function switchSession(sessionId) {
            currentSession = sessionId;
            
            // Mettre √† jour les onglets
            document.querySelectorAll('.session-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-session="${sessionId}"]`).classList.add('active');
            
            // Charger les messages de la session
            loadSessionMessages(sessionId);
        }
        
        function closeSession(sessionId) {
            event.stopPropagation();
            
            if (Object.keys(chatSessions).length <= 1) {
                showToast('Impossible de fermer la derni√®re session', 'error');
                return;
            }
            
            delete chatSessions[sessionId];
            document.querySelector(`[data-session="${sessionId}"]`).remove();
            
            // Basculer vers une autre session
            const remainingSessions = Object.keys(chatSessions);
            if (remainingSessions.length > 0) {
                switchSession(parseInt(remainingSessions[0]));
            }
            
            showToast(`Session ferm√©e`, 'info');
        }
        
        function loadSessionMessages(sessionId) {
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.innerHTML = '';
            
            // Message de bienvenue par d√©faut
            if (!chatSessions[sessionId].messages.length) {
                messagesContainer.innerHTML = `
                    <div class="message ai">
                        <div class="message-avatar">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="message-content">
                            <div class="message-text">
                                Nouvelle session d√©marr√©e ! üöÄ<br>
                                Comment puis-je vous aider dans cette session ?
                            </div>
                            <div class="message-time">Maintenant</div>
                        </div>
                    </div>
                `;
            } else {
                // Charger les messages existants
                chatSessions[sessionId].messages.forEach(msg => {
                    addChatMessage(msg.content, msg.sender, false);
                });
            }
        }
        
        async function sendMessage() {
            const textarea = document.getElementById('chatInput');
            const message = textarea.value.trim();
            
            if (!message) return;
            
            // Ajouter le message utilisateur
            addChatMessage(message, 'user');
            chatSessions[currentSession].messages.push({ content: message, sender: 'user' });
            
            // Vider l'input
            textarea.value = '';
            autoResize(textarea);
            
            // Simuler la frappe
            addChatMessage('L\'IA r√©fl√©chit...', 'ai', true);
            
            try {
                // M√™me logique d'API que le widget
                const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer YOUR_OPENROUTER_API_KEY',
                        'HTTP-Referer': 'https://etudia.gsnexpertises.com',
                        'X-Title': '√âtudIA V4.1'
                    },
                    body: JSON.stringify({
                        model: 'deepseek/deepseek-r1',
                        messages: [
                            { role: 'system', content: getSystemPrompt() },
                            { role: 'user', content: message }
                        ],
                        max_tokens: getTokensForMode(),
                        temperature: 0.7
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const aiResponse = data.choices[0].message.content;
                    
                    replaceLastChatMessage(aiResponse);
                    chatSessions[currentSession].messages.push({ content: aiResponse, sender: 'ai' });
                    
                    const tokensUsed = getTokensForMode();
                    userTokens -= tokensUsed;
                    updateTokensDisplay();
                    
                    showToast(`R√©ponse re√ßue (-${tokensUsed} tokens)`, 'success');
                } else {
                    throw new Error('Erreur API');
                }
            } catch (error) {
                const aiResponse = generateSmartResponse(message);
                replaceLastChatMessage(aiResponse);
                chatSessions[currentSession].messages.push({ content: aiResponse, sender: 'ai' });
                
                const tokensUsed = getTokensForMode();
                userTokens -= tokensUsed;
                updateTokensDisplay();
                
                showToast(`R√©ponse simul√©e (-${tokensUsed} tokens)`, 'warning');
            }
        }
        
        function addChatMessage(message, sender, isTyping = false) {
            const messagesContainer = document.getElementById('chatMessages');
            
            const messageElement = document.createElement('div');
            messageElement.className = `message ${sender}`;
            
            const avatar = sender === 'ai' ? '<i class="fas fa-robot"></i>' : 'P';
            const time = new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
            
            messageElement.innerHTML = `
                <div class="message-avatar">${avatar}</div>
                <div class="message-content">
                    <div class="message-text ${isTyping ? 'typing' : ''}">${message}</div>
                    <div class="message-time">${time}</div>
                </div>
            `;
            
            messagesContainer.appendChild(messageElement);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function replaceLastChatMessage(newMessage) {
            const messagesContainer = document.getElementById('chatMessages');
            const lastMessage = messagesContainer.lastElementChild;
            
            if (lastMessage) {
                const textElement = lastMessage.querySelector('.message-text');
                textElement.textContent = newMessage;
                textElement.classList.remove('typing');
            }
        }
        
        // ============================================
        // FONCTIONS IA UTILITAIRES
        // ============================================
        function getSystemPrompt() {
            const prompts = {
                'normal': 'Tu es DeepSeek R1, assistant IA d\'√âtudIA V4.1. R√©ponds de mani√®re √©quilibr√©e avec des explications claires et des exemples.',
                'step_by_step': 'Tu es DeepSeek R1. R√©ponds en d√©composant chaque probl√®me √©tape par √©tape, de mani√®re p√©dagogique.',
                'direct_solution': 'Tu es DeepSeek R1. Donne une r√©ponse compl√®te et directe avec tous les d√©tails n√©cessaires.',
                'audio': 'Tu es DeepSeek R1. R√©ponds de mani√®re concise et fluide, optimis√©e pour la synth√®se vocale.'
            };
            return prompts[currentAIMode] || prompts['normal'];
        }
        
        function getTokensForMode() {
            const tokens = {
                'normal': 250,
                'step_by_step': 180,
                'direct_solution': 400,
                'audio': 200
            };
            return tokens[currentAIMode] || 250;
        }
        
        function generateSmartResponse(userMessage) {
            const responses = [
                `Excellente question sur "${userMessage.substring(0, 30)}..." ! En mode ${currentAIMode}, je peux vous expliquer que ce sujet n√©cessite une approche m√©thodique. Commen√ßons par identifier les concepts cl√©s...`,
                `Pour r√©pondre √† votre question "${userMessage.substring(0, 30)}...", je vais utiliser une approche ${currentAIMode}. Les √©l√©ments importants √† retenir sont...`,
                `Votre question sur "${userMessage.substring(0, 30)}..." est tr√®s pertinente ! En mode ${currentAIMode}, voici comment nous pouvons l'aborder...`,
                `Int√©ressant ! Pour "${userMessage.substring(0, 30)}...", je recommande cette m√©thode d'analyse...`
            ];
            
            return responses[Math.floor(Math.random() * responses.length)];
        }
        
        function setMode(mode) {
            currentAIMode = mode;
            
            // Mettre √† jour les boutons du chat principal
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
            
            // Mettre √† jour la description
            const descriptions = {
                'normal': 'Mode Normal : Conversation √©quilibr√©e avec explications d√©taill√©es et exemples.',
                'step_by_step': 'Mode √âtape par √âtape : R√©solution progressive, d√©composition p√©dagogique des probl√®mes.',
                'direct_solution': 'Mode Solution Directe : R√©ponses compl√®tes et imm√©diates avec tous les d√©tails.',
                'audio': 'Mode Audio : R√©ponses concises et fluides, optimis√©es pour la synth√®se vocale.'
            };
            
            document.getElementById('modeDescription').textContent = descriptions[mode];
            
            // Synchroniser avec le widget
            setWidgetMode(mode);
        }
        
        function updateTokensDisplay() {
            // Mettre √† jour tous les affichages de tokens
            const displays = ['tokenCount', 'aiWidgetTextarea'];
            displays.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    if (id === 'tokenCount') {
                        element.textContent = userTokens;
                    }
                }
            });
            
            // Mettre √† jour le widget footer
            const tokensLeft = document.querySelector('.tokens-left');
            if (tokensLeft) {
                tokensLeft.textContent = `Tokens: ${userTokens}`;
            }
        }
        
        // ============================================
        // FONCTIONS DOCUMENTS
        // ============================================
        function handleFileUpload(event) {
            const files = event.target.files;
            processFiles(files);
        }
        
        function handleDocumentUpload(event) {
            const files = event.target.files;
            processFiles(files);
        }
        
        function processFiles(files) {
            Array.from(files).forEach(file => {
                if (file.size > 10 * 1024 * 1024) { // 10MB
                    showToast(`Fichier ${file.name} trop volumineux (max 10MB)`, 'error');
                    return;
                }
                
                // Simuler l'upload et l'OCR
                showToast(`Upload de ${file.name} en cours...`, 'info');
                
                setTimeout(() => {
                    addDocumentToGrid(file);
                    showToast(`${file.name} analys√© avec succ√®s !`, 'success');
                }, 2000);
            });
        }
        
        function addDocumentToGrid(file) {
            const grid = document.getElementById('documentsGrid');
            
            const docElement = document.createElement('div');
            docElement.className = 'document-card';
            docElement.innerHTML = `
                <div class="document-icon">
                    <i class="fas fa-file-${getFileIcon(file.name)}"></i>
                </div>
                <div class="document-info">
                    <h4>${file.name}</h4>
                    <p>Ajout√© maintenant ‚Ä¢ ${(file.size / 1024 / 1024).toFixed(1)} MB</p>
                    <div class="document-status">
                        <span class="status-badge success">Analys√©</span>
                    </div>
                </div>
                <div class="document-actions">
                    <button class="action-btn" onclick="previewDocument('${file.name}')" title="Aper√ßu">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button class="action-btn" onclick="analyzeDocument('${file.name}')" title="Analyser">
                        <i class="fas fa-robot"></i>
                    </button>
                    <button class="action-btn" onclick="downloadDocument('${file.name}')" title="T√©l√©charger">
                        <i class="fas fa-download"></i>
                    </button>
                    <button class="action-btn danger" onclick="deleteDocument('${file.name}')" title="Supprimer">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            
            grid.appendChild(docElement);
        }
        
        function getFileIcon(fileName) {
            const extension = fileName.split('.').pop().toLowerCase();
            const icons = {
                'pdf': 'pdf',
                'doc': 'word',
                'docx': 'word',
                'jpg': 'image',
                'jpeg': 'image',
                'png': 'image',
                'txt': 'alt'
            };
            return icons[extension] || 'file';
        }
        
        // ============================================
        // FONCTIONS PARRAINAGE
        // ============================================
        function copyReferralLink() {
            const linkInput = document.getElementById('referralLink');
            linkInput.select();
            document.execCommand('copy');
            showToast('Lien de parrainage copi√© !', 'success');
        }
        
        function shareToWhatsApp() {
            const link = document.getElementById('referralLink').value;
            const text = `üéì D√©couvre √âtudIA V4.1, la meilleure plateforme d'apprentissage avec IA en Afrique ! ü§ñ\n\nInscris-toi avec mon lien de parrainage : ${link}`;
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`);
        }
        
        function shareToFacebook() {
            const link = document.getElementById('referralLink').value;
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(link)}`);
        }
        
        function shareToTelegram() {
            const link = document.getElementById('referralLink').value;
            const text = `üéì D√©couvre √âtudIA V4.1 avec IA DeepSeek R1 ! Inscris-toi : ${link}`;
            window.open(`https://t.me/share/url?url=${encodeURIComponent(link)}&text=${encodeURIComponent(text)}`);
        }
        
        function shareToInstagram() {
            showToast('Lien copi√© ! Collez-le dans votre story Instagram', 'info');
            copyReferralLink();
        }
        
        function calculateCommissions() {
            const filleulsCount = parseInt(document.getElementById('filleulsCount').value) || 0;
            const premiumPrice = 6500; // FCFA
            
            const level1 = filleulsCount * premiumPrice * 0.4;
            const level2 = filleulsCount * premiumPrice * 0.2;
            const level3 = filleulsCount * premiumPrice * 0.1;
            const total = level1 + level2 + level3;
            
            document.getElementById('level1Amount').textContent = `${level1.toLocaleString()} FCFA/mois`;
            document.getElementById('level2Amount').textContent = `${level2.toLocaleString()} FCFA/mois`;
            document.getElementById('level3Amount').textContent = `${level3.toLocaleString()} FCFA/mois`;
            document.getElementById('totalAmount').textContent = `${total.toLocaleString()} FCFA/mois`;
        }
        
        function requestWithdrawal() {
            const amount = document.getElementById('withdrawalAmount').value;
            const mobile = document.getElementById('mobileNumber').value;
            
            if (!amount || !mobile) {
                showToast('Veuillez remplir tous les champs', 'error');
                return;
            }
            
            if (parseInt(amount) < 5000) {
                showToast('Montant minimum : 5,000 FCFA', 'error');
                return;
            }
            
            showToast(`Demande de retrait de ${amount} FCFA envoy√©e !`, 'success');
            
            // Reset form
            document.getElementById('withdrawalAmount').value = '';
            document.getElementById('mobileNumber').value = '';
        }
        
        // ============================================
        // FONCTIONS PROFIL
        // ============================================
        function editProfile() {
            const inputs = document.querySelectorAll('#profileForm input');
            const actions = document.getElementById('formActions');
            
            inputs.forEach(input => {
                if (input.id !== 'username' && input.id !== 'email') {
                    input.removeAttribute('readonly');
                }
            });
            
            actions.style.display = 'flex';
            showToast('Mode √©dition activ√©', 'info');
        }
        
        function cancelEdit() {
            const inputs = document.querySelectorAll('#profileForm input');
            const actions = document.getElementById('formActions');
            
            inputs.forEach(input => {
                input.setAttribute('readonly', true);
            });
            
            actions.style.display = 'none';
            showToast('Modifications annul√©es', 'warning');
        }
        
        function saveProfile() {
            event.preventDefault();
            
            // Simuler la sauvegarde
            setTimeout(() => {
                const inputs = document.querySelectorAll('#profileForm input');
                const actions = document.getElementById('formActions');
                
                inputs.forEach(input => {
                    input.setAttribute('readonly', true);
                });
                
                actions.style.display = 'none';
                showToast('Profil mis √† jour avec succ√®s !', 'success');
            }, 1000);
        }
        
        // ============================================
        // FONCTIONS UTILITAIRES
        // ============================================
        function toggleTheme() {
            const body = document.body;
            const currentTheme = body.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            body.setAttribute('data-theme', newTheme);
            
            const themeIcon = document.getElementById('themeIcon');
            themeIcon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            
            showToast(`Th√®me ${newTheme === 'dark' ? 'sombre' : 'clair'} activ√©`, 'info');
        }
        
        function toggleUserDropdown() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('show');
        }
        
        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
        }
        
        function handleKeyDown(event) {
            if (event.key === 'Enter' && event.ctrlKey) {
                event.preventDefault();
                sendMessage();
            }
        }
        
        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-header">
                    <h4 class="toast-title">${getToastTitle(type)}</h4>
                    <button class="toast-close" onclick="this.parentElement.parentElement.remove()">√ó</button>
                </div>
                <p class="toast-message">${message}</p>
            `;
            
            container.appendChild(toast);
            
            // Animer l'apparition
            setTimeout(() => toast.classList.add('show'), 100);
            
            // Auto-suppression apr√®s 5 secondes
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 5000);
        }
        
        function getToastTitle(type) {
            const titles = {
                'success': 'Succ√®s',
                'error': 'Erreur',
                'warning': 'Attention',
                'info': 'Information'
            };
            return titles[type] || 'Notification';
        }
        
        // ============================================
        // FONCTIONS PLACEHOLDER (√† d√©velopper)
        // ============================================
        function startChatWithMode(mode) {
            setMode(mode);
            showSection('chat-ia');
        }
        
        function startCourseChat(subject) {
            showSection('chat-ia');
            const textarea = document.getElementById('chatInput');
            textarea.value = `Aide-moi avec mes cours de ${subject}`;
            textarea.focus();
        }
        
        function continueAssignment(assignmentId) {
            showSection('chat-ia');
            showToast(`Assistance IA pour le devoir ${assignmentId}`, 'info');
        }
        
        function previewDocument(docId) {
            showToast(`Aper√ßu du document ${docId}`, 'info');
        }
        
        function analyzeDocument(docId) {
            showSection('chat-ia');
            showToast(`Analyse IA du document ${docId} d√©marr√©e`, 'success');
        }
        
        function insertQuickPrompt(prompt) {
            const textarea = document.getElementById('chatInput');
            textarea.value = prompt + ' ';
            textarea.focus();
            autoResize(textarea);
        }
        
        // ============================================
        // INITIALISATION
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            // Event listeners pour le menu mobile
            document.getElementById('mobileMenuBtn').addEventListener('click', toggleMobileMenu);
            document.getElementById('mobileOverlay').addEventListener('click', closeMobileMenu);
            
            // Event listeners pour les inputs
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.addEventListener('input', () => autoResize(chatInput));
            }
            
            const aiWidgetTextarea = document.getElementById('aiWidgetTextarea');
            if (aiWidgetTextarea) {
                aiWidgetTextarea.addEventListener('input', () => autoResizeWidget(aiWidgetTextarea));
            }
            
            // Fermer dropdown si clic ailleurs
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.user-dropdown')) {
                    const dropdown = document.getElementById('userDropdown');
                    if (dropdown) {
                        dropdown.classList.remove('show');
                    }
                }
            });
            
            // Drag & Drop pour les documents
            const uploadZone = document.getElementById('uploadZone');
            if (uploadZone) {
                uploadZone.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.style.borderColor = 'var(--primary-400)';
                    this.style.background = 'var(--primary-50)';
                });
                
                uploadZone.addEventListener('dragleave', function(e) {
                    e.preventDefault();
                    this.style.borderColor = 'var(--border-color)';
                    this.style.background = 'transparent';
                });
                
                uploadZone.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.style.borderColor = 'var(--border-color)';
                    this.style.background = 'transparent';
                    
                    const files = e.dataTransfer.files;
                    processFiles(files);
                });
            }
            
            // Calcul initial des commissions
            calculateCommissions();
            
            // Affichage initial des tokens
            updateTokensDisplay();
            
            console.log('üéì √âtudIA V4.1 Backoffice √âl√®ves initialis√© avec succ√®s !');
            showToast('Bienvenue sur √âtudIA V4.1 ! üöÄ', 'success');
        });
        
        // ============================================
        // RACCOURCIS CLAVIER
        // ============================================
        document.addEventListener('keydown', function(event) {
            // Ctrl+K : Focus recherche
            if (event.ctrlKey && event.key === 'k') {
                event.preventDefault();
                document.getElementById('chatInput')?.focus();
            }
            
            // Ctrl+1 √† Ctrl+4 : Modes IA
            if (event.ctrlKey && event.key >= '1' && event.key <= '4') {
                event.preventDefault();
                const modes = ['normal', 'step_by_step', 'direct_solution', 'audio'];
                setMode(modes[parseInt(event.key) - 1]);
            }
            
            // Ctrl+D : Dashboard
            if (event.ctrlKey && event.key === 'd') {
                event.preventDefault();
                showSection('dashboard');
            }
            
            // Ctrl+Shift+C : Chat IA
            if (event.ctrlKey && event.shiftKey && event.key === 'C') {
                event.preventDefault();
                showSection('chat-ia');
            }
        });
    </script>
    
    <!-- ===============================
         FIN PARTIE 5/5 : JAVASCRIPT + WIDGET IA FLOTTANT
         =============================== -->
</body>
</html>
